!function(){"use strict";var t=function(t){return function(n){return o=typeof(e=n),(null===e?"null":"object"===o&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===o&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":o)===t;var e,o}},n=function(t){return function(n){return typeof n===t}},e=function(t){return function(n){return t===n}},o=t("string"),r=t("object"),i=t("array"),u=e(null),a=n("boolean"),c=e(void 0),s=function(t){return null==t},f=function(t){return!s(t)},l=n("function"),d=n("number"),m=function(t,n){if(i(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1;return!0}return!1},g=function(){},p=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t(n.apply(null,e))}},h=function(t){return function(){return t}},v=function(t){return t},b=function(t,n){return t===n};function y(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=n.concat(e);return t.apply(null,r)}}var x=function(t){return function(n){return!t(n)}},w=function(t){return function(){throw new Error(t)}},S=h(!1),k=h(!0),C=tinymce.util.Tools.resolve("tinymce.ThemeManager"),O=function(){return O=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t},O.apply(this,arguments)};function _(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]])}return e}function T(t,n,e){if(e||2===arguments.length)for(var o,r=0,i=n.length;r<i;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))}var E,B,M,A=function(){return D},D={fold:function(t,n){return t()},isSome:S,isNone:k,getOr:B=v,getOrThunk:E=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:h(null),getOrUndefined:h(void 0),or:B,orThunk:E,map:A,each:g,bind:A,exists:S,forall:k,filter:function(){return A()},toArray:function(){return[]},toString:h("none()")},F=function(t){var n=h(t),e=function(){return r},o=function(n){return n(t)},r={fold:function(n,e){return e(t)},isSome:k,isNone:S,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return F(n(t))},each:function(n){n(t)},bind:o,exists:o,forall:o,filter:function(n){return n(t)?r:D},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return r},I={some:F,none:A,from:function(t){return null==t?D:F(t)}},R=Array.prototype.slice,V=Array.prototype.indexOf,P=Array.prototype.push,H=function(t,n){return V.call(t,n)},z=function(t,n){return H(t,n)>-1},N=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return!0;return!1},L=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e},W=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=R.call(t,o,o+n);e.push(r)}return e},U=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o},j=function(t,n){for(var e=0,o=t.length;e<o;e++)n(t[e],e)},G=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}},X=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e},q=function(t,n,e){return function(t,n){for(var e=t.length-1;e>=0;e--)n(t[e],e)}(t,(function(t,o){e=n(e,t,o)})),e},Y=function(t,n,e){return j(t,(function(t,o){e=n(e,t,o)})),e},K=function(t,n){return function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o];if(n(i,o))return I.some(i);if(e(i,o))break}return I.none()}(t,n,S)},J=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return I.some(e);return I.none()},$=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!i(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);P.apply(n,t[e])}return n},Q=function(t,n){return $(U(t,n))},Z=function(t,n){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e],e))return!1;return!0},tt=function(t){var n=R.call(t,0);return n.reverse(),n},nt=function(t,n){return X(t,(function(t){return!z(n,t)}))},et=function(t,n){for(var e={},o=0,r=t.length;o<r;o++){var i=t[o];e[String(i)]=n(i,o)}return e},ot=function(t){return[t]},rt=function(t,n){var e=R.call(t,0);return e.sort(n),e},it=function(t,n){return n>=0&&n<t.length?I.some(t[n]):I.none()},ut=function(t){return it(t,0)},at=function(t){return it(t,t.length-1)},ct=l(Array.from)?Array.from:function(t){return R.call(t)},st=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return I.none()},ft=Object.keys,lt=Object.hasOwnProperty,dt=function(t,n){for(var e=ft(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i)}},mt=function(t,n){return gt(t,(function(t,e){return{k:e,v:n(t,e)}}))},gt=function(t,n){var e={};return dt(t,(function(t,o){var r=n(t,o);e[r.k]=r.v})),e},pt=function(t,n){var e=[];return dt(t,(function(t,o){e.push(n(t,o))})),e},ht=function(t,n){for(var e=ft(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return I.some(u)}return I.none()},vt=function(t){return pt(t,v)},bt=function(t,n){return yt(t,n)?I.from(t[n]):I.none()},yt=function(t,n){return lt.call(t,n)},xt=function(t,n){return yt(t,n)&&void 0!==t[n]&&null!==t[n]},wt=function(t,n,e){return void 0===e&&(e=b),t.exists((function(t){return e(t,n)}))},St=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},kt=function(t,n,e){return t.isSome()&&n.isSome()?I.some(e(t.getOrDie(),n.getOrDie())):I.none()},Ct=function(t,n){return t?I.some(n):I.none()},Ot=function(t,n,e){return""===n||t.length>=n.length&&t.substr(e,e+n.length)===n},_t=function(t,n){return-1!==t.indexOf(n)},Tt=function(t,n){return Ot(t,n,t.length-n.length)},Et=(M=/^\s+|\s+$/g,function(t){return t.replace(M,"")}),Bt=function(t){return t.length>0},Mt=function(t){return void 0!==t.style&&l(t.style.getPropertyValue)},At=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}},Dt=function(t,n){var e=(n||document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||e.childNodes.length>1)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return At(e.childNodes[0])},Ft=function(t,n){var e=(n||document).createElement(t);return At(e)},It=function(t,n){var e=(n||document).createTextNode(t);return At(e)},Rt=At;"undefined"!=typeof window?window:Function("return this;")();var Vt,Pt=function(t){return t.dom.nodeName.toLowerCase()},Ht=function(t){return function(n){return function(t){return t.dom.nodeType}(n)===t}},zt=Ht(1),Nt=Ht(3),Lt=Ht(9),Wt=Ht(11),Ut=function(t){var n,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,n=t.apply(null,o)),n}},jt=function(){return Gt(0,0)},Gt=function(t,n){return{major:t,minor:n}},Xt={nu:Gt,detect:function(t,n){var e=String(n).toLowerCase();return 0===t.length?jt():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}}(t,n);if(!e)return{major:0,minor:0};var o=function(t){return Number(n.replace(e,"$"+t))};return Gt(o(1),o(2))}(t,e)},unknown:jt},qt=function(t,n){var e=String(n).toLowerCase();return K(t,(function(t){return t.search(e)}))},Yt=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Kt=function(t){return function(n){return _t(n,t)}},Jt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return _t(t,"edge/")&&_t(t,"chrome")&&_t(t,"safari")&&_t(t,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Yt],search:function(t){return _t(t,"chrome")&&!_t(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return _t(t,"msie")||_t(t,"trident")}},{name:"Opera",versionRegexes:[Yt,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Kt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Kt("firefox")},{name:"Safari",versionRegexes:[Yt,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(_t(t,"safari")||_t(t,"mobile/"))&&_t(t,"applewebkit")}}],$t=[{name:"Windows",search:Kt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return _t(t,"iphone")||_t(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Kt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Kt("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Kt("linux"),versionRegexes:[]},{name:"Solaris",search:Kt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Kt("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Kt("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Qt={browsers:h(Jt),oses:h($t)},Zt="Edge",tn="Chrome",nn="Opera",en="Firefox",on="Safari",rn=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isEdge:o(Zt),isChrome:o(tn),isIE:o("IE"),isOpera:o(nn),isFirefox:o(en),isSafari:o(on)}},un=function(){return rn({current:void 0,version:Xt.unknown()})},an=rn,cn=(h(Zt),h(tn),h("IE"),h(nn),h(en),h(on),"Windows"),sn="Android",fn="Linux",ln="Solaris",dn="FreeBSD",mn="ChromeOS",gn=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isWindows:o(cn),isiOS:o("iOS"),isAndroid:o(sn),isOSX:o("OSX"),isLinux:o(fn),isSolaris:o(ln),isFreeBSD:o(dn),isChromeOS:o(mn)}},pn=function(){return gn({current:void 0,version:Xt.unknown()})},hn=gn,vn=(h(cn),h("iOS"),h(sn),h(fn),h("OSX"),h(ln),h(dn),h(mn),function(t){return window.matchMedia(t).matches}),bn=Ut((function(){return function(t,n,e){var o=Qt.browsers(),r=Qt.oses(),i=n.bind((function(t){return function(t,n){return st(n.brands,(function(n){var e=n.brand.toLowerCase();return K(t,(function(t){var n;return e===(null===(n=t.brand)||void 0===n?void 0:n.toLowerCase())})).map((function(t){return{current:t.name,version:Xt.nu(parseInt(n.version,10),0)}}))}))}(o,t)})).orThunk((function(){return function(t,n){return qt(t,n).map((function(t){var e=Xt.detect(t.versionRegexes,n);return{current:t.name,version:e}}))}(o,t)})).fold(un,an),u=function(t,n){return qt(t,n).map((function(t){var e=Xt.detect(t.versionRegexes,n);return{current:t.name,version:e}}))}(r,t).fold(pn,hn),a=function(t,n,e,o){var r=t.isiOS()&&!0===/ipad/i.test(e),i=t.isiOS()&&!r,u=t.isiOS()||t.isAndroid(),a=u||o("(pointer:coarse)"),c=r||!i&&u&&o("(min-device-width:768px)"),s=i||u&&!c,f=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e),l=!s&&!c&&!f;return{isiPad:h(r),isiPhone:h(i),isTablet:h(c),isPhone:h(s),isTouch:h(a),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:h(f),isDesktop:h(l)}}(u,i,t,e);return{browser:i,os:u,deviceType:a}}(navigator.userAgent,I.from(navigator.userAgentData),vn)})),yn=function(){return bn()},xn=function(t,n){var e=t.dom;if(1!==e.nodeType)return!1;var o=e;if(void 0!==o.matches)return o.matches(n);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(n);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(n);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},wn=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},Sn=function(t,n){return t.dom===n.dom},kn=function(t,n){return yn().browser.isIE()?function(t,n){return e=t.dom,o=n.dom,function(t,n,e){return 0!=(t.compareDocumentPosition(n)&e)}(e,o,Node.DOCUMENT_POSITION_CONTAINED_BY);var e,o}(t,n):function(t,n){var e=t.dom,o=n.dom;return e!==o&&e.contains(o)}(t,n)},Cn=function(t){return Rt(t.dom.ownerDocument)},On=function(t){return Lt(t)?t:Cn(t)},_n=function(t){return Rt(On(t).dom.documentElement)},Tn=function(t){return Rt(On(t).dom.defaultView)},En=function(t){return I.from(t.dom.parentNode).map(Rt)},Bn=function(t){return I.from(t.dom.offsetParent).map(Rt)},Mn=function(t){return U(t.dom.childNodes,Rt)},An=function(t,n){var e=t.dom.childNodes;return I.from(e[n]).map(Rt)},Dn=function(t,n){return{element:t,offset:n}},Fn=function(t,n){var e=Mn(t);return e.length>0&&n<e.length?Dn(e[n],0):Dn(t,n)},In=function(t){return Wt(t)&&f(t.dom.host)},Rn=l(Element.prototype.attachShadow)&&l(Node.prototype.getRootNode),Vn=h(Rn),Pn=Rn?function(t){return Rt(t.dom.getRootNode())}:On,Hn=function(t){return In(t)?t:Rt(On(t).dom.body)},zn=function(t){var n=Pn(t);return In(n)?I.some(n):I.none()},Nn=function(t){return Rt(t.dom.host)},Ln=function(t){var n=Nt(t)?t.dom.parentNode:t.dom;if(null==n||null===n.ownerDocument)return!1;var e,o,r=n.ownerDocument;return zn(Rt(n)).fold((function(){return r.body.contains(n)}),(e=Ln,o=Nn,function(t){return e(o(t))}))},Wn=function(){return Un(Rt(document))},Un=function(t){var n=t.dom.body;if(null==n)throw new Error("Body is not available yet");return Rt(n)},jn=function(t,n,e){if(!(o(e)||a(e)||d(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")},Gn=function(t,n,e){jn(t.dom,n,e)},Xn=function(t,n){var e=t.dom;dt(n,(function(t,n){jn(e,n,t)}))},qn=function(t,n){var e=t.dom.getAttribute(n);return null===e?void 0:e},Yn=function(t,n){return I.from(qn(t,n))},Kn=function(t,n){var e=t.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},Jn=function(t,n){t.dom.removeAttribute(n)},$n=function(t,n,e){if(!o(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);Mt(t)&&t.style.setProperty(n,e)},Qn=function(t,n){Mt(t)&&t.style.removeProperty(n)},Zn=function(t,n,e){var o=t.dom;$n(o,n,e)},te=function(t,n){var e=t.dom;dt(n,(function(t,n){$n(e,n,t)}))},ne=function(t,n){var e=t.dom;dt(n,(function(t,n){t.fold((function(){Qn(e,n)}),(function(t){$n(e,n,t)}))}))},ee=function(t,n){var e=t.dom,o=window.getComputedStyle(e).getPropertyValue(n);return""!==o||Ln(t)?o:oe(e,n)},oe=function(t,n){return Mt(t)?t.style.getPropertyValue(n):""},re=function(t,n){var e=t.dom,o=oe(e,n);return I.from(o).filter((function(t){return t.length>0}))},ie=function(t){var n={},e=t.dom;if(Mt(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);n[r]=e.style[r]}return n},ue=function(t,n,e){var o=Ft(t);return Zn(o,n,e),re(o,n).isSome()},ae=function(t,n){var e=t.dom;Qn(e,n),wt(Yn(t,"style").map(Et),"")&&Jn(t,"style")},ce=function(t){return t.dom.offsetWidth},se=function(t,n){var e=function(e){var o=n(e);if(o<=0||null===o){var r=ee(e,t);return parseFloat(r)||0}return o},o=function(t,n){return Y(n,(function(n,e){var o=ee(t,e),r=void 0===o?0:parseInt(o,10);return isNaN(r)?n:n+r}),0)};return{set:function(n,e){if(!d(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var o=n.dom;Mt(o)&&(o.style[t]=e+"px")},get:e,getOuter:e,aggregate:o,max:function(t,n,e){var r=o(t,e);return n>r?n-r:0}}},fe=se("height",(function(t){var n=t.dom;return Ln(t)?n.getBoundingClientRect().height:n.offsetHeight})),le=function(t){return fe.get(t)},de=function(t){return fe.getOuter(t)},me=function(t,n){return{left:t,top:n,translate:function(e,o){return me(t+e,n+o)}}},ge=me,pe=function(t,n){return void 0!==t?t:void 0!==n?n:0},he=function(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement;if(e===t.dom)return ge(e.offsetLeft,e.offsetTop);var i=pe(null==o?void 0:o.pageYOffset,r.scrollTop),u=pe(null==o?void 0:o.pageXOffset,r.scrollLeft),a=pe(r.clientTop,e.clientTop),c=pe(r.clientLeft,e.clientLeft);return ve(t).translate(u-c,i-a)},ve=function(t){var n=t.dom,e=n.ownerDocument.body;return e===n?ge(e.offsetLeft,e.offsetTop):Ln(t)?function(t){var n=t.getBoundingClientRect();return ge(n.left,n.top)}(n):ge(0,0)},be=se("width",(function(t){return t.dom.offsetWidth})),ye=function(t){return be.get(t)},xe=function(t){return be.getOuter(t)},we=function(t){var n=Rt(function(t){if(Vn()&&f(t.target)){var n=Rt(t.target);if(zt(n)&&function(t){return f(t.dom.shadowRoot)}(n)&&t.composed&&t.composedPath){var e=t.composedPath();if(e)return ut(e)}}return I.from(t.target)}(t).getOr(t.target)),e=function(){return t.stopPropagation()},o=function(){return t.preventDefault()},r=p(o,e);return function(t,n,e,o,r,i,u){return{target:t,x:n,y:e,stop:o,prevent:r,kill:i,raw:u}}(n,t.clientX,t.clientY,e,o,r,t)},Se=function(t,n,e,o,r){var i=function(t,n){return function(e){t(e)&&n(we(e))}}(e,o);return t.dom.addEventListener(n,i,r),{unbind:y(ke,t,n,i,r)}},ke=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},Ce=function(t,n){En(t).each((function(e){e.dom.insertBefore(n.dom,t.dom)}))},Oe=function(t,n){var e=function(t){return I.from(t.dom.nextSibling).map(Rt)}(t);e.fold((function(){En(t).each((function(t){Te(t,n)}))}),(function(t){Ce(t,n)}))},_e=function(t,n){var e=function(t){return An(t,0)}(t);e.fold((function(){Te(t,n)}),(function(e){t.dom.insertBefore(n.dom,e.dom)}))},Te=function(t,n){t.dom.appendChild(n.dom)},Ee=function(t,n){j(n,(function(n){Te(t,n)}))},Be=function(t){t.dom.textContent="",j(Mn(t),(function(t){Me(t)}))},Me=function(t){var n=t.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},Ae=function(t){var n,e=Mn(t);e.length>0&&(n=t,j(e,(function(t){Ce(n,t)}))),Me(t)},De=function(t){var n=void 0!==t?t.dom:document,e=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop;return ge(e,o)},Fe=function(t,n,e){var o=(void 0!==e?e.dom:document).defaultView;o&&o.scrollTo(t,n)},Ie=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},Re=function(t){var n=void 0===t?window:t,e=n.document,o=De(Rt(e));return function(t){var n=void 0===t?window:t;return yn().browser.isFirefox()?I.none():I.from(n.visualViewport)}(n).fold((function(){var t=n.document.documentElement,e=t.clientWidth,r=t.clientHeight;return Ie(o.left,o.top,e,r)}),(function(t){return Ie(Math.max(t.pageLeft,o.left),Math.max(t.pageTop,o.top),t.width,t.height)}))},Ve=function(t,n){return t.view(n).fold(h([]),(function(n){var e=t.owner(n),o=Ve(t,e);return[n].concat(o)}))},Pe=Object.freeze({__proto__:null,view:function(t){var n;return(t.dom===document?I.none():I.from(null===(n=t.dom.defaultView)||void 0===n?void 0:n.frameElement)).map(Rt)},owner:function(t){return Cn(t)}}),He=function(t){var n=Rt(document),e=De(n),o=function(t,n){var e=n.owner(t),o=Ve(n,e);return I.some(o)}(t,Pe);return o.fold(y(he,t),(function(n){var o=ve(t),r=q(n,(function(t,n){var e=ve(n);return{left:t.left+e.left,top:t.top+e.top}}),{left:0,top:0});return ge(r.left+o.left+e.left,r.top+o.top+e.top)}))},ze=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},Ne=function(t){var n=he(t),e=xe(t),o=de(t);return ze(n.left,n.top,e,o)},Le=function(t){var n=He(t),e=xe(t),o=de(t);return ze(n.left,n.top,e,o)},We=function(){return Re(window)},Ue=function(t){return{isValue:k,isError:S,getOr:h(t),getOrThunk:h(t),getOrDie:h(t),or:function(n){return Ue(t)},orThunk:function(n){return Ue(t)},fold:function(n,e){return e(t)},map:function(n){return Ue(n(t))},mapError:function(n){return Ue(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return I.some(t)}}},je=function(t){return{isValue:S,isError:k,getOr:v,getOrThunk:function(t){return t()},getOrDie:function(){return w(String(t))()},or:v,orThunk:function(t){return t()},fold:function(n,e){return n(t)},map:function(n){return je(t)},mapError:function(n){return je(n(t))},each:g,bind:function(n){return je(t)},exists:S,forall:k,toOptional:I.none}},Ge={value:Ue,error:je,fromOption:function(t,n){return t.fold((function(){return je(n)}),Ue)}};!function(t){t[t.Error=0]="Error",t[t.Value=1]="Value"}(Vt||(Vt={}));var Xe=function(t,n,e){return t.stype===Vt.Error?n(t.serror):e(t.svalue)},qe=function(t){return{stype:Vt.Value,svalue:t}},Ye=function(t){return{stype:Vt.Error,serror:t}},Ke=qe,Je=Ye,$e=Xe,Qe=function(t,n,e,o){return{tag:"field",key:t,newKey:n,presence:e,prop:o}},Ze=function(t,n,e){switch(t.tag){case"field":return n(t.key,t.newKey,t.presence,t.prop);case"custom":return e(t.newKey,t.instantiator)}},to=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<n.length;r++){var i=n[r];for(var u in i)yt(i,u)&&(o[u]=t(o[u],i[u]))}return o}},no=to((function(t,n){return r(t)&&r(n)?no(t,n):n})),eo=to((function(t,n){return n})),oo=function(t){return{tag:"defaultedThunk",process:t}},ro=function(t){return oo(h(t))},io=function(t){return{tag:"mergeWithThunk",process:t}},uo=function(t){var n,e=function(t){var n=[],e=[];return j(t,(function(t){Xe(t,(function(t){return e.push(t)}),(function(t){return n.push(t)}))})),{values:n,errors:e}}(t);return e.errors.length>0?(n=e.errors,p(Je,$)(n)):Ke(e.values)},ao=function(t){return r(t)&&ft(t).length>100?" removed due to size":JSON.stringify(t,null,2)},co=function(t,n){return Je([{path:t,getErrorInfo:n}])},so=function(t){return{extract:function(n,e){return o=t(e),r=function(t){return function(t,n){return co(t,h(n))}(n,t)},o.stype===Vt.Error?r(o.serror):o;var o,r},toString:h("val")}},fo=so(Ke),lo=function(t,n,e,o){return o(bt(t,n).getOrThunk((function(){return e(t)})))},mo=function(t,n,e,o,r){var i=function(t){return r.extract(n.concat([o]),t)},u=function(t){return t.fold((function(){return Ke(I.none())}),(function(t){var e,i,u=r.extract(n.concat([o]),t);return e=u,i=I.some,e.stype===Vt.Value?{stype:Vt.Value,svalue:i(e.svalue)}:e}))};switch(t.tag){case"required":return function(t,n,e,o){return bt(n,e).fold((function(){return function(t,n,e){return co(t,(function(){return'Could not find valid *required* value for "'+n+'" in '+ao(e)}))}(t,e,n)}),o)}(n,e,o,i);case"defaultedThunk":return lo(e,o,t.process,i);case"option":return function(t,n,e){return e(bt(t,n))}(e,o,u);case"defaultedOptionThunk":return function(t,n,e,o){return o(bt(t,n).map((function(n){return!0===n?e(t):n})))}(e,o,t.process,u);case"mergeWithThunk":return lo(e,o,h({}),(function(n){var o=no(t.process(e),n);return i(o)}))}},go=function(t){return{extract:function(n,e){return t().extract(n,e)},toString:function(){return t().toString()}}},po=function(t){return ft(function(t,n){var e,o={};return function(t,n,e,o){dt(t,(function(t,r){(n(t,r)?e:o)(t,r)}))}(t,n,(e=o,function(t,n){e[n]=t}),g),o}(t,f))},ho=function(t){var n=vo(t),e=q(t,(function(t,n){return Ze(n,(function(n){var e;return no(t,((e={})[n]=!0,e))}),h(t))}),{});return{extract:function(t,o){var r=a(o)?[]:po(o),i=X(r,(function(t){return!xt(e,t)}));return 0===i.length?n.extract(t,o):function(t,n){return co(t,(function(){return"There are unsupported fields: ["+n.join(", ")+"] specified"}))}(t,i)},toString:n.toString}},vo=function(t){return{extract:function(n,e){return function(t,n,e){for(var o={},r=[],i=0,u=e;i<u.length;i++){var a=u[i];Ze(a,(function(e,i,u,a){var c=mo(u,t,n,e,a);$e(c,(function(t){r.push.apply(r,t)}),(function(t){o[i]=t}))}),(function(t,e){o[t]=e(n)}))}return r.length>0?Je(r):Ke(o)}(n,e,t)},toString:function(){var n=U(t,(function(t){return Ze(t,(function(t,n,e,o){return t+" -> "+o.toString()}),(function(t,n){return"state("+t+")"}))}));return"obj{\n"+n.join("\n")+"}"}}},bo=function(t){return{extract:function(n,e){var o=U(e,(function(e,o){return t.extract(n.concat(["["+o+"]"]),e)}));return uo(o)},toString:function(){return"array("+t.toString()+")"}}},yo=function(t){return{extract:function(n,e){for(var o=[],r=0,i=t;r<i.length;r++){var u=i[r].extract(n,e);if(u.stype===Vt.Value)return u;o.push(u)}return uo(o)},toString:function(){return"oneOf("+U(t,(function(t){return t.toString()})).join(", ")+")"}}},xo=function(t,n){return{extract:function(e,o){var r,i,u=ft(o),a=function(n,e){return bo(so(t)).extract(n,e)}(e,u);return i=function(t){var r=U(t,(function(t){return Qe(t,t,{tag:"required",process:{}},n)}));return vo(r).extract(e,o)},(r=a).stype===Vt.Value?i(r.svalue):r},toString:function(){return"setOf("+n.toString()+")"}}},wo=p(bo,vo),So=h(fo),ko=function(t,n){return so((function(e){var o=typeof e;return t(e)?Ke(e):Je("Expected type: "+n+" but got: "+o)}))},Co=ko(d,"number"),Oo=ko(o,"string"),_o=ko(a,"boolean"),To=ko(l,"function"),Eo=function(t){if(Object(t)!==t)return!0;switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every((function(n){return Eo(t[n])}));default:return!1}},Bo=so((function(t){return Eo(t)?Ke(t):Je("Expected value to be acceptable for sending via postMessage")})),Mo=function(t,n){return{extract:function(e,o){return bt(o,t).fold((function(){return function(t,n){return co(t,(function(){return'Choice schema did not contain choice key: "'+n+'"'}))}(e,t)}),(function(t){return function(t,n,e,o){return bt(e,o).fold((function(){return function(t,n,e){return co(t,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+ao(n)}))}(t,e,o)}),(function(e){return e.extract(t.concat(["branch: "+o]),n)}))}(e,o,n,t)}))},toString:function(){return"chooseOn("+t+"). Possible values: "+ft(n)}}},Ao=function(t){return so((function(n){return t(n).fold(Je,Ke)}))},Do=function(t,n){return xo((function(n){return t(n).fold(Ye,qe)}),n)},Fo=function(t,n,e){return o=function(t,n,e){return function(t,n){return t.stype===Vt.Error?{stype:Vt.Error,serror:n(t.serror)}:t}(n.extract([t],e),(function(t){return{input:e,errors:t}}))}(t,n,e),Xe(o,Ge.error,Ge.value);var o},Io=function(t){return t.fold((function(t){throw new Error(Vo(t))}),v)},Ro=function(t,n,e){return Io(Fo(t,n,e))},Vo=function(t){return"Errors: \n"+(n=t.errors,e=n.length>10?n.slice(0,10).concat([{path:[],getErrorInfo:h("... (only showing first ten failures)")}]):n,U(e,(function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}))).join("\n")+"\n\nInput object: "+ao(t.input);var n,e},Po=function(t,n){return Mo(t,mt(n,vo))},Ho=Qe,zo=function(t,n){return{tag:"custom",newKey:t,instantiator:n}},No=function(t){return Ao((function(n){return z(t,n)?Ge.value(n):Ge.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')}))},Lo=function(t){return Ho(t,t,{tag:"required",process:{}},So())},Wo=function(t,n){return Ho(t,t,{tag:"required",process:{}},n)},Uo=function(t){return Wo(t,Co)},jo=function(t){return Wo(t,Oo)},Go=function(t,n){return Ho(t,t,{tag:"required",process:{}},No(n))},Xo=function(t){return Wo(t,To)},qo=function(t,n){return Ho(t,t,{tag:"required",process:{}},vo(n))},Yo=function(t,n){return Ho(t,t,{tag:"required",process:{}},wo(n))},Ko=function(t,n){return Ho(t,t,{tag:"required",process:{}},bo(n))},Jo=function(t){return Ho(t,t,{tag:"option",process:{}},So())},$o=function(t,n){return Ho(t,t,{tag:"option",process:{}},n)},Qo=function(t){return $o(t,Co)},Zo=function(t){return $o(t,Oo)},tr=function(t){return $o(t,To)},nr=function(t,n){return $o(t,bo(n))},er=function(t,n){return $o(t,vo(n))},or=function(t,n){return Ho(t,t,ro(n),So())},rr=function(t,n,e){return Ho(t,t,ro(n),e)},ir=function(t,n){return rr(t,n,Co)},ur=function(t,n){return rr(t,n,Oo)},ar=function(t,n,e){return rr(t,n,No(e))},cr=function(t,n){return rr(t,n,_o)},sr=function(t,n){return rr(t,n,To)},fr=function(t,n,e){return rr(t,n,bo(e))},lr=function(t,n,e){return rr(t,n,vo(e))},dr=function(t){var n=t;return{get:function(){return n},set:function(t){n=t}}},mr=function(t){if(!i(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],e={};return j(t,(function(o,r){var u=ft(o);if(1!==u.length)throw new Error("one and only one name per case");var a=u[0],c=o[a];if(void 0!==e[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!i(c))throw new Error("case arguments must be an array");n.push(a),e[a]=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var i=e.length;if(i!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+i);var u=function(t){var o=ft(t);if(n.length!==o.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+o.join(","));if(!Z(n,(function(t){return z(o,t)})))throw new Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+n.join(", "));return t[a].apply(null,e)};return{fold:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(n.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+n.length);var i=n[r];return i.apply(null,e)},match:u,log:function(t){console.log(t,{constructors:n,constructor:a,params:e})}}}})),e};mr([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var gr,pr,hr=function(t,n){return function(t,n){var e;return(e={})[t]=n,e}(t,n)},vr=function(t){return function(t){var n={};return j(t,(function(t){n[t.key]=t.value})),n}(t)},br=function(t){return l(t)?t:S},yr=function(t,n,e){for(var o=t.dom,r=br(e);o.parentNode;){o=o.parentNode;var i=Rt(o),u=n(i);if(u.isSome())return u;if(r(i))break}return I.none()},xr=function(t,n,e){var o=n(t),r=br(e);return o.orThunk((function(){return r(t)?I.none():yr(t,n,r)}))},wr=function(t,n){return Sn(t.element,n.event.target)},Sr={can:k,abort:S,run:g},kr=function(t){if(!xt(t,"can")&&!xt(t,"abort")&&!xt(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return O(O({},Sr),t)},Cr=h,Or=Cr("touchstart"),_r=Cr("touchmove"),Tr=Cr("touchend"),Er=Cr("touchcancel"),Br=Cr("mousedown"),Mr=Cr("mousemove"),Ar=Cr("mouseout"),Dr=Cr("mouseup"),Fr=Cr("mouseover"),Ir=Cr("focusin"),Rr=Cr("focusout"),Vr=Cr("keydown"),Pr=Cr("keyup"),Hr=Cr("input"),zr=Cr("change"),Nr=Cr("click"),Lr=Cr("transitioncancel"),Wr=Cr("transitionend"),Ur=Cr("transitionstart"),jr=Cr("selectstart"),Gr=function(t){return h("alloy."+t)},Xr={tap:Gr("tap")},qr=Gr("focus"),Yr=Gr("blur.post"),Kr=Gr("paste.post"),Jr=Gr("receive"),$r=Gr("execute"),Qr=Gr("focus.item"),Zr=Xr.tap,ti=Gr("longpress"),ni=Gr("sandbox.close"),ei=Gr("typeahead.cancel"),oi=Gr("system.init"),ri=Gr("system.touchmove"),ii=Gr("system.touchend"),ui=Gr("system.scroll"),ai=Gr("system.resize"),ci=Gr("system.attached"),si=Gr("system.detached"),fi=Gr("system.dismissRequested"),li=Gr("system.repositionRequested"),di=Gr("focusmanager.shifted"),mi=Gr("slotcontainer.visibility"),gi=Gr("change.tab"),pi=Gr("dismiss.tab"),hi=Gr("highlight"),vi=Gr("dehighlight"),bi=function(t,n){Si(t,t.element,n,{})},yi=function(t,n,e){Si(t,t.element,n,e)},xi=function(t){bi(t,$r())},wi=function(t,n,e){Si(t,n,e,{})},Si=function(t,n,e,o){var r=O({target:n},o);t.getSystem().triggerEvent(e,n,r)},ki=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)},Ci=function(t){return vr(t)},Oi=function(t,n){return{key:t,value:kr({abort:n})}},_i=function(t){return{key:t,value:kr({run:function(t,n){n.event.prevent()}})}},Ti=function(t,n){return{key:t,value:kr({run:n})}},Ei=function(t,n,e){return{key:t,value:kr({run:function(t,o){n.apply(void 0,[t,o].concat(e))}})}},Bi=function(t){return function(n){return{key:t,value:kr({run:function(t,e){wr(t,e)&&n(t,e)}})}}},Mi=function(t,n,e){return function(t,n){return Ti(t,(function(e,o){e.getSystem().getByUid(n).each((function(n){ki(n,n.element,t,o)}))}))}(t,n.partUids[e])},Ai=function(t,n){return Ti(t,(function(t,e){var o=e.event,r=t.getSystem().getByDom(o.target).getOrThunk((function(){return xr(o.target,(function(n){return t.getSystem().getByDom(n).toOptional()}),S).getOr(t)}));n(t,r,e)}))},Di=function(t){return Ti(t,(function(t,n){n.cut()}))},Fi=function(t){return Ti(t,(function(t,n){n.stop()}))},Ii=function(t,n){return Bi(t)(n)},Ri=Bi(ci()),Vi=Bi(si()),Pi=Bi(oi()),Hi=function(t){return function(n){return Ti(t,n)}}($r()),zi=function(t){return t.dom.innerHTML},Ni=function(t,n){var e,o,r=Cn(t).dom,i=Rt(r.createDocumentFragment()),u=(e=n,(o=(r||document).createElement("div")).innerHTML=e,Mn(Rt(o)));Ee(i,u),Be(t),Te(t,i)},Li=function(t){return In(t)?"#shadow-root":function(t){var n=Ft("div"),e=Rt(t.dom.cloneNode(!0));return Te(n,e),zi(n)}(function(t){return function(t,n){return Rt(t.dom.cloneNode(!1))}(t)}(t))},Wi=function(t){return Li(t)},Ui=Ci([function(t,n){return{key:t,value:kr({can:function(t,n){var e=n.event,o=e.originator,r=e.target;return!function(t,n,e){return Sn(n,t.element)&&!Sn(n,e)}(t,o,r)||(console.warn(qr()+" did not get interpreted by the desired target. \nOriginator: "+Wi(o)+"\nTarget: "+Wi(r)+"\nCheck the "+qr()+" event handlers"),!1)}})}}(qr())]),ji=Object.freeze({__proto__:null,events:Ui}),Gi=0,Xi=function(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++Gi+String(n)},qi=h("alloy-id-"),Yi=h("data-alloy-id"),Ki=qi(),Ji=Yi(),$i=function(t,n){Object.defineProperty(t.dom,Ji,{value:n,writable:!0})},Qi=function(t){var n=zt(t)?t.dom[Ji]:null;return I.from(n)},Zi=function(t){return Xi(t)},tu=v,nu=function(t){var n=function(n){return"The component must be in a context to execute: "+n+(t?"\n"+Wi(t().element)+" is not in context.":"")},e=function(t){return function(){throw new Error(n(t))}},o=function(t){return function(){console.warn(n(t))}};return{debugInfo:h("fake"),triggerEvent:o("triggerEvent"),triggerFocus:o("triggerFocus"),triggerEscape:o("triggerEscape"),broadcast:o("broadcast"),broadcastOn:o("broadcastOn"),broadcastEvent:o("broadcastEvent"),build:e("build"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),isConnected:S}},eu=nu(),ou=function(t){return U(t,(function(t){return Tt(t,"/*")?t.substring(0,t.length-"/*".length):t}))},ru=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:ou(i)}},t},iu=Xi("alloy-premade"),uu=function(t){return hr(iu,t)},au=function(t){return function(t,n){var e=n.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:ou(i.slice(1))}},t}((function(n){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return t.apply(void 0,T([n.getApis(),n],e,!1))}),t)},cu={init:function(){return su({readState:h("No State required")})}},su=function(t){return t},fu=function(t,n){var e={};return dt(t,(function(t,o){dt(t,(function(t,r){var i=bt(e,r).getOr([]);e[r]=i.concat([n(o,t)])}))})),e},lu=function(t){return{classes:c(t.classes)?[]:t.classes,attributes:c(t.attributes)?{}:t.attributes,styles:c(t.styles)?{}:t.styles}},du=function(t){return t.cHandler},mu=function(t,n){return{name:t,handler:n}},gu=function(t,n,e){var o=n[e];return o?function(t,n,e,o){try{var r=rt(e,(function(n,e){var r=n.name,i=e.name,u=o.indexOf(r),a=o.indexOf(i);if(-1===u)throw new Error("The ordering for "+t+" does not have an entry for "+r+".\nOrder specified: "+JSON.stringify(o,null,2));if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2));return u<a?-1:a<u?1:0}));return Ge.value(r)}catch(t){return Ge.error([t])}}("Event: "+e,0,t,o).map((function(t){return function(t){var n=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return Y(t,(function(t,o){return t&&n(o).apply(void 0,e)}),!0)}}(t,(function(t){return t.can})),e=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return Y(t,(function(t,o){return t||n(o).apply(void 0,e)}),!1)}}(t,(function(t){return t.abort}));return{can:n,abort:e,run:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];j(t,(function(t){t.run.apply(void 0,n)}))}}}(U(t,(function(t){return t.handler})))})):function(t,n){return Ge.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(U(n,(function(t){return t.name})),null,2)])}(e,t)},pu=function(t,n){var e,o,r,i=pt(t,(function(t,e){return(1===t.length?Ge.value(t[0].handler):gu(t,n,e)).map((function(o){var r=function(t){var n=function(t){return l(t)?{can:k,abort:S,run:t}:t}(t);return function(t,e){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=[t,e].concat(o);n.abort.apply(void 0,i)?e.stop():n.can.apply(void 0,i)&&n.run.apply(void 0,i)}}(o),i=t.length>1?X(n[e],(function(n){return N(t,(function(t){return t.name===n}))})).join(" > "):t[0].name;return hr(e,function(t,n){return{handler:t,purpose:n}}(r,i))}))}));return e={},r=function(t){var n=[],e=[];return j(t,(function(t){t.fold((function(t){n.push(t)}),(function(t){e.push(t)}))})),{errors:n,values:e}}(i),r.errors.length>0?(o=r.errors,Ge.error($(o))):function(t,n){return 0===t.length?Ge.value(n):Ge.value(no(n,eo.apply(void 0,t)))}(r.values,e)},hu="alloy.base.behaviour",vu=vo([Ho("dom","dom",{tag:"required",process:{}},vo([Lo("tag"),or("styles",{}),or("classes",[]),or("attributes",{}),Jo("value"),Jo("innerHtml")])),Lo("components"),Lo("uid"),or("events",{}),or("apis",{}),Ho("eventOrder","eventOrder",(gr={},gr[$r()]=["disabling",hu,"toggling","typeaheadevents"],gr[qr()]=[hu,"focusing","keying"],gr[oi()]=[hu,"disabling","toggling","representing"],gr[Hr()]=[hu,"representing","streaming","invalidating"],gr[si()]=[hu,"representing","item-events","tooltipping"],gr[Br()]=["focusing",hu,"item-type-events"],gr[Or()]=["focusing",hu,"item-type-events"],gr[Fr()]=["item-type-events","tooltipping"],gr[Jr()]=["receiving","reflecting","tooltipping"],pr=gr,io(h(pr))),So()),Jo("domModification")]),bu=function(t){return t.events},yu=function(t,n){var e=qn(t,n);return void 0===e||""===e?[]:e.split(" ")},xu=function(t){return void 0!==t.dom.classList},wu=function(t,n){xu(t)?t.dom.classList.add(n):function(t,n){(function(t,n,e){var o=yu(t,n).concat([e]);Gn(t,n,o.join(" "))})(t,"class",n)}(t,n)},Su=function(t,n){xu(t)?t.dom.classList.remove(n):function(t,n){(function(t,n,e){var o=X(yu(t,n),(function(t){return t!==e}));o.length>0?Gn(t,n,o.join(" ")):Jn(t,n)})(t,"class",n)}(t,n),function(t){var n=xu(t)?t.dom.classList:function(t){return yu(t,"class")}(t);0===n.length&&Jn(t,"class")}(t)},ku=function(t,n){return xu(t)&&t.dom.classList.contains(n)},Cu=function(t,n){j(n,(function(n){wu(t,n)}))},Ou=function(t,n){j(n,(function(n){Su(t,n)}))},_u=function(t){return t.dom.value},Tu=function(t,n){if(void 0===n)throw new Error("Value.set was undefined");t.dom.value=n},Eu=function(t){var n=function(t){var n=bt(t,"behaviours").getOr({});return Q(ft(n),(function(t){var e=n[t];return f(e)?[e.me]:[]}))}(t);return function(t,n){return function(t,n){var e=U(n,(function(t){return er(t.name(),[Lo("config"),or("state",cu)])})),o=Fo("component.behaviours",vo(e),t.behaviours).fold((function(n){throw new Error(Vo(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))}),v);return{list:n,data:mt(o,(function(t){var n=t.map((function(t){return{config:t.config,state:t.state.init(t.config)}}));return h(n)}))}}(t,n)}(t,n)},Bu=function(t,n,e){var o={"alloy.base.behaviour":bu(t)};return function(t,n,e,o){var r=function(t,n,e){var o=O(O({},e),function(t,n){var e={};return j(t,(function(t){e[t.name()]=t.handlers(n)})),e}(n,t));return fu(o,mu)}(t,e,o);return pu(r,n)}(e,t.eventOrder,n,o).getOrDie()},Mu=function(t){var n=function(){return f},e=dr(eu),o=Io(function(t){return Fo("custom.definition",vu,t)}(t)),r=Eu(t),i=function(t){return t.list}(r),u=function(t){return t.data}(r),a=function(t){var n=Ft(t.tag);Xn(n,t.attributes),Cu(n,t.classes),te(n,t.styles),t.innerHtml.each((function(t){return Ni(n,t)}));var e=t.domChildren;return Ee(n,e),t.value.each((function(t){Tu(n,t)})),t.uid,$i(n,t.uid),n}(function(t,n,e){var o,r,i,u=O(O({},(o=t).dom),{uid:o.uid,domChildren:U(o.components,(function(t){return t.element}))}),a=function(t){return t.domModification.fold((function(){return lu({})}),lu)}(t),c={"alloy.base.modification":a},s=n.length>0?function(t,n,e,o){var r=O({},n);j(e,(function(n){r[n.name()]=n.exhibit(t,o)}));var i=fu(r,(function(t,n){return{name:t,modification:n}})),u=function(t){return q(t,(function(t,n){return O(O({},n.modification),t)}),{})},a=q(i.classes,(function(t,n){return n.modification.concat(t)}),[]),c=u(i.attributes),s=u(i.styles);return lu({classes:a,attributes:c,styles:s})}(e,c,n,u):a;return i=s,O(O({},r=u),{attributes:O(O({},r.attributes),i.attributes),styles:O(O({},r.styles),i.styles),classes:r.classes.concat(i.classes)})}(o,i,u)),c=Bu(o,i,u),s=dr(o.components),f={uid:t.uid,getSystem:e.get,config:function(n){var e=u;return(l(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))})()},hasConfigured:function(t){return l(u[t.name()])},spec:t,readState:function(t){return u[t]().map((function(t){return t.state.readState()})).getOr("not enabled")},getApis:function(){return o.apis},connect:function(t){e.set(t)},disconnect:function(){e.set(nu(n))},element:a,syncComponents:function(){var t=Mn(a),n=Q(t,(function(t){return e.get().getByDom(t).fold((function(){return[]}),ot)}));s.set(n)},components:s.get,events:c};return f},Au=function(t){var n=It(t);return Du({element:n})},Du=function(t){var n=Ro("external.component",ho([Lo("element"),Jo("uid")]),t),e=dr(nu()),o=n.uid.getOrThunk((function(){return Zi("external")}));$i(n.element,o);var r={uid:o,getSystem:e.get,config:I.none,hasConfigured:S,connect:function(t){e.set(t)},disconnect:function(){e.set(nu((function(){return r})))},getApis:function(){return{}},element:n.element,spec:t,readState:h("No state"),syncComponents:g,components:h([]),events:{}};return uu(r)},Fu=Zi,Iu=function(t){return function(t){return bt(t,iu)}(t).getOrThunk((function(){return function(t){var n=tu(t),e=n.events,o=_(n,["events"]),r=function(t){var n=bt(t,"components").getOr([]);return U(n,Iu)}(o),i=O(O({},o),{events:O(O({},ji),e),components:r});return Ge.value(Mu(i))}(function(t){return yt(t,"uid")}(t)?t:O({uid:Fu("")},t)).getOrDie()}))},Ru=uu;function Vu(t,n,e,o,r){return t(e,o)?I.some(e):l(r)&&r(e)?I.none():n(e,o,r)}var Pu,Hu=function(t,n,e){for(var o=t.dom,r=l(e)?e:S;o.parentNode;){o=o.parentNode;var i=Rt(o);if(n(i))return I.some(i);if(r(i))break}return I.none()},zu=function(t,n,e){return Vu((function(t,n){return n(t)}),Hu,t,n,e)},Nu=function(t,n,e){return zu(t,n,e).isSome()},Lu=function(t,n,e){return Hu(t,(function(t){return xn(t,n)}),e)},Wu=function(t,n){return function(t,e){return K(t.dom.childNodes,(function(t){return e=Rt(t),xn(e,n);var e})).map(Rt)}(t)},Uu=function(t,n){return function(t,n){var e=void 0===n?document:n.dom;return wn(e)?I.none():I.from(e.querySelector(t)).map(Rt)}(n,t)},ju=function(t,n,e){return Vu((function(t,n){return xn(t,n)}),Lu,t,n,e)},Gu=function(){var t=Xi("aria-owns");return{id:t,link:function(n){Gn(n,"aria-owns",t)},unlink:function(t){Jn(t,"aria-owns")}}},Xu=function(t,n){return Nu(n,(function(n){return Sn(n,t.element)}),S)||function(t,n){return function(t){var n=zu(t,(function(t){if(!zt(t))return!1;var n=qn(t,"id");return void 0!==n&&n.indexOf("aria-owns")>-1}));return n.bind((function(t){var n=qn(t,"id"),e=Pn(t);return Uu(e,'[aria-owns="'+n+'"]')}))}(n).exists((function(n){return Xu(t,n)}))}(t,n)};!function(t){t[t.STOP=0]="STOP",t[t.NORMAL=1]="NORMAL",t[t.LOGGING=2]="LOGGING"}(Pu||(Pu={}));var qu=dr({}),Yu=["alloy/data/Fields","alloy/debugging/Debugging"],Ku=function(t,n,e){return function(t,n,e){switch(bt(qu.get(),t).orThunk((function(){var n=ft(qu.get());return st(n,(function(n){return t.indexOf(n)>-1?I.some(qu.get()[n]):I.none()}))})).getOr(Pu.NORMAL)){case Pu.NORMAL:return e(Ju());case Pu.LOGGING:var o=function(t,n){var e=[],o=(new Date).getTime();return{logEventCut:function(t,n,o){e.push({outcome:"cut",target:n,purpose:o})},logEventStopped:function(t,n,o){e.push({outcome:"stopped",target:n,purpose:o})},logNoParent:function(t,n,o){e.push({outcome:"no-parent",target:n,purpose:o})},logEventNoHandlers:function(t,n){e.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,o){e.push({outcome:"response",purpose:o,target:n})},write:function(){var r=(new Date).getTime();z(["mousemove","mouseover","mouseout",oi()],t)||console.log(t,{event:t,time:r-o,target:n.dom,sequence:U(e,(function(t){return z(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+Wi(t.target)+")":t.outcome}))})}}}(t,n),r=e(o);return o.write(),r;case Pu.STOP:return!0}}(t,n,e)},Ju=h({logEventCut:g,logEventStopped:g,logNoParent:g,logEventNoHandlers:g,logEventResponse:g,write:g}),$u=h([Lo("menu"),Lo("selectedMenu")]),Qu=h([Lo("item"),Lo("selectedItem")]);h(vo(Qu().concat($u())));var Zu=h(vo(Qu())),ta=qo("initSize",[Lo("numColumns"),Lo("numRows")]),na=function(){return qo("markers",[Lo("backgroundMenu")].concat($u()).concat(Qu()))},ea=function(t){return qo("markers",U(t,Lo))},oa=function(t,n,e){return function(){var t=new Error;if(void 0!==t.stack){var n=t.stack.split("\n");K(n,(function(t){return t.indexOf("alloy")>0&&!N(Yu,(function(n){return t.indexOf(n)>-1}))})).getOr("unknown")}}(),Ho(n,n,e,Ao((function(t){return Ge.value((function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)}))})))},ra=function(t){return oa(0,t,ro(g))},ia=function(t){return oa(0,t,ro(I.none))},ua=function(t){return oa(0,t,{tag:"required",process:{}})},aa=function(t){return oa(0,t,{tag:"required",process:{}})},ca=function(t,n){return zo(t,h(n))},sa=function(t){return zo(t,v)},fa=h(ta),la=function(t,n,e,o,r,i,u,a){return void 0===a&&(a=!1),{x:t,y:n,bubble:e,direction:o,placement:r,restriction:i,label:u+"-"+r,alwaysFit:a}},da=mr([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),ma=da.southeast,ga=da.southwest,pa=da.northeast,ha=da.northwest,va=da.south,ba=da.north,ya=da.east,xa=da.west,wa=function(t,n,e,o){var r=t+n;return r>o?e:r<e?o:r},Sa=function(t,n,e){return Math.min(Math.max(t,n),e)},ka=function(t,n){return et(["left","right","top","bottom"],(function(e){return bt(n,e).map((function(n){return function(t,n){switch(n){case 1:return t.x;case 0:return t.x+t.width;case 2:return t.y;case 3:return t.y+t.height}}(t,n)}))}))},Ca="layout",Oa=function(t){return t.x},_a=function(t,n){return t.x+t.width/2-n.width/2},Ta=function(t,n){return t.x+t.width-n.width},Ea=function(t,n){return t.y-n.height},Ba=function(t){return t.y+t.height},Ma=function(t,n){return t.y+t.height/2-n.height/2},Aa=function(t,n,e){return la(Oa(t),Ba(t),e.southeast(),ma(),"southeast",ka(t,{left:1,top:3}),Ca)},Da=function(t,n,e){return la(Ta(t,n),Ba(t),e.southwest(),ga(),"southwest",ka(t,{right:0,top:3}),Ca)},Fa=function(t,n,e){return la(Oa(t),Ea(t,n),e.northeast(),pa(),"northeast",ka(t,{left:1,bottom:2}),Ca)},Ia=function(t,n,e){return la(Ta(t,n),Ea(t,n),e.northwest(),ha(),"northwest",ka(t,{right:0,bottom:2}),Ca)},Ra=function(t,n,e){return la(_a(t,n),Ea(t,n),e.north(),ba(),"north",ka(t,{bottom:2}),Ca)},Va=function(t,n,e){return la(_a(t,n),Ba(t),e.south(),va(),"south",ka(t,{top:3}),Ca)},Pa=function(t,n,e){return la(function(t){return t.x+t.width}(t),Ma(t,n),e.east(),ya(),"east",ka(t,{left:0}),Ca)},Ha=function(t,n,e){return la(function(t,n){return t.x-n.width}(t,n),Ma(t,n),e.west(),xa(),"west",ka(t,{right:1}),Ca)},za=function(){return[Aa,Da,Fa,Ia,Va,Ra,Pa,Ha]},Na=function(){return[Da,Aa,Ia,Fa,Va,Ra,Pa,Ha]},La=function(){return[Fa,Ia,Aa,Da,Ra,Va]},Wa=function(){return[Ia,Fa,Da,Aa,Ra,Va]},Ua=function(){return[Aa,Da,Fa,Ia,Va,Ra]},ja=function(){return[Da,Aa,Ia,Fa,Va,Ra]},Ga=Object.freeze({__proto__:null,events:function(t){return Ci([Ti(Jr(),(function(n,e){var o=t.channels,r=ft(o),i=e,u=function(t,n){return n.universal?t:X(t,(function(t){return z(n.channels,t)}))}(r,i);j(u,(function(t){var e=o[t],r=e.schema,u=Ro("channel["+t+"] data\nReceiver: "+Wi(n.element),r,i.data);e.onReceive(n,u)}))}))])}}),Xa=[Wo("channels",Do(Ge.value,ho([ua("onReceive"),or("schema",So())])))],qa=function(t,n,e){return Pi((function(o,r){e(o,t,n)}))},Ya=function(t){return{key:t,value:void 0}},Ka=function(t,n,e,o,r,i,u){var a=function(t){return xt(t,e)?t[e]():I.none()},c=mt(r,(function(t,n){return function(t,n,e){return function(t,n,e){var o=e.toString(),r=o.indexOf(")")+1,i=o.indexOf("("),u=o.substring(i+1,r-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:ou(u.slice(0,1).concat(u.slice(3)))}},t}((function(o){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var u=[o].concat(r);return o.config({name:h(t)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+e)}),(function(t){var e=Array.prototype.slice.call(u,1);return n.apply(void 0,[o,t.config,t.state].concat(e))}))}),e,n)}(e,t,n)})),s=mt(i,(function(t,n){return ru(t,n)})),f=O(O(O({},s),c),{revoke:y(Ya,e),config:function(n){var o=Ro(e+"-config",t,n);return{key:e,value:{config:o,me:f,configAsRaw:Ut((function(){return Ro(e+"-config",t,n)})),initialConfig:n,state:u}}},schema:h(n),exhibit:function(t,n){return kt(a(t),bt(o,"exhibit"),(function(t,e){return e(n,t.config,t.state)})).getOrThunk((function(){return lu({})}))},name:h(e),handlers:function(t){return a(t).map((function(t){return bt(o,"events").getOr((function(){return{}}))(t.config,t.state)})).getOr({})}});return f},Ja=function(t){return vr(t)},$a=ho([Lo("fields"),Lo("name"),or("active",{}),or("apis",{}),or("state",cu),or("extra",{})]),Qa=function(t){var n=Ro("Creating behaviour: "+t.name,$a,t);return function(t,n,e,o,r,i){var u,a=ho(t),c=er(n,[("config",u=t,$o("config",ho(u)))]);return Ka(a,c,n,e,o,r,i)}(n.fields,n.name,n.active,n.apis,n.extra,n.state)},Za=ho([Lo("branchKey"),Lo("branches"),Lo("name"),or("active",{}),or("apis",{}),or("state",cu),or("extra",{})]),tc=function(t){var n=Ro("Creating behaviour: "+t.name,Za,t);return function(t,n,e,o,r,i){var u=t,a=er(n,[$o("config",t)]);return Ka(u,a,n,e,o,r,i)}(Po(n.branchKey,n.branches),n.name,n.active,n.apis,n.extra,n.state)},nc=h(void 0),ec=Qa({fields:Xa,name:"receiving",active:Ga}),oc=Object.freeze({__proto__:null,exhibit:function(t,n){return lu({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),rc=function(){return Rt(document)},ic=function(t){return t.dom.focus()},uc=function(t){var n=Pn(t).dom;return t.dom===n.activeElement},ac=function(t){return void 0===t&&(t=rc()),I.from(t.dom.activeElement).map(Rt)},cc=function(t){return ac(Pn(t)).filter((function(n){return t.dom.contains(n.dom)}))},sc=function(t,n){var e=Pn(n),o=ac(e).bind((function(t){var e,o,r=function(n){return Sn(t,n)};return r(n)?I.some(n):(e=r,(o=function(t){for(var n=0;n<t.childNodes.length;n++){var r=Rt(t.childNodes[n]);if(e(r))return I.some(r);var i=o(t.childNodes[n]);if(i.isSome())return i}return I.none()})(n.dom))})),r=t(n);return o.each((function(t){ac(e).filter((function(n){return Sn(n,t)})).fold((function(){ic(t)}),g)})),r},fc=function(t,n,e,o,r){var i=function(t){return t+"px"};return{position:t,left:n.map(i),top:e.map(i),right:o.map(i),bottom:r.map(i)}},lc=function(t,n){ne(t,function(t){return O(O({},t),{position:I.some(t.position)})}(n))},dc=mr([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),mc=function(t,n,e,o,r,i){var u=n.rect,a=u.x-e,c=u.y-o,s=r-(a+u.width),f=i-(c+u.height),l=I.some(a),d=I.some(c),m=I.some(s),g=I.some(f),p=I.none();return n.direction.fold((function(){return fc(t,l,d,p,p)}),(function(){return fc(t,p,d,m,p)}),(function(){return fc(t,l,p,p,g)}),(function(){return fc(t,p,p,m,g)}),(function(){return fc(t,l,d,p,p)}),(function(){return fc(t,l,p,p,g)}),(function(){return fc(t,l,d,p,p)}),(function(){return fc(t,p,d,m,p)}))},gc=function(t,n){return t.fold((function(){var t=n.rect;return fc("absolute",I.some(t.x),I.some(t.y),I.none(),I.none())}),(function(t,e,o,r){return mc("absolute",n,t,e,o,r)}),(function(t,e,o,r){return mc("fixed",n,t,e,o,r)}))},pc=function(t,n){var e=y(He,n),o=t.fold(e,e,(function(){var t=De();return He(n).translate(-t.left,-t.top)})),r=xe(n),i=de(n);return ze(o.left,o.top,r,i)},hc=function(t,n){return n.fold((function(){return t.fold(We,We,ze)}),(function(n){return t.fold(n,n,(function(){var e=n(),o=vc(t,e.x,e.y);return ze(o.left,o.top,e.width,e.height)}))}))},vc=function(t,n,e){var o=ge(n,e);return t.fold(h(o),h(o),(function(){var t=De();return o.translate(-t.left,-t.top)}))};dc.none;var bc,yc=dc.relative,xc=dc.fixed,wc="data-alloy-placement",Sc=function(t){return Yn(t,wc)},kc=mr([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),Cc=function(t,n,e,o){var r=t.bubble,i=r.offset,u=function(t,n,e){var o=function(o,r){return n[o].map((function(n){var i="top"===o||"bottom"===o,u=i?e.top:e.left,a=("left"===o||"top"===o?Math.max:Math.min)(n,r)+u;return i?Sa(a,t.y,t.bottom):Sa(a,t.x,t.right)})).getOr(r)},r=o("left",t.x),i=o("top",t.y),u=o("right",t.right),a=o("bottom",t.bottom);return ze(r,i,u-r,a-i)}(o,t.restriction,i),a=t.x+i.left,c=t.y+i.top,s=ze(a,c,n,e),f=function(t,n){var e=n.x,o=n.y,r=n.right,i=n.bottom,u=t.x,a=t.y,c=t.right,s=t.bottom,f=t.width,l=t.height;return{originInBounds:u>=e&&u<=r&&a>=o&&a<=i,sizeInBounds:c<=r&&c>=e&&s<=i&&s>=o,visibleW:Math.min(f,u>=e?r-u:c-e),visibleH:Math.min(l,a>=o?i-a:s-o)}}(s,u),l=f.originInBounds,d=f.sizeInBounds,m=f.visibleW,g=f.visibleH,p=l&&d,v=p?s:function(t,n){var e=n.x,o=n.y,r=n.right,i=n.bottom,u=t.x,a=t.y,c=t.width,s=t.height,f=Math.max(e,r-c),l=Math.max(o,i-s),d=Sa(u,e,f),m=Sa(a,o,l),g=Math.min(d+c,r)-d,p=Math.min(m+s,i)-m;return ze(d,m,g,p)}(s,u),b=v.width>0&&v.height>0,y=function(t,n,e){var o=h(n.bottom-e.y),r=h(e.bottom-n.y),i=function(t,n,e,o){return t.fold(n,n,o,o,n,o,e,e)}(t,r,r,o),u=h(n.right-e.x),a=h(e.right-n.x),c=function(t,n,e,o){return t.fold(n,o,n,o,e,e,n,o)}(t,a,a,u);return{maxWidth:c,maxHeight:i}}(t.direction,v,o),x=y.maxWidth,w={rect:v,maxHeight:y.maxHeight,maxWidth:x,direction:t.direction,placement:t.placement,classes:{on:r.classesOn,off:r.classesOff},layout:t.label,testY:c};return p||t.alwaysFit?kc.fit(w):kc.nofit(w,m,g,b)},Oc=function(t){var n=dr(I.none()),e=function(){return n.get().each(t)};return{clear:function(){e(),n.set(I.none())},isSet:function(){return n.get().isSome()},get:function(){return n.get()},set:function(t){e(),n.set(I.some(t))}}},_c=function(){return Oc((function(t){return t.destroy()}))},Tc=function(){return Oc((function(t){return t.unbind()}))},Ec=function(){var t=Oc(g);return O(O({},t),{on:function(n){return t.get().each(n)}})},Bc=k,Mc=function(t,n,e){return function(t,n,e,o){return Se(t,n,e,o,!1)}(t,n,Bc,e)},Ac=function(t,n,e){return function(t,n,e,o){return Se(t,n,e,o,!0)}(t,n,Bc,e)},Dc=we,Fc=["top","bottom","right","left"],Ic="data-alloy-transition-timer",Rc=function(t,n,e,r,i,u){var a=function(t,n,e){return e.exists((function(e){var o=t.mode;return"all"===o||e[o]!==n[o]}))}(r,i,u);if(a||function(t,n){return function(t,n){return Z(n,(function(n){return ku(t,n)}))}(t,n.classes)}(t,r)){Zn(t,"position",e.position);var c=pc(n,t),f=gc(n,O(O({},i),{rect:c})),l=et(Fc,(function(t){return f[t]}));(function(t,n){var e=function(t){return parseFloat(t).toFixed(3)};return ht(n,(function(n,o){var r,i,u,a=t[o].map(e),c=n.map(e);return void 0===u&&(u=b),!kt(r=a,i=c,u).getOr(r.isNone()&&i.isNone())})).isSome()})(e,l)&&(ne(t,l),a&&function(t,n){Cu(t,n.classes),Yn(t,Ic).each((function(n){clearTimeout(parseInt(n,10)),Jn(t,Ic)})),function(t,n){var e,r=Tc(),i=Tc(),u=function(n){var e,o=null!==(e=n.raw.pseudoElement)&&void 0!==e?e:"";return Sn(n.target,t)&&!Bt(o)&&z(Fc,n.raw.propertyName)},a=function(o){if(s(o)||u(o)){r.clear(),i.clear();var a=null==o?void 0:o.raw.type;(s(a)||a===Wr())&&(clearTimeout(e),Jn(t,Ic),Ou(t,n.classes))}},c=function(){r.set(Mc(t,Wr(),a)),i.set(Mc(t,Lr(),a))};if("ontransitionstart"in t.dom)var f=Mc(t,Ur(),(function(t){u(t)&&(f.unbind(),c())}));else c();var l=function(t){var n=function(n){var e=ee(t,n),r=o(e)?e.split(/\s*,\s*/):[];return X(r,Bt)},e=function(t){if(o(t)&&/^[\d.]+/.test(t)){var n=parseFloat(t);return Tt(t,"ms")?n:1e3*n}return 0},r=n("transition-delay"),i=n("transition-duration");return Y(i,(function(t,n,o){var i=e(r[o])+e(n);return Math.max(t,i)}),0)}(t);requestAnimationFrame((function(){e=setTimeout(a,l+17),Gn(t,Ic,e)}))}(t,n)}(t,r),ce(t))}else Ou(t,r.classes)},Vc=function(t,n){!function(t,n){var e=fe.max(t,n,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);Zn(t,"max-height",e+"px")}(t,Math.floor(n))},Pc=h((function(t,n){Vc(t,n),te(t,{"overflow-x":"hidden","overflow-y":"auto"})})),Hc=h((function(t,n){Vc(t,n)})),zc=function(t,n,e){return void 0===t[n]?e:t[n]},Nc=function(t,n,e,o){var r=function(t,n,e,o){ae(n,"max-height"),ae(n,"max-width");var r,i={width:xe(r=n),height:de(r)};return function(t,n,e,o,r,i){var u=o.width,a=o.height,c=function(n,c,s,f,l){var d=n(e,o,r,t,i),m=Cc(d,u,a,i);return m.fold(h(m),(function(t,n,e,o){return(l===o?e>f||n>s:!l&&o)?m:kc.nofit(c,s,f,l)}))};return Y(n,(function(t,n){var e=y(c,n);return t.fold(h(t),e)}),kc.nofit({rect:e,maxHeight:o.height,maxWidth:o.width,direction:ma(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:e.y},-1,-1,!1)).fold(v,v)}(n,o.preference,t,i,e,o.bounds)}(t,n,e,o);return function(t,n,e){var o=gc(e.origin,n);e.transition.each((function(r){Rc(t,e.origin,o,r,n,e.lastPlacement)})),lc(t,o)}(n,r,o),function(t,n){!function(t,n){Gn(t,wc,n)}(t,n.placement)}(n,r),function(t,n){var e=n.classes;Ou(t,e.off),Cu(t,e.on)}(n,r),function(t,n,e){(0,e.maxHeightFunction)(t,n.maxHeight)}(n,r,o),function(t,n,e){(0,e.maxWidthFunction)(t,n.maxWidth)}(n,r,o),{layout:r.layout,placement:r.placement}},Lc=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],Wc=function(t,n,e,o){void 0===o&&(o=1);var r=t*o,i=n*o,u=function(t){return bt(e,t).getOr([])},a=function(t,n,e){var o=nt(Lc,e);return{offset:ge(t,n),classesOn:Q(e,u),classesOff:Q(o,u)}};return{southeast:function(){return a(-t,n,["top","alignLeft"])},southwest:function(){return a(t,n,["top","alignRight"])},south:function(){return a(-t/2,n,["top","alignCentre"])},northeast:function(){return a(-t,-n,["bottom","alignLeft"])},northwest:function(){return a(t,-n,["bottom","alignRight"])},north:function(){return a(-t/2,-n,["bottom","alignCentre"])},east:function(){return a(t,-n/2,["valignCentre","left"])},west:function(){return a(-t,-n/2,["valignCentre","right"])},insetNortheast:function(){return a(r,i,["top","alignLeft","inset"])},insetNorthwest:function(){return a(-r,i,["top","alignRight","inset"])},insetNorth:function(){return a(-r/2,i,["top","alignCentre","inset"])},insetSoutheast:function(){return a(r,-i,["bottom","alignLeft","inset"])},insetSouthwest:function(){return a(-r,-i,["bottom","alignRight","inset"])},insetSouth:function(){return a(-r/2,-i,["bottom","alignCentre","inset"])},insetEast:function(){return a(-r,-i/2,["valignCentre","right","inset"])},insetWest:function(){return a(r,-i/2,["valignCentre","left","inset"])}}},Uc=function(){return Wc(0,0,{})},jc=v,Gc=function(t,n){return function(e){return"rtl"===Xc(e)?n:t}},Xc=function(t){return"rtl"===ee(t,"direction")?"rtl":"ltr"};!function(t){t.TopToBottom="toptobottom",t.BottomToTop="bottomtotop"}(bc||(bc={}));var qc="data-alloy-vertical-dir",Yc=function(t){return Nu(t,(function(t){return zt(t)&&qn(t,"data-alloy-vertical-dir")===bc.BottomToTop}))},Kc=function(){return er("layouts",[Lo("onLtr"),Lo("onRtl"),Jo("onBottomLtr"),Jo("onBottomRtl")])},Jc=function(t,n,e,o,r,i,u){var a=u.map(Yc).getOr(!1),c=n.layouts.map((function(n){return n.onLtr(t)})),s=n.layouts.map((function(n){return n.onRtl(t)})),f=a?n.layouts.bind((function(n){return n.onBottomLtr.map((function(n){return n(t)}))})).or(c).getOr(r):c.getOr(e),l=a?n.layouts.bind((function(n){return n.onBottomRtl.map((function(n){return n(t)}))})).or(s).getOr(i):s.getOr(o);return Gc(f,l)(t)},$c=[Lo("hotspot"),Jo("bubble"),or("overrides",{}),Kc(),ca("placement",(function(t,n,e){var o=n.hotspot,r=pc(e,o.element),i=Jc(t.element,n,Ua(),ja(),La(),Wa(),I.some(n.hotspot.element));return I.some(jc({anchorBox:r,bubble:n.bubble.getOr(Uc()),overrides:n.overrides,layouts:i,placer:I.none()}))}))],Qc=[Lo("x"),Lo("y"),or("height",0),or("width",0),or("bubble",Uc()),or("overrides",{}),Kc(),ca("placement",(function(t,n,e){var o=vc(e,n.x,n.y),r=ze(o.left,o.top,n.width,n.height),i=Jc(t.element,n,za(),Na(),za(),Na(),I.none());return I.some(jc({anchorBox:r,bubble:n.bubble,overrides:n.overrides,layouts:i,placer:I.none()}))}))],Zc=mr([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),ts=function(t){return t.fold(v,(function(t,n,e){return t.translate(-n,-e)}))},ns=function(t){return t.fold(v,v)},es=function(t){return Y(t,(function(t,n){return t.translate(n.left,n.top)}),ge(0,0))},os=function(t){var n=U(t,ns);return es(n)},rs=Zc.screen,is=Zc.absolute,us=function(t,n,e){var o=Cn(t.element),r=De(o),i=function(t,n,e){var o=Tn(e.root).dom;return I.from(o.frameElement).map(Rt).filter((function(n){var e=Cn(n),o=Cn(t.element);return Sn(e,o)})).map(he)}(t,0,e).getOr(r);return is(i,r.left,r.top)},as=function(t,n,e,o){var r=rs(ge(t,n));return I.some(function(t,n,e){return{point:t,width:n,height:e}}(r,e,o))},cs=function(t,n,e,o,r){return t.map((function(t){var i,u,a,c,s,f,l,d=[n,t.point],m=(i=function(){return os(d)},u=function(){return os(d)},a=function(){return function(t){var n=U(t,ts);return es(n)}(d)},o.fold(i,u,a)),g=(c=m.left,s=m.top,f=t.width,l=t.height,{x:c,y:s,width:f,height:l}),p=e.showAbove?La():Ua(),h=e.showAbove?Wa():ja(),v=Jc(r,e,p,h,p,h,I.none());return jc({anchorBox:g,bubble:e.bubble.getOr(Uc()),overrides:e.overrides,layouts:v,placer:I.none()})}))},ss=[Lo("node"),Lo("root"),Jo("bubble"),Kc(),or("overrides",{}),or("showAbove",!1),ca("placement",(function(t,n,e){var o=us(t,0,n);return n.node.filter(Ln).bind((function(r){var i=r.dom.getBoundingClientRect(),u=as(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element);return cs(u,o,n,e,a)}))}))],fs=function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}},ls=mr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),ds=(ls.before,ls.on,ls.after,function(t){return t.fold(v,v,v)}),ms=mr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),gs={domRange:ms.domRange,relative:ms.relative,exact:ms.exact,exactFromRange:function(t){return ms.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){var n=function(t){return t.match({domRange:function(t){return Rt(t.startContainer)},relative:function(t,n){return ds(t)},exact:function(t,n,e,o){return t}})}(t);return Tn(n)},range:fs},ps=function(t,n,e){var o,r=t.document.createRange();return o=r,n.fold((function(t){o.setStartBefore(t.dom)}),(function(t,n){o.setStart(t.dom,n)}),(function(t){o.setStartAfter(t.dom)})),function(t,n){n.fold((function(n){t.setEndBefore(n.dom)}),(function(n,e){t.setEnd(n.dom,e)}),(function(n){t.setEndAfter(n.dom)}))}(r,e),r},hs=function(t,n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},vs=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},bs=mr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),ys=function(t,n,e){return n(Rt(e.startContainer),e.startOffset,Rt(e.endContainer),e.endOffset)},xs=function(t,n){return function(t,n){var e=function(t,n){return n.match({domRange:function(t){return{ltr:h(t),rtl:I.none}},relative:function(n,e){return{ltr:Ut((function(){return ps(t,n,e)})),rtl:Ut((function(){return I.some(ps(t,e,n))}))}},exact:function(n,e,o,r){return{ltr:Ut((function(){return hs(t,n,e,o,r)})),rtl:Ut((function(){return I.some(hs(t,o,r,n,e))}))}}})}(t,n);return function(t,n){var e=n.ltr();return e.collapsed?n.rtl().filter((function(t){return!1===t.collapsed})).map((function(t){return bs.rtl(Rt(t.endContainer),t.endOffset,Rt(t.startContainer),t.startOffset)})).getOrThunk((function(){return ys(0,bs.ltr,e)})):ys(0,bs.ltr,e)}(0,e)}(t,n).match({ltr:function(n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},rtl:function(n,e,o,r){var i=t.document.createRange();return i.setStart(o.dom,r),i.setEnd(n.dom,e),i}})};bs.ltr,bs.rtl;var ws,Ss=function(t,n){var e=function(n){return t(n)?I.from(n.dom.nodeValue):I.none()};return{get:function(n){if(!t(n))throw new Error("Can only get text value of a text node");return e(n).getOr("")},getOption:e,set:function(n,e){if(!t(n))throw new Error("Can only set raw text value of a text node");n.dom.nodeValue=e}}}(Nt),ks=function(t){return Ss.getOption(t)},Cs=["img","br"],Os=function(t){var n=ks(t).filter((function(t){return 0!==t.trim().length||t.indexOf("")>-1})).isSome();return n||z(Cs,Pt(t))},_s=function(t,n){return function(t,n){var e=void 0===n?document:n.dom;return wn(e)?[]:U(e.querySelectorAll(t),Rt)}(n,t)},Ts=function(t){if(t.rangeCount>0){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return I.some(fs(Rt(n.startContainer),n.startOffset,Rt(e.endContainer),e.endOffset))}return I.none()},Es=function(t){if(null===t.anchorNode||null===t.focusNode)return Ts(t);var n=Rt(t.anchorNode),e=Rt(t.focusNode);return function(t,n,e,o){var r=function(t,n,e,o){var r=Cn(t).dom.createRange();return r.setStart(t.dom,n),r.setEnd(e.dom,o),r}(t,n,e,o),i=Sn(t,e)&&n===o;return r.collapsed&&!i}(n,t.anchorOffset,e,t.focusOffset)?I.some(fs(n,t.anchorOffset,e,t.focusOffset)):Ts(t)},Bs=function(t,n){return e=xs(t,n),o=e.getClientRects(),(r=o.length>0?o[0]:e.getBoundingClientRect()).width>0||r.height>0?I.some(r).map(vs):I.none();var e,o,r},Ms=function(t,n){return{element:t,offset:n}},As=function(t,n){return Nt(t)?Ms(t,n):function(t,n){var e=Mn(t);if(0===e.length)return Ms(t,n);if(n<e.length)return Ms(e[n],0);var o=e[e.length-1],r=Nt(o)?function(t){return Ss.get(t)}(o).length:Mn(o).length;return Ms(o,r)}(t,n)},Ds=function(t,n){return n.getSelection.getOrThunk((function(){return function(){return function(t){return function(t){return I.from(t.getSelection())}(t).filter((function(t){return t.rangeCount>0})).bind(Es)}(t)}}))().map((function(t){var n=As(t.start,t.soffset),e=As(t.finish,t.foffset);return gs.range(n.element,n.offset,e.element,e.offset)}))},Fs=[Jo("getSelection"),Lo("root"),Jo("bubble"),Kc(),or("overrides",{}),or("showAbove",!1),ca("placement",(function(t,n,e){var o=Tn(n.root).dom,r=us(t,0,n),i=Ds(o,n).bind((function(t){var n=function(t,n){return e=xs(t,n),(o=e.getBoundingClientRect()).width>0||o.height>0?I.some(o).map(vs):I.none();var e,o}(o,gs.exactFromRange(t)).orThunk((function(){var n=It("\ufeff");Ce(t.start,n);var e=Bs(o,gs.exact(n,0,n,1));return Me(n),e}));return n.bind((function(t){return as(t.left,t.top,t.width,t.height)}))})),u=Ds(o,n).bind((function(t){return zt(t.start)?I.some(t.start):function(t){return En(t)}(t.start)})),a=u.getOr(t.element);return cs(i,r,n,e,a)}))],Is="link-layout",Rs=function(t){return t.x+t.width},Vs=function(t,n){return t.x-n.width},Ps=function(t,n){return t.y-n.height+t.height},Hs=function(t){return t.y},zs=function(t,n,e){return la(Rs(t),Hs(t),e.southeast(),ma(),"southeast",ka(t,{left:0,top:2}),Is)},Ns=function(t,n,e){return la(Vs(t,n),Hs(t),e.southwest(),ga(),"southwest",ka(t,{right:1,top:2}),Is)},Ls=function(t,n,e){return la(Rs(t),Ps(t,n),e.northeast(),pa(),"northeast",ka(t,{left:0,bottom:3}),Is)},Ws=function(t,n,e){return la(Vs(t,n),Ps(t,n),e.northwest(),ha(),"northwest",ka(t,{right:1,bottom:3}),Is)},Us=function(){return[zs,Ns,Ls,Ws]},js=function(){return[Ns,zs,Ws,Ls]},Gs=[Lo("item"),Kc(),or("overrides",{}),ca("placement",(function(t,n,e){var o=pc(e,n.item.element),r=Jc(t.element,n,Us(),js(),Us(),js(),I.none());return I.some(jc({anchorBox:o,bubble:Uc(),overrides:n.overrides,layouts:r,placer:I.none()}))}))],Xs=Po("type",{selection:Fs,node:ss,hotspot:$c,submenu:Gs,makeshift:Qc}),qs=[Ko("classes",Oo),ar("mode","all",["all","layout","placement"])],Ys=[or("useFixed",S),Jo("getBounds")],Ks=[Wo("anchor",Xs),er("transition",qs)],Js=function(t,n,e,o,r,i,u){return function(t,n,e,o,r,i,u,a){var c=zc(u,"maxHeightFunction",Pc()),s=zc(u,"maxWidthFunction",g),f=t.anchorBox,l=t.origin,d={bounds:hc(l,i),origin:l,preference:o,maxHeightFunction:c,maxWidthFunction:s,lastPlacement:r,transition:a};return Nc(f,n,e,d)}(function(t,n){return function(t,n){return{anchorBox:t,origin:n}}(t,n)}(e.anchorBox,n),r.element,e.bubble,e.layouts,i,o,e.overrides,u)},$s=function(t,n,e,o,r,i){var u=i.map(Ne);return Qs(t,n,e,o,r,u)},Qs=function(t,n,e,o,r,i){var u=Ro("placement.info",vo(Ks),r),a=u.anchor,c=o.element,s=e.get(o.uid);sc((function(){Zn(c,"position","fixed");var r=re(c,"visibility");Zn(c,"visibility","hidden");var f,l=n.useFixed()?(f=document.documentElement,xc(0,0,f.clientWidth,f.clientHeight)):function(t){var n=he(t.element),e=t.element.dom.getBoundingClientRect();return yc(n.left,n.top,e.width,e.height)}(t),d=a.placement,m=i.map(h).or(n.getBounds);d(t,a,l).each((function(n){var r=n.placer.getOr(Js)(t,l,n,m,o,s,u.transition);e.set(o.uid,r)})),r.fold((function(){ae(c,"visibility")}),(function(t){Zn(c,"visibility",t)})),re(c,"left").isNone()&&re(c,"top").isNone()&&re(c,"right").isNone()&&re(c,"bottom").isNone()&&wt(re(c,"position"),"fixed")&&ae(c,"position")}),c)},Zs=Object.freeze({__proto__:null,position:function(t,n,e,o,r){$s(t,n,e,o,r,I.none())},positionWithin:$s,positionWithinBounds:Qs,getMode:function(t,n,e){return n.useFixed()?"fixed":"absolute"},reset:function(t,n,e,o){var r=o.element;j(["position","left","right","top","bottom"],(function(t){return ae(r,t)})),function(t){Jn(t,wc)}(r),e.clear(o.uid)}}),tf=Object.freeze({__proto__:null,init:function(){var t={};return su({readState:function(){return t},clear:function(n){f(n)?delete t[n]:t={}},set:function(n,e){t[n]=e},get:function(n){return bt(t,n)}})}}),nf=Qa({fields:Ys,name:"positioning",active:oc,apis:Zs,state:tf}),ef=function(t){bi(t,si());var n=t.components();j(n,ef)},of=function(t){var n=t.components();j(n,of),bi(t,ci())},rf=function(t,n){Te(t.element,n.element)},uf=function(t,n){var e=t.components();!function(t){j(t.components(),(function(t){return Me(t.element)})),Be(t.element),t.syncComponents()}(t);var o=nt(e,n);j(o,(function(n){ef(n),t.getSystem().removeFromWorld(n)})),j(n,(function(n){n.getSystem().isConnected()?rf(t,n):(t.getSystem().addToWorld(n),rf(t,n),Ln(t.element)&&of(n)),t.syncComponents()}))},af=function(t,n){cf(t,n,Te)},cf=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),Ln(t.element)&&of(n),t.syncComponents()},sf=function(t){ef(t),Me(t.element),t.getSystem().removeFromWorld(t)},ff=function(t){var n=En(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}));sf(t),n.each((function(t){t.syncComponents()}))},lf=function(t){var n=t.components();j(n,sf),Be(t.element),t.syncComponents()},df=function(t,n){mf(t,n,Te)},mf=function(t,n,e){e(t,n.element);var o=Mn(n.element);j(o,(function(t){n.getByDom(t).each(of)}))},gf=function(t){var n=Mn(t.element);j(n,(function(n){t.getByDom(n).each(ef)})),Me(t.element)},pf=function(t,n,e,o){e.get().each((function(n){lf(t)}));var r=n.getAttachPoint(t);af(r,t);var i=t.getSystem().build(o);return af(t,i),e.set(i),i},hf=function(t,n,e,o){var r=pf(t,n,e,o);return n.onOpen(t,r),r},vf=function(t,n,e){e.get().each((function(o){lf(t),ff(t),n.onClose(t,o),e.clear()}))},bf=function(t,n,e){return e.isOpen()},yf=function(t,n,e){var o=n.getAttachPoint(t);Zn(t.element,"position",nf.getMode(o)),function(t,n,e,o){re(t.element,n).fold((function(){Jn(t.element,e)}),(function(n){Gn(t.element,e,n)})),Zn(t.element,n,"hidden")}(t,"visibility",n.cloakVisibilityAttr)},xf=function(t,n,e){(function(t){return N(["top","left","right","bottom"],(function(n){return re(t,n).isSome()}))})(t.element)||ae(t.element,"position"),function(t,n,e){Yn(t.element,e).fold((function(){return ae(t.element,n)}),(function(e){return Zn(t.element,n,e)}))}(t,"visibility",n.cloakVisibilityAttr)},wf=Object.freeze({__proto__:null,cloak:yf,decloak:xf,open:hf,openWhileCloaked:function(t,n,e,o,r){yf(t,n),hf(t,n,e,o),r(),xf(t,n)},close:vf,isOpen:bf,isPartOf:function(t,n,e,o){return bf(0,0,e)&&e.get().exists((function(e){return n.isPartOf(t,e,o)}))},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map((function(){return pf(t,n,e,o)}))}}),Sf=Object.freeze({__proto__:null,events:function(t,n){return Ci([Ti(ni(),(function(e,o){vf(e,t,n)}))])}}),kf=[ra("onOpen"),ra("onClose"),Lo("isPartOf"),Lo("getAttachPoint"),or("cloakVisibilityAttr","data-precloak-visibility")],Cf=Object.freeze({__proto__:null,init:function(){var t=Ec(),n=h("not-implemented");return su({readState:n,isOpen:t.isSet,clear:t.clear,set:t.set,get:t.get})}}),Of=Qa({fields:kf,name:"sandboxing",active:Sf,apis:wf,state:Cf}),_f=h("dismiss.popups"),Tf=h("reposition.popups"),Ef=h("mouse.released"),Bf=ho([or("isExtraPart",S),er("fireEventInstead",[or("event",fi())])]),Mf=function(t){var n,e=Ro("Dismissal",Bf,t);return(n={})[_f()]={schema:ho([Lo("target")]),onReceive:function(t,n){Of.isOpen(t)&&(Of.isPartOf(t,n.target)||e.isExtraPart(t,n.target)||e.fireEventInstead.fold((function(){return Of.close(t)}),(function(n){return bi(t,n.event)})))}},n},Af=ho([er("fireEventInstead",[or("event",li())]),Xo("doReposition")]),Df=function(t){var n,e=Ro("Reposition",Af,t);return(n={})[Tf()]={onReceive:function(t){Of.isOpen(t)&&e.fireEventInstead.fold((function(){return e.doReposition(t)}),(function(n){return bi(t,n.event)}))}},n},Ff=function(t,n,e){n.store.manager.onLoad(t,n,e)},If=function(t,n,e){n.store.manager.onUnload(t,n,e)},Rf=Object.freeze({__proto__:null,onLoad:Ff,onUnload:If,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),Vf=Object.freeze({__proto__:null,events:function(t,n){var e=t.resetOnDom?[Ri((function(e,o){Ff(e,t,n)})),Vi((function(e,o){If(e,t,n)}))]:[qa(t,n,Ff)];return Ci(e)}}),Pf=function(){var t=dr(null);return su({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},Hf=function(){var t=dr({}),n=dr({});return su({readState:function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},lookup:function(e){return bt(t.get(),e).orThunk((function(){return bt(n.get(),e)}))},update:function(e){var o=t.get(),r=n.get(),i={},u={};j(e,(function(t){i[t.value]=t,bt(t,"meta").each((function(n){bt(n,"text").each((function(n){u[n]=t}))}))})),t.set(O(O({},o),i)),n.set(O(O({},r),u))},clear:function(){t.set({}),n.set({})}})},zf=Object.freeze({__proto__:null,memory:Pf,dataset:Hf,manual:function(){return su({readState:g})},init:function(t){return t.store.manager.state(t)}}),Nf=function(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},Lf=[Jo("initialValue"),Lo("getFallbackEntry"),Lo("getDataKey"),Lo("setValue"),ca("manager",{setValue:Nf,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).getOrThunk((function(){return o.getFallbackEntry(r)}))},onLoad:function(t,n,e){n.store.initialValue.each((function(o){Nf(t,n,e,o)}))},onUnload:function(t,n,e){e.clear()},state:Hf})],Wf=[Lo("getValue"),or("setValue",g),Jo("initialValue"),ca("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n,e){return n.store.getValue(t)},onLoad:function(t,n,e){n.store.initialValue.each((function(e){n.store.setValue(t,e)}))},onUnload:g,state:cu.init})],Uf=[Jo("initialValue"),ca("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each((function(t){e.isNotSet()&&e.set(t)}))},onUnload:function(t,n,e){e.clear()},state:Pf})],jf=[rr("store",{mode:"memory"},Po("mode",{memory:Uf,manual:Wf,dataset:Lf})),ra("onSetValue"),or("resetOnDom",!1)],Gf=Qa({fields:jf,name:"representing",active:Vf,apis:Rf,extra:{setValueFrom:function(t,n){var e=Gf.getValue(n);Gf.setValue(t,e)}},state:zf}),Xf=function(t,n){return lr(t,{},U(n,(function(n){return e=n.name(),o="Cannot configure "+n.name()+" for "+t,Ho(e,e,{tag:"option",process:{}},so((function(t){return Je("The field: "+e+" is forbidden. "+o)})));var e,o})).concat([zo("dump",v)]))},qf=function(t){return t.dump},Yf=function(t,n){return O(O({},Ja(n)),t.dump)},Kf=Xf,Jf=Yf,$f="placeholder",Qf=mr([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Zf=function(t){return yt(t,"uiType")},tl=function(t,n,e,o){return function(t,n,e,o){return Zf(e)&&e.uiType===$f?function(t,n,e,o){return t.exists((function(t){return t!==e.owner}))?Qf.single(!0,h(e)):bt(o,e.name).fold((function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+ft(o)+"]\nNamespace: "+t.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))}),(function(t){return t.replace()}))}(t,0,e,o):Qf.single(!1,h(e))}(t,0,e,o).fold((function(r,i){var u=Zf(e)?i(n,e.config,e.validated):i(n),a=bt(u,"components").getOr([]),c=Q(a,(function(e){return tl(t,n,e,o)}));return[O(O({},u),{components:c})]}),(function(t,o){if(Zf(e)){var r=o(n,e.config,e.validated);return e.validated.preprocess.getOr(v)(r)}return o(n)}))},nl=Qf.single,el=Qf.multiple,ol=h($f),rl=mr([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),il=or("factory",{sketch:v}),ul=or("schema",[]),al=Lo("name"),cl=Ho("pname","pname",oo((function(t){return"<alloy."+Xi(t.name)+">"})),So()),sl=zo("schema",(function(){return[Jo("preprocess")]})),fl=or("defaults",h({})),ll=or("overrides",h({})),dl=vo([il,ul,al,cl,fl,ll]),ml=vo([il,ul,al,fl,ll]),gl=vo([il,ul,al,cl,fl,ll]),pl=vo([il,sl,al,Lo("unit"),cl,fl,ll]),hl=function(t){return t.fold(I.some,I.none,I.some,I.some)},vl=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},bl=function(t,n){return function(e){var o=Ro("Converting part type",n,e);return t(o)}},yl=bl(rl.required,dl),xl=bl(rl.external,ml),wl=bl(rl.optional,gl),Sl=bl(rl.group,pl),kl=h("entirety"),Cl=Object.freeze({__proto__:null,required:yl,external:xl,optional:wl,group:Sl,asNamedPart:hl,name:vl,asCommon:function(t){return t.fold(v,v,v,v)},original:kl}),Ol=function(t,n,e,o){return no(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},_l=function(t,n){var e={};return j(n,(function(n){hl(n).each((function(n){var o=Tl(t,n.pname);e[n.name]=function(e){var r=Ro("Part: "+n.name+" in "+t,vo(n.schema),e);return O(O({},o),{config:e,validated:r})}}))})),e},Tl=function(t,n){return{uiType:ol(),owner:t,name:n}},El=function(t,n,e){return{uiType:ol(),owner:t,name:n,config:e,validated:{}}},Bl=function(t){return Q(t,(function(t){return t.fold(I.none,I.some,I.none,I.none).map((function(t){return qo(t.name,t.schema.concat([sa(kl())]))})).toArray()}))},Ml=function(t){return U(t,vl)},Al=function(t,n,e){return function(t,n,e){var o={},r={};return j(e,(function(t){t.fold((function(t){o[t.pname]=nl(!0,(function(n,e,o){return t.factory.sketch(Ol(n,t,e,o))}))}),(function(t){var e=n.parts[t.name];r[t.name]=h(t.factory.sketch(Ol(n,t,e[kl()]),e))}),(function(t){o[t.pname]=nl(!1,(function(n,e,o){return t.factory.sketch(Ol(n,t,e,o))}))}),(function(t){o[t.pname]=el(!0,(function(n,e,o){var r=n[t.name];return U(r,(function(e){return t.factory.sketch(no(t.defaults(n,e,o),e,t.overrides(n,e)))}))}))}))})),{internals:h(o),externals:h(r)}}(0,n,e)},Dl=function(t,n,e){return function(t,n,e,o){var r=mt(o,(function(t,n){return o=t,r=!1,{name:h(e=n),required:function(){return o.fold((function(t,n){return t}),(function(t,n){return t}))},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+e);return r=!0,o}};var e,o,r})),i=function(t,n,e,o){return Q(e,(function(e){return tl(t,n,e,o)}))}(t,n,e,r);return dt(r,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))})),i}(I.some(t),n,n.components,e)},Fl=function(t,n,e){var o=n.partUids[e];return t.getSystem().getByUid(o).toOptional()},Il=function(t,n,e){return Fl(t,n,e).getOrDie("Could not find part: "+e)},Rl=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return j(e,(function(t){o[t]=h(i.getByUid(r[t]))})),o},Vl=function(t,n){var e=t.getSystem();return mt(n.partUids,(function(t,n){return h(e.getByUid(t))}))},Pl=function(t){return ft(t.partUids)},Hl=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return j(e,(function(t){o[t]=h(i.getByUid(r[t]).getOrDie())})),o},zl=function(t,n){var e=Ml(n);return vr(U(e,(function(n){return{key:n,value:t+"-"+n}})))},Nl=function(t){return Ho("partUids","partUids",io((function(n){return zl(n.uid,t)})),So())},Ll=Object.freeze({__proto__:null,generate:_l,generateOne:El,schemas:Bl,names:Ml,substitutes:Al,components:Dl,defaultUids:zl,defaultUidsSchema:Nl,getAllParts:Vl,getAllPartNames:Pl,getPart:Fl,getPartOrDie:Il,getParts:Rl,getPartsOrDie:Hl}),Wl=function(t,n,e,o,r){var i=function(t,n){return(t.length>0?[qo("parts",t)]:[]).concat([Lo("uid"),or("dom",{}),or("components",[]),sa("originalSpec"),or("debug.sketcher",{})]).concat(n)}(o,r);return Ro(t+" [SpecSchema]",ho(i.concat(n)),e)},Ul=function(t,n,e,o,r){var i=jl(r),u=Bl(e),a=Nl(e),c=Wl(t,n,i,u,[a]),s=Al(0,c,e);return o(c,Dl(t,c,s.internals()),i,s.externals())},jl=function(t){return function(t){return yt(t,"uid")}(t)?t:O(O({},t),{uid:Zi("uid")})},Gl=ho([Lo("name"),Lo("factory"),Lo("configFields"),or("apis",{}),or("extraApis",{})]),Xl=ho([Lo("name"),Lo("factory"),Lo("configFields"),Lo("partFields"),or("apis",{}),or("extraApis",{})]),ql=function(t){var n=Ro("Sketcher for "+t.name,Gl,t),e=mt(n.apis,au),o=mt(n.extraApis,(function(t,n){return ru(t,n)}));return O(O({name:n.name,configFields:n.configFields,sketch:function(t){return function(t,n,e,o){var r=jl(o);return e(Wl(t,n,r,[],[]),r)}(n.name,n.configFields,n.factory,t)}},e),o)},Yl=function(t){var n=Ro("Sketcher for "+t.name,Xl,t),e=_l(n.name,n.partFields),o=mt(n.apis,au),r=mt(n.extraApis,(function(t,n){return ru(t,n)}));return O(O({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return Ul(n.name,n.configFields,n.partFields,n.factory,t)},parts:e},o),r)},Kl=function(t){return"input"===Pt(t)&&"radio"!==qn(t,"type")||"textarea"===Pt(t)},Jl=Object.freeze({__proto__:null,getCurrent:function(t,n,e){return n.find(t)}}),$l=[Lo("find")],Ql=Qa({fields:$l,name:"composing",apis:Jl}),Zl=["input","button","textarea","select"],td=function(t,n,e){(n.disabled()?ud:ad)(t,n)},nd=function(t,n){return!0===n.useNative&&z(Zl,Pt(t.element))},ed=function(t){Gn(t.element,"disabled","disabled")},od=function(t){Jn(t.element,"disabled")},rd=function(t){Gn(t.element,"aria-disabled","true")},id=function(t){Gn(t.element,"aria-disabled","false")},ud=function(t,n,e){n.disableClass.each((function(n){wu(t.element,n)})),(nd(t,n)?ed:rd)(t),n.onDisabled(t)},ad=function(t,n,e){n.disableClass.each((function(n){Su(t.element,n)})),(nd(t,n)?od:id)(t),n.onEnabled(t)},cd=function(t,n){return nd(t,n)?function(t){return Kn(t.element,"disabled")}(t):function(t){return"true"===qn(t.element,"aria-disabled")}(t)},sd=Object.freeze({__proto__:null,enable:ad,disable:ud,isDisabled:cd,onLoad:td,set:function(t,n,e,o){(o?ud:ad)(t,n)}}),fd=Object.freeze({__proto__:null,exhibit:function(t,n){return lu({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(t,n){return Ci([Oi($r(),(function(n,e){return cd(n,t)})),qa(t,n,td)])}}),ld=[sr("disabled",S),or("useNative",!0),Jo("disableClass"),ra("onDisabled"),ra("onEnabled")],dd=Qa({fields:ld,name:"disabling",active:fd,apis:sd}),md=function(t,n,e,o){var r=_s(t.element,"."+n.highlightClass);j(r,(function(e){N(o,(function(t){return t.element===e}))||(Su(e,n.highlightClass),t.getSystem().getByDom(e).each((function(e){n.onDehighlight(t,e),bi(e,vi())})))}))},gd=function(t,n,e,o){md(t,n,0,[o]),pd(t,n,e,o)||(wu(o.element,n.highlightClass),n.onHighlight(t,o),bi(o,hi()))},pd=function(t,n,e,o){return ku(o.element,n.highlightClass)},hd=function(t,n,e){return Uu(t.element,"."+n.itemClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},vd=function(t,n,e){var o=_s(t.element,"."+n.itemClass);return(o.length>0?I.some(o[o.length-1]):I.none()).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},bd=function(t,n,e,o){var r=_s(t.element,"."+n.itemClass);return J(r,(function(t){return ku(t,n.highlightClass)})).bind((function(n){var e=wa(n,o,0,r.length-1);return t.getSystem().getByDom(r[e]).toOptional()}))},yd=function(t,n,e){var o=_s(t.element,"."+n.itemClass);return St(U(o,(function(n){return t.getSystem().getByDom(n).toOptional()})))},xd=Object.freeze({__proto__:null,dehighlightAll:function(t,n,e){return md(t,n,0,[])},dehighlight:function(t,n,e,o){pd(t,n,e,o)&&(Su(o.element,n.highlightClass),n.onDehighlight(t,o),bi(o,vi()))},highlight:gd,highlightFirst:function(t,n,e){hd(t,n).each((function(o){gd(t,n,e,o)}))},highlightLast:function(t,n,e){vd(t,n).each((function(o){gd(t,n,e,o)}))},highlightAt:function(t,n,e,o){(function(t,n,e,o){var r=_s(t.element,"."+n.itemClass);return I.from(r[o]).fold((function(){return Ge.error(new Error("No element found with index "+o))}),t.getSystem().getByDom)})(t,n,0,o).fold((function(t){throw t}),(function(o){gd(t,n,e,o)}))},highlightBy:function(t,n,e,o){var r=yd(t,n);K(r,o).each((function(o){gd(t,n,e,o)}))},isHighlighted:pd,getHighlighted:function(t,n,e){return Uu(t.element,"."+n.highlightClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},getFirst:hd,getLast:vd,getPrevious:function(t,n,e){return bd(t,n,0,-1)},getNext:function(t,n,e){return bd(t,n,0,1)},getCandidates:yd}),wd=[Lo("highlightClass"),Lo("itemClass"),ra("onHighlight"),ra("onDehighlight")],Sd=Qa({fields:wd,name:"highlighting",apis:xd}),kd=[8],Cd=[9],Od=[13],_d=[27],Td=[32],Ed=[37],Bd=[38],Md=[39],Ad=[40],Dd=function(t,n,e){var o=tt(t.slice(0,n)),r=tt(t.slice(n+1));return K(o.concat(r),e)},Fd=function(t,n,e){var o=tt(t.slice(0,n));return K(o,e)},Id=function(t,n,e){var o=t.slice(0,n),r=t.slice(n+1);return K(r.concat(o),e)},Rd=function(t,n,e){var o=t.slice(n+1);return K(o,e)},Vd=function(t){return function(n){var e=n.raw;return z(t,e.which)}},Pd=function(t){return function(n){return Z(t,(function(t){return t(n)}))}},Hd=function(t){return!0===t.raw.shiftKey},zd=function(t){return!0===t.raw.ctrlKey},Nd=x(Hd),Ld=function(t,n){return{matches:t,classification:n}},Wd=function(t,n,e){n.exists((function(t){return e.exists((function(n){return Sn(n,t)}))}))||yi(t,di(),{prevFocus:n,newFocus:e})},Ud=function(){var t=function(t){return cc(t.element)};return{get:t,set:function(n,e){var o=t(n);n.getSystem().triggerFocus(e,n.element);var r=t(n);Wd(n,o,r)}}},jd=function(){var t=function(t){return Sd.getHighlighted(t).map((function(t){return t.element}))};return{get:t,set:function(n,e){var o=t(n);n.getSystem().getByDom(e).fold(g,(function(t){Sd.highlight(n,t)}));var r=t(n);Wd(n,o,r)}}};!function(t){t.OnFocusMode="onFocus",t.OnEnterOrSpaceMode="onEnterOrSpace",t.OnApiMode="onApi"}(ws||(ws={}));var Gd=function(t,n,e,o,r){var i=function(t,n,e,o,r){var i,u,a;return(i=e(t,n,o,r),u=n.event,a=K(i,(function(t){return t.matches(u)})),a.map((function(t){return t.classification}))).bind((function(e){return e(t,n,o,r)}))},u={schema:function(){return t.concat([or("focusManager",Ud()),rr("focusInside","onFocus",Ao((function(t){return z(["onFocus","onEnterOrSpace","onApi"],t)?Ge.value(t):Ge.error("Invalid value for focusInside")}))),ca("handler",u),ca("state",n),ca("sendFocusIn",r)])},processKey:i,toEvents:function(t,n){var u=t.focusInside!==ws.OnFocusMode?I.none():r(t).map((function(e){return Ti(qr(),(function(o,r){e(o,t,n),r.stop()}))})),a=[Ti(Vr(),(function(o,u){i(o,u,e,t,n).fold((function(){!function(e,o){var i=Vd(Td.concat(Od))(o.event);t.focusInside===ws.OnEnterOrSpaceMode&&i&&wr(e,o)&&r(t).each((function(r){r(e,t,n),o.stop()}))}(o,u)}),(function(t){u.stop()}))})),Ti(Pr(),(function(e,r){i(e,r,o,t,n).each((function(t){r.stop()}))}))];return Ci(u.toArray().concat(a))}};return u},Xd=function(t){var n=[Jo("onEscape"),Jo("onEnter"),or("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),or("firstTabstop",0),or("useTabstopAt",k),Jo("visibilitySelector")].concat([t]),e=function(t,n){var e=t.visibilitySelector.bind((function(t){return ju(n,t)})).getOr(n);return le(e)>0},o=function(t,n,o){(function(t,n){var o=_s(t.element,n.selector),r=X(o,(function(t){return e(n,t)}));return I.from(r[n.firstTabstop])})(t,n).each((function(e){n.focusManager.set(t,e)}))},r=function(t,n,o,r){var i=_s(t.element,o.selector);return function(t,n){return n.focusManager.get(t).bind((function(t){return ju(t,n.selector)}))}(t,o).bind((function(n){return J(i,y(Sn,n)).bind((function(n){return function(t,n,o,r,i){return i(n,o,(function(t){return function(t,n){return e(t,n)&&t.useTabstopAt(n)}(r,t)})).fold((function(){return r.cyclic?I.some(!0):I.none()}),(function(n){return r.focusManager.set(t,n),I.some(!0)}))}(t,i,n,o,r)}))}))},i=h([Ld(Pd([Hd,Vd(Cd)]),(function(t,n,e){var o=e.cyclic?Dd:Fd;return r(t,0,e,o)})),Ld(Vd(Cd),(function(t,n,e){var o=e.cyclic?Id:Rd;return r(t,0,e,o)})),Ld(Vd(_d),(function(t,n,e){return e.onEscape.bind((function(e){return e(t,n)}))})),Ld(Pd([Nd,Vd(Od)]),(function(t,n,e){return e.onEnter.bind((function(e){return e(t,n)}))}))]),u=h([]);return Gd(n,cu.init,i,u,(function(){return I.some(o)}))},qd=Xd(zo("cyclic",S)),Yd=Xd(zo("cyclic",k)),Kd=function(t,n,e){return Kl(e)&&Vd(Td)(n.event)?I.none():function(t,n,e){return wi(t,e,$r()),I.some(!0)}(t,0,e)},Jd=function(t,n){return I.some(!0)},$d=[or("execute",Kd),or("useSpace",!1),or("useEnter",!0),or("useControlEnter",!1),or("useDown",!1)],Qd=function(t,n,e){return e.execute(t,n,t.element)},Zd=Gd($d,cu.init,(function(t,n,e,o){var r=e.useSpace&&!Kl(t.element)?Td:[],i=e.useEnter?Od:[],u=e.useDown?Ad:[],a=r.concat(i).concat(u);return[Ld(Vd(a),Qd)].concat(e.useControlEnter?[Ld(Pd([zd,Vd(Od)]),Qd)]:[])}),(function(t,n,e,o){return e.useSpace&&!Kl(t.element)?[Ld(Vd(Td),Jd)]:[]}),(function(){return I.none()})),tm=function(){var t=Ec();return su({readState:function(){return t.get().map((function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set({numRows:n,numColumns:e})},getNumRows:function(){return t.get().map((function(t){return t.numRows}))},getNumColumns:function(){return t.get().map((function(t){return t.numColumns}))}})},nm=Object.freeze({__proto__:null,flatgrid:tm,init:function(t){return t.state(t)}}),em=function(t){return function(n,e,o,r){var i=t(n.element);return um(i,n,e,o,r)}},om=function(t,n){var e=Gc(t,n);return em(e)},rm=function(t,n){var e=Gc(n,t);return em(e)},im=function(t){return function(n,e,o,r){return um(t,n,e,o,r)}},um=function(t,n,e,o,r){return o.focusManager.get(n).bind((function(e){return t(n.element,e,o,r)})).map((function(t){return o.focusManager.set(n,t),!0}))},am=im,cm=im,sm=im,fm=function(t){return!function(t){return t.offsetWidth<=0&&t.offsetHeight<=0}(t.dom)},lm=function(t,n,e){var o=_s(t,e);return function(t,e){return J(t,(function(t){return Sn(t,n)})).map((function(n){return{index:n,candidates:t}}))}(X(o,fm))},dm=function(t,n){return J(t,(function(t){return Sn(n,t)}))},mm=function(t,n,e,o){return o(Math.floor(n/e),n%e).bind((function(n){var o=n.row*e+n.column;return o>=0&&o<t.length?I.some(t[o]):I.none()}))},gm=function(t,n,e,o,r){return mm(t,n,o,(function(n,i){var u=n===e-1?t.length-n*o:o,a=wa(i,r,0,u-1);return I.some({row:n,column:a})}))},pm=function(t,n,e,o,r){return mm(t,n,o,(function(n,i){var u=wa(n,r,0,e-1),a=u===e-1?t.length-u*o:o,c=Sa(i,0,a-1);return I.some({row:u,column:c})}))},hm=[Lo("selector"),or("execute",Kd),ia("onEscape"),or("captureTab",!1),fa()],vm=function(t,n,e){Uu(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},bm=function(t){return function(n,e,o,r){return lm(n,e,o.selector).bind((function(n){return t(n.candidates,n.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}},ym=function(t,n,e){return e.captureTab?I.some(!0):I.none()},xm=bm((function(t,n,e,o){return gm(t,n,e,o,-1)})),wm=bm((function(t,n,e,o){return gm(t,n,e,o,1)})),Sm=bm((function(t,n,e,o){return pm(t,n,e,o,-1)})),km=bm((function(t,n,e,o){return pm(t,n,e,o,1)})),Cm=h([Ld(Vd(Ed),om(xm,wm)),Ld(Vd(Md),rm(xm,wm)),Ld(Vd(Bd),am(Sm)),Ld(Vd(Ad),cm(km)),Ld(Pd([Hd,Vd(Cd)]),ym),Ld(Pd([Nd,Vd(Cd)]),ym),Ld(Vd(_d),(function(t,n,e){return e.onEscape(t,n)})),Ld(Vd(Td.concat(Od)),(function(t,n,e,o){return function(t,n){return n.focusManager.get(t).bind((function(t){return ju(t,n.selector)}))}(t,e).bind((function(o){return e.execute(t,n,o)}))}))]),Om=h([Ld(Vd(Td),Jd)]),_m=Gd(hm,tm,Cm,Om,(function(){return I.some(vm)})),Tm=function(t,n,e,o){var r=function(t,n,e){var i,u=wa(n,o,0,e.length-1);return u===t?I.none():(i=e[u],"button"===Pt(i)&&"disabled"===qn(i,"disabled")?r(t,u,e):I.from(e[u]))};return lm(t,e,n).bind((function(t){var n=t.index,e=t.candidates;return r(n,n,e)}))},Em=[Lo("selector"),or("getInitial",I.none),or("execute",Kd),ia("onEscape"),or("executeOnMove",!1),or("allowVertical",!0)],Bm=function(t,n,e){return function(t,n){return n.focusManager.get(t).bind((function(t){return ju(t,n.selector)}))}(t,e).bind((function(o){return e.execute(t,n,o)}))},Mm=function(t,n,e){n.getInitial(t).orThunk((function(){return Uu(t.element,n.selector)})).each((function(e){n.focusManager.set(t,e)}))},Am=function(t,n,e){return Tm(t,e.selector,n,-1)},Dm=function(t,n,e){return Tm(t,e.selector,n,1)},Fm=function(t){return function(n,e,o,r){return t(n,e,o,r).bind((function(){return o.executeOnMove?Bm(n,e,o):I.some(!0)}))}},Im=function(t,n,e){return e.onEscape(t,n)},Rm=h([Ld(Vd(Td),Jd)]),Vm=Gd(Em,cu.init,(function(t,n,e,o){var r=Ed.concat(e.allowVertical?Bd:[]),i=Md.concat(e.allowVertical?Ad:[]);return[Ld(Vd(r),Fm(om(Am,Dm))),Ld(Vd(i),Fm(rm(Am,Dm))),Ld(Vd(Od),Bm),Ld(Vd(Td),Bm),Ld(Vd(_d),Im)]}),Rm,(function(){return I.some(Mm)})),Pm=function(t,n,e){return I.from(t[n]).bind((function(t){return I.from(t[e]).map((function(t){return{rowIndex:n,columnIndex:e,cell:t}}))}))},Hm=function(t,n,e,o){var r=t[n].length,i=wa(e,o,0,r-1);return Pm(t,n,i)},zm=function(t,n,e,o){var r=wa(e,o,0,t.length-1),i=t[r].length,u=Sa(n,0,i-1);return Pm(t,r,u)},Nm=function(t,n,e,o){var r=t[n].length,i=Sa(e+o,0,r-1);return Pm(t,n,i)},Lm=function(t,n,e,o){var r=Sa(e+o,0,t.length-1),i=t[r].length,u=Sa(n,0,i-1);return Pm(t,r,u)},Wm=[qo("selectors",[Lo("row"),Lo("cell")]),or("cycles",!0),or("previousSelector",I.none),or("execute",Kd)],Um=function(t,n,e){n.previousSelector(t).orThunk((function(){var e=n.selectors;return Uu(t.element,e.cell)})).each((function(e){n.focusManager.set(t,e)}))},jm=function(t,n){return function(e,o,r){var i=r.cycles?t:n;return ju(o,r.selectors.row).bind((function(t){var n=_s(t,r.selectors.cell);return dm(n,o).bind((function(n){var o=_s(e,r.selectors.row);return dm(o,t).bind((function(t){var e=function(t,n){return U(t,(function(t){return _s(t,n.selectors.cell)}))}(o,r);return i(e,t,n).map((function(t){return t.cell}))}))}))}))}},Gm=jm((function(t,n,e){return Hm(t,n,e,-1)}),(function(t,n,e){return Nm(t,n,e,-1)})),Xm=jm((function(t,n,e){return Hm(t,n,e,1)}),(function(t,n,e){return Nm(t,n,e,1)})),qm=jm((function(t,n,e){return zm(t,e,n,-1)}),(function(t,n,e){return Lm(t,e,n,-1)})),Ym=jm((function(t,n,e){return zm(t,e,n,1)}),(function(t,n,e){return Lm(t,e,n,1)})),Km=h([Ld(Vd(Ed),om(Gm,Xm)),Ld(Vd(Md),rm(Gm,Xm)),Ld(Vd(Bd),am(qm)),Ld(Vd(Ad),cm(Ym)),Ld(Vd(Td.concat(Od)),(function(t,n,e){return cc(t.element).bind((function(o){return e.execute(t,n,o)}))}))]),Jm=h([Ld(Vd(Td),Jd)]),$m=Gd(Wm,cu.init,Km,Jm,(function(){return I.some(Um)})),Qm=[Lo("selector"),or("execute",Kd),or("moveOnTab",!1)],Zm=function(t,n,e){return e.focusManager.get(t).bind((function(o){return e.execute(t,n,o)}))},tg=function(t,n,e){Uu(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},ng=function(t,n,e){return Tm(t,e.selector,n,-1)},eg=function(t,n,e){return Tm(t,e.selector,n,1)},og=h([Ld(Vd(Bd),sm(ng)),Ld(Vd(Ad),sm(eg)),Ld(Pd([Hd,Vd(Cd)]),(function(t,n,e,o){return e.moveOnTab?sm(ng)(t,n,e,o):I.none()})),Ld(Pd([Nd,Vd(Cd)]),(function(t,n,e,o){return e.moveOnTab?sm(eg)(t,n,e,o):I.none()})),Ld(Vd(Od),Zm),Ld(Vd(Td),Zm)]),rg=h([Ld(Vd(Td),Jd)]),ig=Gd(Qm,cu.init,og,rg,(function(){return I.some(tg)})),ug=[ia("onSpace"),ia("onEnter"),ia("onShiftEnter"),ia("onLeft"),ia("onRight"),ia("onTab"),ia("onShiftTab"),ia("onUp"),ia("onDown"),ia("onEscape"),or("stopSpaceKeyup",!1),Jo("focusIn")],ag=Gd(ug,cu.init,(function(t,n,e){return[Ld(Vd(Td),e.onSpace),Ld(Pd([Nd,Vd(Od)]),e.onEnter),Ld(Pd([Hd,Vd(Od)]),e.onShiftEnter),Ld(Pd([Hd,Vd(Cd)]),e.onShiftTab),Ld(Pd([Nd,Vd(Cd)]),e.onTab),Ld(Vd(Bd),e.onUp),Ld(Vd(Ad),e.onDown),Ld(Vd(Ed),e.onLeft),Ld(Vd(Md),e.onRight),Ld(Vd(Td),e.onSpace),Ld(Vd(_d),e.onEscape)]}),(function(t,n,e){return e.stopSpaceKeyup?[Ld(Vd(Td),Jd)]:[]}),(function(t){return t.focusIn})),cg=qd.schema(),sg=Yd.schema(),fg=Vm.schema(),lg=_m.schema(),dg=$m.schema(),mg=Zd.schema(),gg=ig.schema(),pg=ag.schema(),hg=tc({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:cg,cyclic:sg,flow:fg,flatgrid:lg,matrix:dg,execution:mg,menu:gg,special:pg}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold((function(){t.getSystem().triggerFocus(t.element,t.element)}),(function(o){o(t,n,e)}))},setGridSize:function(t,n,e,o,r){!function(t){return xt(t,"setGridSize")}(e)?console.error("Layout does not support setGridSize"):e.setGridSize(o,r)}},state:nm}),vg=function(t,n,e,o){var r=t.getSystem().build(o);cf(t,r,e)},bg=function(t,n,e,o){var r=yg(t),i=K(r,(function(t){return Sn(o.element,t.element)}));i.each(ff)},yg=function(t,n){return t.components()},xg=function(t,n,e,o,r){var i=yg(t);return I.from(i[o]).map((function(n){return bg(t,0,0,n),r.each((function(n){vg(t,0,(function(t,n){!function(t,n,e){An(t,e).fold((function(){Te(t,n)}),(function(t){Ce(t,n)}))}(t,n,o)}),n)})),n}))},wg=Object.freeze({__proto__:null,append:function(t,n,e,o){vg(t,0,Te,o)},prepend:function(t,n,e,o){vg(t,0,_e,o)},remove:bg,replaceAt:xg,replaceBy:function(t,n,e,o,r){var i=yg(t);return J(i,o).bind((function(n){return xg(t,0,0,n,r)}))},set:function(t,n,e,o){sc((function(){var n=U(o,t.getSystem().build);uf(t,n)}),t.element)},contents:yg}),Sg=Qa({fields:[],name:"replacing",apis:wg}),kg=function(t,n){var e=function(t,n){var e=Ci(n);return Qa({fields:[Lo("enabled")],name:t,active:{events:h(e)}})}(t,n);return{key:t,value:{config:{},me:e,configAsRaw:h({}),initialConfig:{},state:cu}}},Cg=function(t,n){n.ignore||(ic(t.element),n.onFocus(t))},Og=Object.freeze({__proto__:null,focus:Cg,blur:function(t,n){n.ignore||function(t){t.dom.blur()}(t.element)},isFocused:function(t){return uc(t.element)}}),_g=Object.freeze({__proto__:null,exhibit:function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}};return lu(e)},events:function(t){return Ci([Ti(qr(),(function(n,e){Cg(n,t),e.stop()}))].concat(t.stopMousedown?[Ti(Br(),(function(t,n){n.event.prevent()}))]:[]))}}),Tg=[ra("onFocus"),or("stopMousedown",!1),or("ignore",!1)],Eg=Qa({fields:Tg,name:"focusing",active:_g,apis:Og}),Bg=function(t,n,e){var o=n.aria;o.update(t,o,e.get())},Mg=function(t,n,e){n.toggleClass.each((function(n){e.get()?wu(t.element,n):Su(t.element,n)}))},Ag=function(t,n,e){Ig(t,n,e,!e.get())},Dg=function(t,n,e){e.set(!0),Mg(t,n,e),Bg(t,n,e)},Fg=function(t,n,e){e.set(!1),Mg(t,n,e),Bg(t,n,e)},Ig=function(t,n,e,o){(o?Dg:Fg)(t,n,e)},Rg=function(t,n,e){Ig(t,n,e,n.selected)},Vg=Object.freeze({__proto__:null,onLoad:Rg,toggle:Ag,isOn:function(t,n,e){return e.get()},on:Dg,off:Fg,set:Ig}),Pg=Object.freeze({__proto__:null,exhibit:function(){return lu({})},events:function(t,n){var e,o,r,i=(e=t,o=n,r=Ag,Hi((function(t){r(t,e,o)}))),u=qa(t,n,Rg);return Ci($([t.toggleOnExecute?[i]:[],[u]]))}}),Hg=function(t,n,e){Gn(t.element,"aria-expanded",e)},zg=[or("selected",!1),Jo("toggleClass"),or("toggleOnExecute",!0),rr("aria",{mode:"none"},Po("mode",{pressed:[or("syncWithExpanded",!1),ca("update",(function(t,n,e){Gn(t.element,"aria-pressed",e),n.syncWithExpanded&&Hg(t,0,e)}))],checked:[ca("update",(function(t,n,e){Gn(t.element,"aria-checked",e)}))],expanded:[ca("update",Hg)],selected:[ca("update",(function(t,n,e){Gn(t.element,"aria-selected",e)}))],none:[ca("update",g)]}))],Ng=Qa({fields:zg,name:"toggling",active:Pg,apis:Vg,state:(!1,{init:function(){var t=dr(false);return{get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(false)},readState:function(){return t.get()}}}})}),Lg=function(){var t=function(t,n){n.stop(),xi(t)};return[Ti(Nr(),t),Ti(Zr(),t),Di(Or()),Di(Br())]},Wg=function(t){return Ci($([t.map((function(t){return Hi((function(n,e){t(n),e.stop()}))})).toArray(),Lg()]))},Ug="alloy.item-hover",jg="alloy.item-focus",Gg=function(t){(cc(t.element).isNone()||Eg.isFocused(t))&&(Eg.isFocused(t)||Eg.focus(t),yi(t,Ug,{item:t}))},Xg=function(t){yi(t,jg,{item:t})},qg=h(Ug),Yg=h(jg),Kg=[Lo("data"),Lo("components"),Lo("dom"),or("hasSubmenu",!1),Jo("toggling"),Kf("itemBehaviours",[Ng,Eg,hg,Gf]),or("ignoreFocus",!1),or("domModification",{}),ca("builder",(function(t){return{dom:t.dom,domModification:O(O({},t.domModification),{attributes:O(O(O({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Jf(t.itemBehaviours,[t.toggling.fold(Ng.revoke,(function(t){return Ng.config(O({aria:{mode:"checked"}},t))})),Eg.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Xg(t)}}),hg.config({mode:"execution"}),Gf.config({store:{mode:"memory",initialValue:t.data}}),kg("item-type-events",T(T([],Lg(),!0),[Ti(Fr(),Gg),Ti(Qr(),Eg.focus)],!1))]),components:t.components,eventOrder:t.eventOrder}})),or("eventOrder",{})],Jg=[Lo("dom"),Lo("components"),ca("builder",(function(t){return{dom:t.dom,components:t.components,events:Ci([Fi(Qr())])}}))],$g=h("item-widget"),Qg=h([yl({name:"widget",overrides:function(t){return{behaviours:Ja([Gf.config({store:{mode:"manual",getValue:function(n){return t.data},setValue:g}})])}}})]),Zg=[Lo("uid"),Lo("data"),Lo("components"),Lo("dom"),or("autofocus",!1),or("ignoreFocus",!1),Kf("widgetBehaviours",[Gf,Eg,hg]),or("domModification",{}),Nl(Qg()),ca("builder",(function(t){var n=Al($g(),t,Qg()),e=Dl($g(),t,n.internals()),o=function(n){return Fl(n,t,"widget").map((function(t){return hg.focusIn(t),t}))},r=function(n,e){return Kl(e.event.target)?I.none():t.autofocus?(e.setSource(n.element),I.none()):I.none()};return{dom:t.dom,components:e,domModification:t.domModification,events:Ci([Hi((function(t,n){o(t).each((function(t){n.stop()}))})),Ti(Fr(),Gg),Ti(Qr(),(function(n,e){t.autofocus?o(n):Eg.focus(n)}))]),behaviours:Jf(t.widgetBehaviours,[Gf.config({store:{mode:"memory",initialValue:t.data}}),Eg.config({ignore:t.ignoreFocus,onFocus:function(t){Xg(t)}}),hg.config({mode:"special",focusIn:t.autofocus?function(t){o(t)}:nc(),onLeft:r,onRight:r,onEscape:function(n,e){return Eg.isFocused(n)||t.autofocus?t.autofocus?(e.setSource(n.element),I.none()):I.none():(Eg.focus(n),I.some(!0))}})])}}))],tp=Po("type",{widget:Zg,item:Kg,separator:Jg}),np=h([Sl({factory:{sketch:function(t){var n=Ro("menu.spec item",tp,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return yt(n,"uid")?n:O(O({},n),{uid:Zi("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),ep=h([Lo("value"),Lo("items"),Lo("dom"),Lo("components"),or("eventOrder",{}),Xf("menuBehaviours",[Sd,Gf,Ql,hg]),rr("movement",{mode:"menu",moveOnTab:!0},Po("mode",{grid:[fa(),ca("config",(function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}}))],matrix:[ca("config",(function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}})),Lo("rowSelector")],menu:[or("moveOnTab",!0),ca("config",(function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}}))]})),Wo("markers",Zu()),or("fakeFocus",!1),or("focusManager",Ud()),ra("onHighlight")]),op=h("alloy.menu-focus"),rp=Yl({name:"Menu",configFields:ep(),partFields:np(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Yf(t.menuBehaviours,[Sd.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),Gf.config({store:{mode:"memory",initialValue:t.value}}),Ql.config({find:I.some}),hg.config(t.movement.config(t,t.movement))]),events:Ci([Ti(Yg(),(function(t,n){var e=n.event;t.getSystem().getByDom(e.target).each((function(e){Sd.highlight(t,e),n.stop(),yi(t,op(),{menu:t,item:e})}))})),Ti(qg(),(function(t,n){var e=n.event.item;Sd.highlight(t,e)}))]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),ip=function(t,n,e,o){return bt(e,o).bind((function(o){return bt(t,o).bind((function(o){var r=ip(t,n,e,o);return I.some([o].concat(r))}))})).getOr([])},up=function(t){return"prepared"===t.type?I.some(t.menu):I.none()},ap=function(){var t=dr({}),n=dr({}),e=dr({}),o=Ec(),r=dr({}),i=function(t){return u(t).bind(up)},u=function(t){return bt(n.get(),t)},a=function(n){return bt(t.get(),n)};return{setMenuBuilt:function(t,e){var o;n.set(O(O({},n.get()),((o={})[t]={type:"prepared",menu:e},o)))},setContents:function(i,u,a,c){o.set(i),t.set(a),n.set(u),r.set(c);var s=function(t,n){var e={};dt(t,(function(t,n){j(t,(function(t){e[t]=n}))}));var o=n,r=gt(n,(function(t,n){return{k:t,v:n}})),i=mt(r,(function(t,n){return[n].concat(ip(e,o,r,n))}));return mt(e,(function(t){return bt(i,t).getOr([t])}))}(c,a);e.set(s)},expand:function(n){return bt(t.get(),n).map((function(t){var o=bt(e.get(),n).getOr([]);return[t].concat(o)}))},refresh:function(t){return bt(e.get(),t)},collapse:function(t){return bt(e.get(),t).bind((function(t){return t.length>1?I.some(t.slice(1)):I.none()}))},lookupMenu:u,lookupItem:a,otherMenus:function(t){var n=r.get();return nt(ft(n),t)},getPrimary:function(){return o.get().bind(i)},getMenus:function(){return n.get()},clear:function(){t.set({}),n.set({}),e.set({}),o.clear()},isClear:function(){return o.get().isNone()},getTriggeringPath:function(n,r){var u=X(a(n).toArray(),(function(t){return i(t).isSome()}));return bt(e.get(),n).bind((function(n){var e=tt(u.concat(n));return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return I.none();n.push(o.getOrDie())}return I.some(n)}(Q(e,(function(n,u){return function(n,e,o){return i(n).bind((function(r){return function(n){return ht(t.get(),(function(t,e){return t===n}))}(n).bind((function(t){return e(t).map((function(t){return{triggeredMenu:r,triggeringItem:t,triggeringPath:o}}))}))}))}(n,r,e.slice(0,u+1)).fold((function(){return wt(o.get(),n)?[]:[I.none()]}),(function(t){return[I.some(t)]}))})))}))}}},cp=up,sp=h("collapse-item"),fp=ql({name:"TieredMenu",configFields:[aa("onExecute"),aa("onEscape"),ua("onOpenMenu"),ua("onOpenSubmenu"),ra("onRepositionMenu"),ra("onCollapseMenu"),or("highlightImmediately",!0),qo("data",[Lo("primary"),Lo("menus"),Lo("expansions")]),or("fakeFocus",!1),ra("onHighlight"),ra("onHover"),na(),Lo("dom"),or("navigateOnHover",!0),or("stayInDom",!1),Xf("tmenuBehaviours",[hg,Sd,Ql,Sg]),or("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(t,n){var e,o=Ec(),r=ap(),i=function(t){return Gf.getValue(t).value},u=function(n){return mt(t.data.menus,(function(t,n){return Q(t.items,(function(t){return"separator"===t.type?[]:[t.data.value]}))}))},a=function(t,n){Sd.highlight(t,n),Sd.getHighlighted(n).orThunk((function(){return Sd.getFirst(n)})).each((function(n){wi(t,n.element,Qr())}))},c=function(t,n){return St(U(n,(function(n){return t.lookupMenu(n).bind((function(t){return"prepared"===t.type?I.some(t.menu):I.none()}))})))},s=function(n,e,o){var r=c(e,e.otherMenus(o));j(r,(function(e){Ou(e.element,[t.markers.backgroundMenu]),t.stayInDom||Sg.remove(n,e)}))},f=function(n,e){var r=function(n){return o.get().getOrThunk((function(){var e={},r=_s(n.element,"."+t.markers.item),u=X(r,(function(t){return"true"===qn(t,"aria-haspopup")}));return j(u,(function(t){n.getSystem().getByDom(t).each((function(t){var n=i(t);e[n]=t}))})),o.set(e),e}))}(n);dt(r,(function(t,n){var o=z(e,n);Gn(t.element,"aria-expanded",o)}))},l=function(n,e,o){return I.from(o[0]).bind((function(r){return e.lookupMenu(r).bind((function(r){if("notbuilt"===r.type)return I.none();var i=r.menu,u=c(e,o.slice(1));return j(u,(function(n){wu(n.element,t.markers.backgroundMenu)})),Ln(i.element)||Sg.append(n,Ru(i)),Ou(i.element,[t.markers.backgroundMenu]),a(n,i),s(n,e,o),I.some(i)}))}))};!function(t){t[t.HighlightSubmenu=0]="HighlightSubmenu",t[t.HighlightParent=1]="HighlightParent"}(e||(e={}));var d=function(n,o,u){if(void 0===u&&(u=e.HighlightSubmenu),o.hasConfigured(dd)&&dd.isDisabled(o))return I.some(o);var a=i(o);return r.expand(a).bind((function(i){return f(n,i),I.from(i[0]).bind((function(a){return r.lookupMenu(a).bind((function(c){var s=function(t,n,e){if("notbuilt"===e.type){var o=t.getSystem().build(e.nbMenu());return r.setMenuBuilt(n,o),o}return e.menu}(n,a,c);return Ln(s.element)||Sg.append(n,Ru(s)),t.onOpenSubmenu(n,o,s,tt(i)),u===e.HighlightSubmenu?(Sd.highlightFirst(s),l(n,r,i)):(Sd.dehighlightAll(s),I.some(o))}))}))}))},m=function(n,e){var o=i(e);return r.collapse(o).bind((function(o){return f(n,o),l(n,r,o).map((function(o){return t.onCollapseMenu(n,e,o),o}))}))},p=function(n){return function(e,o){return ju(o.getSource(),"."+t.markers.item).bind((function(t){return e.getSystem().getByDom(t).toOptional().bind((function(t){return n(e,t).map(k)}))}))}},h=Ci([Ti(op(),(function(t,n){var e=n.event.item;r.lookupItem(i(e)).each((function(){var e=n.event.menu;Sd.highlight(t,e);var o=i(n.event.item);r.refresh(o).each((function(n){return s(t,r,n)}))}))})),Hi((function(n,o){var r=o.event.target;n.getSystem().getByDom(r).each((function(o){0===i(o).indexOf("collapse-item")&&m(n,o),d(n,o,e.HighlightSubmenu).fold((function(){t.onExecute(n,o)}),g)}))})),Ri((function(n,e){(function(n){var e=function(n,e,o){return mt(o,(function(o,r){var i=function(){return rp.sketch(O(O({},o),{value:r,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:t.fakeFocus?jd():Ud()}))};return r===e?{type:"prepared",menu:n.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))}(n,t.data.primary,t.data.menus),o=u();return r.setContents(t.data.primary,e,t.data.expansions,o),r.getPrimary()})(n).each((function(e){Sg.append(n,Ru(e)),t.onOpenMenu(n,e),t.highlightImmediately&&a(n,e)}))}))].concat(t.navigateOnHover?[Ti(qg(),(function(n,o){var u=o.event.item;!function(t,n){var e=i(n);r.refresh(e).bind((function(n){return f(t,n),l(t,r,n)}))}(n,u),d(n,u,e.HighlightParent),t.onHover(n,u)}))]:[])),v=function(t){return Sd.getHighlighted(t).bind(Sd.getHighlighted)},b={collapseMenu:function(t){v(t).each((function(n){m(t,n)}))},highlightPrimary:function(t){r.getPrimary().each((function(n){a(t,n)}))},repositionMenus:function(n){var e=r.getPrimary().bind((function(t){return v(n).bind((function(t){var n=i(t),e=vt(r.getMenus()),o=St(U(e,cp));return r.getTriggeringPath(n,(function(t){return function(t,n,e){return st(n,(function(t){if(!t.getSystem().isConnected())return I.none();var n=Sd.getCandidates(t);return K(n,(function(t){return i(t)===e}))}))}(0,o,t)}))})).map((function(n){return{primary:t,triggeringPath:n}}))}));e.fold((function(){(function(t){return I.from(t.components()[0]).filter((function(t){return"menu"===qn(t.element,"role")}))})(n).each((function(e){t.onRepositionMenu(n,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath;t.onRepositionMenu(n,o,r)}))}};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Yf(t.tmenuBehaviours,[hg.config({mode:"special",onRight:p((function(t,n){return Kl(n.element)?I.none():d(t,n,e.HighlightSubmenu)})),onLeft:p((function(t,n){return Kl(n.element)?I.none():m(t,n)})),onEscape:p((function(n,e){return m(n,e).orThunk((function(){return t.onEscape(n,e).map((function(){return n}))}))})),focusIn:function(t,n){r.getPrimary().each((function(n){wi(t,n.element,Qr())}))}}),Sd.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),Ql.config({find:function(t){return Sd.getHighlighted(t)}}),Sg.config({})]),eventOrder:t.eventOrder,apis:b,events:h}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:hr(t,n),expansions:{}}},collapseItem:function(t){return{value:Xi(sp()),meta:{text:t}}}}}),lp=ql({name:"InlineView",configFields:[Lo("lazySink"),ra("onShow"),ra("onHide"),tr("onEscape"),Xf("inlineBehaviours",[Of,Gf,ec]),er("fireDismissalEventInstead",[or("event",fi())]),er("fireRepositionEventInstead",[or("event",li())]),or("getRelated",I.none),or("isExtraPart",S),or("eventOrder",I.none)],factory:function(t,n){var e=function(t,n,e,r){o(t,n,e,(function(){return r.map((function(t){return Ne(t)}))}))},o=function(n,e,o,r){var i=t.lazySink(n).getOrDie();Of.openWhileCloaked(n,e,(function(){return nf.positionWithinBounds(i,n,o,r())})),Gf.setValue(n,I.some({mode:"position",config:o,getBounds:r}))},r=function(n,e,o,r){var i=function(t,n,e,o,r){var i=function(){return t.lazySink(n)},u="horizontal"===o.type?{layouts:{onLtr:function(){return Ua()},onRtl:function(){return ja()}}}:{},a=function(t){return function(t){return 2===t.length}(t)?u:{}};return fp.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightImmediately:o.menu.highlightImmediately,onEscape:function(){return Of.close(n),t.onEscape.map((function(t){return t(n)})),I.some(!0)},onExecute:function(){return I.some(!0)},onOpenMenu:function(t,n){nf.positionWithinBounds(i().getOrDie(),n,e,r())},onOpenSubmenu:function(t,n,e,o){var r=i().getOrDie();nf.position(r,e,{anchor:O({type:"submenu",item:n},a(o))})},onRepositionMenu:function(t,n,o){var u=i().getOrDie();nf.positionWithinBounds(u,n,e,r()),j(o,(function(t){var n=a(t.triggeringPath);nf.position(u,t.triggeredMenu,{anchor:O({type:"submenu",item:t.triggeringItem},n)})}))}})}(t,n,e,o,r);Of.open(n,i),Gf.setValue(n,I.some({mode:"menu",menu:i}))},i=function(n){Of.isOpen(n)&&Gf.getValue(n).each((function(e){switch(e.mode){case"menu":Of.getState(n).each(fp.repositionMenus);break;case"position":var o=t.lazySink(n).getOrDie();nf.positionWithinBounds(o,n,e.config,e.getBounds())}}))},u={setContent:function(t,n){Of.setContent(t,n)},showAt:function(t,n,o){e(t,n,o,I.none())},showWithin:e,showWithinBounds:o,showMenuAt:function(t,n,e){r(t,n,e,I.none)},showMenuWithinBounds:r,hide:function(t){Of.isOpen(t)&&(Gf.setValue(t,I.none()),Of.close(t))},getContent:function(t){return Of.getState(t)},reposition:i,isOpen:Of.isOpen};return{uid:t.uid,dom:t.dom,behaviours:Yf(t.inlineBehaviours,[Of.config({isPartOf:function(n,e,o){return Xu(e,o)||function(n,e){return t.getRelated(n).exists((function(t){return Xu(t,e)}))}(n,o)},getAttachPoint:function(n){return t.lazySink(n).getOrDie()},onOpen:function(n){t.onShow(n)},onClose:function(n){t.onHide(n)}}),Gf.config({store:{mode:"memory",initialValue:I.none()}}),ec.config({channels:O(O({},Mf(O({isExtraPart:n.isExtraPart},t.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),Df(O(O({},t.fireRepositionEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})),{doReposition:i})))})]),eventOrder:t.eventOrder,apis:u}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),dp="layout-inset",mp=function(t){return t.x},gp=function(t,n){return t.x+t.width/2-n.width/2},pp=function(t,n){return t.x+t.width-n.width},hp=function(t){return t.y},vp=function(t,n){return t.y+t.height-n.height},bp=function(t,n){return t.y+t.height/2-n.height/2},yp=function(t,n,e){return la(pp(t,n),vp(t,n),e.insetSouthwest(),ha(),"southwest",ka(t,{right:0,bottom:3}),dp)},xp=function(t,n,e){return la(mp(t),vp(t,n),e.insetSoutheast(),pa(),"southeast",ka(t,{left:1,bottom:3}),dp)},wp=function(t,n,e){return la(pp(t,n),hp(t),e.insetNorthwest(),ga(),"northwest",ka(t,{right:0,top:2}),dp)},Sp=function(t,n,e){return la(mp(t),hp(t),e.insetNortheast(),ma(),"northeast",ka(t,{left:1,top:2}),dp)},kp=function(t,n,e){return la(gp(t,n),hp(t),e.insetNorth(),va(),"north",ka(t,{top:2}),dp)},Cp=function(t,n,e){return la(gp(t,n),vp(t,n),e.insetSouth(),ba(),"south",ka(t,{bottom:3}),dp)},Op=function(t,n,e){return la(pp(t,n),bp(t,n),e.insetEast(),xa(),"east",ka(t,{right:0}),dp)},_p=function(t,n,e){return la(mp(t),bp(t,n),e.insetWest(),ya(),"west",ka(t,{left:1}),dp)},Tp=function(t){switch(t){case"north":return kp;case"northeast":return Sp;case"northwest":return wp;case"south":return Cp;case"southeast":return xp;case"southwest":return yp;case"east":return Op;case"west":return _p}},Ep=function(t,n,e,o,r){return Sc(o).map(Tp).getOr(kp)(t,n,e,o,r)},Bp=function(t){switch(t){case"north":return Cp;case"northeast":return xp;case"northwest":return yp;case"south":return kp;case"southeast":return Sp;case"southwest":return wp;case"east":return _p;case"west":return Op}},Mp=function(t,n,e,o,r){return Sc(o).map(Bp).getOr(kp)(t,n,e,o,r)},Ap=tinymce.util.Tools.resolve("tinymce.util.Delay"),Dp=ql({name:"Button",factory:function(t){var n=Wg(t.action),e=t.dom.tag,o=function(n){return bt(t.dom,"attributes").bind((function(t){return bt(t,n)}))};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:Jf(t.buttonBehaviours,[Eg.config({}),hg.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"===e){var t=o("type").getOr("button"),n=o("role").map((function(t){return{role:t}})).getOr({});return O({type:t},n)}return{role:o("role").getOr("button")}}()},eventOrder:t.eventOrder}},configFields:[or("uid",void 0),Lo("dom"),or("components",[]),Kf("buttonBehaviours",[Eg,hg]),Jo("action"),Jo("role"),or("eventOrder",{})]}),Fp=function(t){var n=function(t){return void 0!==t.uid}(t)&&xt(t,"uid")?t.uid:Zi("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return O(O({},t),{uid:n})}}},Ip=tinymce.util.Tools.resolve("tinymce.util.I18n"),Rp={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},Vp="temporary-placeholder",Pp=function(t){return function(){return bt(t,Vp).getOr("!not found!")}},Hp=function(t,n){var e=t.toLowerCase();if(Ip.isRtl()){var o=function(t,n){return Tt(t,n)?t:function(t,n){return t+"-rtl"}(t)}(e,"-rtl");return yt(n,o)?o:e}return e},zp=function(t,n){return bt(n,Hp(t,n))},Np=function(t,n){var e=n();return zp(t,e).getOrThunk(Pp(e))},Lp=function(){return kg("add-focusable",[Ri((function(t){Wu(t.element,"svg").each((function(t){return Gn(t,"focusable","false")}))}))])},Wp=function(t,n,e,o){var r,i,u=function(t){return!!Ip.isRtl()&&yt(Rp,t)}(n)?["tox-icon--flip"]:[],a=bt(e,Hp(n,e)).or(o).getOrThunk(Pp(e));return{dom:{tag:t.tag,attributes:null!==(r=t.attributes)&&void 0!==r?r:{},classes:t.classes.concat(u),innerHtml:a},behaviours:Ja(T(T([],null!==(i=t.behaviours)&&void 0!==i?i:[],!0),[Lp()],!1))}},Up=function(t,n,e,o){return void 0===o&&(o=I.none()),Wp(n,t,e(),o)},jp={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Gp=ql({name:"Notification",factory:function(t){var n,e,o,r,i,u=Fp({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:Ja([Sg.config({})])}),a=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},c=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},s=Fp({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[a(0)]},c(0)],behaviours:Ja([Sg.config({})])}),f={updateProgress:function(t,n){t.getSystem().isConnected()&&s.getOpt(t).each((function(t){Sg.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[a(n)]},c(n)])}))},updateText:function(t,n){if(t.getSystem().isConnected()){var e=u.get(t);Sg.set(e,[Au(n)])}}},l=$([t.icon.toArray(),t.level.toArray(),t.level.bind((function(t){return I.from(jp[t])})).toArray()]),d=Fp(Dp.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[Up("close",{tag:"div",classes:["tox-icon"],attributes:{"aria-label":t.translationProvider("Close")}},t.iconProvider)],action:function(n){t.onAction(n)}})),m=(n=l,e={tag:"div",classes:["tox-notification__icon"]},o=t.iconProvider,r=o(),i=K(n,(function(t){return yt(r,Hp(t,r))})),Wp(e,i.getOr(Vp),r,I.none())),g=[m,{dom:{tag:"div",classes:["tox-notification__body"]},components:[u.asSpec()],behaviours:Ja([Sg.config({})])}];return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map((function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]})).getOr(["tox-notification","tox-notification--in"])},behaviours:Ja([Eg.config({}),kg("notification-events",[Ti(Ir(),(function(t){d.getOpt(t).each(Eg.focus)}))])]),components:g.concat(t.progress?[s.asSpec()]:[]).concat(t.closeButton?[d.asSpec()]:[]),apis:f}},configFields:[Jo("level"),Lo("progress"),Lo("icon"),Lo("onAction"),Lo("text"),Lo("iconProvider"),Lo("translationProvider"),cr("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}});var Xp,qp=function(t,n){var e=null,o=function(){u(e)||(clearTimeout(e),e=null)};return{cancel:o,throttle:function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];o(),e=setTimeout((function(){e=null,t.apply(null,r)}),n)}}},Yp=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),Kp=function(t,n,e,o,r){var i=Yp(t,(function(n){return function(t,n){return t.isBlock(n)||z(["BR","IMG","HR","INPUT"],n.nodeName)||"false"===t.getContentEditable(n)}(t,n)}));return I.from(i.backwards(n,e,o,r))},Jp=function(t,n){return $p(Rt(t.selection.getNode())).getOrThunk((function(){var e=Dt('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());return Te(e,Rt(n.extractContents())),n.insertNode(e.dom),En(e).each((function(t){return t.dom.normalize()})),function(t){return n=Os,e=function(t){for(var o=Mn(t),r=o.length-1;r>=0;r--){var i=o[r];if(n(i))return I.some(i);var u=e(i);if(u.isSome())return u}return I.none()},e(t);var n,e}(e).map((function(n){t.selection.setCursorLocation(n.dom,function(t){return"img"===Pt(t)?1:ks(t).fold((function(){return Mn(t).length}),(function(t){return t.length}))}(n))})),e}))},$p=function(t){return ju(t,"[data-mce-autocompleter]")},Qp=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},Zp=function(t){return""!==t&&-1!==" \f\n\r\t\v".indexOf(t)},th=function(t,n){return t.substring(n.length)},nh=function(t,n,e,o){return void 0===o&&(o=0),$p(Rt(n.startContainer)).fold((function(){return function(t,n,e,o){if(void 0===o&&(o=0),!(r=n).collapsed||3!==r.startContainer.nodeType)return I.none();var r,i=t.getParent(n.startContainer,t.isBlock)||t.getRoot();return Kp(t,n.startContainer,n.startOffset,(function(t,n,o){return function(t,n,e){var o;for(o=n-1;o>=0;o--){var r=t.charAt(o);if(Zp(r))return I.none();if(r===e)break}return I.some(o)}(o,n,e).getOr(n)}),i).bind((function(t){var r=n.cloneRange();if(r.setStart(t.container,t.offset),r.setEnd(n.endContainer,n.endOffset),r.collapsed)return I.none();var i=Qp(r);return 0!==i.lastIndexOf(e)||th(i,e).length<o?I.none():I.some({text:th(i,e),range:r,triggerChar:e})}))}(t,n,e,o)}),(function(n){var o=t.createRng();o.selectNode(n.dom);var r=Qp(o);return I.some({range:o,text:th(r,e),triggerChar:e})}))},eh=tinymce.util.Tools.resolve("tinymce.util.Promise"),oh=function(t,n){return{container:t,offset:n}},rh=function(t){if(function(t){return 3===t.nodeType}(t))return oh(t,t.data.length);var n=t.childNodes;return n.length>0?rh(n[n.length-1]):oh(t,n.length)},ih=function(t,n){var e=t.childNodes;return e.length>0&&n<e.length?ih(e[n],0):e.length>0&&function(t){return 1===t.nodeType}(t)&&e.length===n?rh(e[e.length-1]):oh(t,n)},uh=function(t,n,e,o){void 0===o&&(o={});var r=n(),i=t.selection.getRng().startContainer.nodeValue,u=X(r.lookupByChar(e.triggerChar),(function(n){return e.text.length>=n.minChars&&n.matches.getOrThunk((function(){return function(t){return function(n){var e=ih(n.startContainer,n.startOffset);return!function(t,n){return Kp(t,n.container,n.offset,(function(t,n){return 0===n?-1:n}),t.getRoot()).filter((function(t){var n=t.container.data.charAt(t.offset-1);return!Zp(n)})).isSome()}(t,e)}}(t.dom)}))(e.range,i,e.text)}));if(0===u.length)return I.none();var a=eh.all(U(u,(function(t){return t.fetch(e.text,t.maxResults,o).then((function(n){return{matchText:e.text,items:n,columns:t.columns,onAction:t.onAction,highlightOn:t.highlightOn}}))})));return I.some({lookupData:a,context:e})},ah=vo([jo("type"),Zo("text")]),ch=vo([or("type","autocompleteitem"),or("active",!1),or("disabled",!1),or("meta",{}),jo("value"),Zo("text"),Zo("icon")]),sh=vo([jo("type"),jo("ch"),ir("minChars",1),or("columns",1),ir("maxResults",10),tr("matches"),Xo("fetch"),Xo("onAction"),fr("highlightOn",[],Oo)]),fh=[cr("disabled",!1),Zo("tooltip"),Zo("icon"),Zo("text"),sr("onSetup",(function(){return g}))],lh=vo([jo("type"),Xo("onAction")].concat(fh)),dh=function(t){return Fo("toolbarbutton",lh,t)},mh=[cr("active",!1)].concat(fh),gh=vo(mh.concat([jo("type"),Xo("onAction")])),ph=function(t){return Fo("ToggleButton",gh,t)},hh=[sr("predicate",S),ar("scope","node",["node","editor"]),ar("position","selection",["node","selection","line"])],vh=fh.concat([or("type","contextformbutton"),or("primary",!1),Xo("onAction"),zo("original",v)]),bh=mh.concat([or("type","contextformbutton"),or("primary",!1),Xo("onAction"),zo("original",v)]),yh=fh.concat([or("type","contextformbutton")]),xh=mh.concat([or("type","contextformtogglebutton")]),wh=Po("type",{contextformbutton:vh,contextformtogglebutton:bh}),Sh=vo([or("type","contextform"),sr("initValue",h("")),Zo("label"),Ko("commands",wh),$o("launch",Po("type",{contextformbutton:yh,contextformtogglebutton:xh}))].concat(hh)),kh=vo([or("type","contexttoolbar"),jo("items")].concat(hh));!function(t){t[t.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",t[t.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX"}(Xp||(Xp={}));var Ch,Oh=Xp,_h="tox-menu-nav__js",Th="tox-collection__item",Eh={normal:_h,color:"tox-swatch"},Bh="tox-collection__item--enabled",Mh="tox-collection__item-icon",Ah="tox-collection__item-label",Dh="tox-collection__item-caret",Fh="tox-collection__item--active",Ih="tox-collection__item-container",Rh="tox-collection__item-container--row",Vh=function(t){return bt(Eh,t).getOr(_h)},Ph=function(t){return"color"===t?"tox-swatches":"tox-menu"},Hh=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:Ph(t),tieredMenu:"tox-tiered-menu"}},zh=function(t){var n=Hh(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:Vh(t)}},Nh=function(t,n,e){var o=Hh(e);return{tag:"div",classes:$([[o.menu,"tox-menu-"+n+"-column"],t?[o.hasIcons]:[]])}},Lh=[rp.parts.items({})],Wh=function(t,n,e){var o=Hh(e);return{dom:{tag:"div",classes:$([[o.tieredMenu]])},markers:zh(e)}},Uh=function(t,n){return function(e){var o=W(e,n);return U(o,(function(n){return{dom:t,components:n}}))}},jh=function(t,n){var e=[],o=[];return j(t,(function(t,r){n(t,r)?(o.length>0&&e.push(o),o=[],yt(t.dom,"innerHtml")&&o.push(t)):o.push(t)})),o.length>0&&e.push(o),U(e,(function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}}))},Gh=function(t,n,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[rp.parts.items({preprocess:function(e){return"auto"!==t&&t>1?Uh({tag:"div",classes:["tox-collection__group"]},t)(e):jh(e,(function(t,e){return"separator"===n[e].type}))}})]}},Xh=function(t){return N(t,(function(t){return"icon"in t&&void 0!==t.icon}))},qh=function(t){return console.error(Vo(t)),console.log(t),I.none()},Yh=function(t,n,e,o,r){var i,u=(i=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[rp.parts.items({preprocess:function(t){return jh(t,(function(t,n){return"separator"===i[n].type}))}})]});return{value:t,dom:u.dom,components:u.components,items:e}},Kh=function(t,n,e,o,r){if("color"===r){var i=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[rp.parts.items({preprocess:"auto"!==t?Uh({tag:"div",classes:["tox-swatches__row"]},t):v})]}]}}(o);return{value:t,dom:i.dom,components:i.components,items:e}}return"normal"===r&&"auto"===o?{value:t,dom:(i=Gh(o,e)).dom,components:i.components,items:e}:"normal"===r&&1===o?{value:t,dom:(i=Gh(1,e)).dom,components:i.components,items:e}:"normal"===r?{value:t,dom:(i=Gh(o,e)).dom,components:i.components,items:e}:"listpreview"===r&&"auto"!==o?(i=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[rp.parts.items({preprocess:Uh({tag:"div",classes:["tox-collection__group"]},t)})]}}(o),{value:t,dom:i.dom,components:i.components,items:e}):{value:t,dom:Nh(n,o,r),components:Lh,items:e}},Jh=[jo("type"),jo("src"),Zo("alt"),fr("classes",[],Oo)],$h=vo(Jh),Qh=[jo("type"),jo("text"),Zo("name"),fr("classes",["tox-collection__item-label"],Oo)],Zh=vo(Qh),tv=go((function(){return Mo("type",{cardimage:$h,cardtext:Zh,cardcontainer:nv})})),nv=vo([jo("type"),ur("direction","horizontal"),ur("align","left"),ur("valign","middle"),Ko("items",tv)]),ev=[cr("disabled",!1),Zo("text"),Zo("shortcut"),Ho("value","value",oo((function(){return Xi("menuitem-value")})),So()),or("meta",{})],ov=vo([jo("type"),Zo("label"),Ko("items",tv),sr("onSetup",(function(){return g})),sr("onAction",g)].concat(ev)),rv=vo([jo("type"),cr("active",!1),Zo("icon")].concat(ev)),iv=[jo("type"),jo("fancytype"),sr("onAction",g)],uv=[or("initData",{})].concat(iv),av=[lr("initData",{},[cr("allowCustomColors",!0),nr("colors",So())])].concat(iv),cv=Po("fancytype",{inserttable:uv,colorswatch:av}),sv=vo([jo("type"),sr("onSetup",(function(){return g})),sr("onAction",g),Zo("icon")].concat(ev)),fv=vo([jo("type"),Xo("getSubmenuItems"),sr("onSetup",(function(){return g})),Zo("icon")].concat(ev)),lv=vo([jo("type"),Zo("icon"),cr("active",!1),sr("onSetup",(function(){return g})),Xo("onAction")].concat(ev)),dv=function(t,n,e){var o=_s(t.element,"."+e);if(o.length>0){var r=J(o,(function(t){var e=t.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top;return Math.abs(e-r)>n})).getOr(o.length);return I.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return I.none()},mv=function(t){return function(t,n){return Ja([kg(t,n)])}(Xi("unnamed-events"),t)},gv=Xi("tooltip.exclusive"),pv=Xi("tooltip.show"),hv=Xi("tooltip.hide"),vv=function(t,n,e){t.getSystem().broadcastOn([gv],{})},bv=Object.freeze({__proto__:null,hideAllExclusive:vv,setComponents:function(t,n,e,o){e.getTooltip().each((function(t){t.getSystem().isConnected()&&Sg.set(t,o)}))}}),yv=Object.freeze({__proto__:null,events:function(t,n){var e=function(e){n.getTooltip().each((function(o){ff(o),t.onHide(e,o),n.clearTooltip()})),n.clearTimer()};return Ci($([[Ti(pv,(function(e){n.resetTimer((function(){!function(e){if(!n.isShowing()){vv(e);var o=t.lazySink(e).getOrDie(),r=e.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:Ci("normal"===t.mode?[Ti(Fr(),(function(t){bi(e,pv)})),Ti(Ar(),(function(t){bi(e,hv)}))]:[]),behaviours:Ja([Sg.config({})])});n.setTooltip(r),af(o,r),t.onShow(e,r),nf.position(o,r,{anchor:t.anchor(e)})}}(e)}),t.delay)})),Ti(hv,(function(o){n.resetTimer((function(){e(o)}),t.delay)})),Ti(Jr(),(function(t,n){var o=n;o.universal||z(o.channels,gv)&&e(t)})),Vi((function(t){e(t)}))],"normal"===t.mode?[Ti(Ir(),(function(t){bi(t,pv)})),Ti(Yr(),(function(t){bi(t,hv)})),Ti(Fr(),(function(t){bi(t,pv)})),Ti(Ar(),(function(t){bi(t,hv)}))]:[Ti(hi(),(function(t,n){bi(t,pv)})),Ti(vi(),(function(t){bi(t,hv)}))]]))}}),xv=[Lo("lazySink"),Lo("tooltipDom"),or("exclusive",!0),or("tooltipComponents",[]),or("delay",300),ar("mode","normal",["normal","follow-highlight"]),or("anchor",(function(t){return{type:"hotspot",hotspot:t,layouts:{onLtr:h([Va,Ra,Aa,Fa,Da,Ia]),onRtl:h([Va,Ra,Aa,Fa,Da,Ia])}}})),ra("onHide"),ra("onShow")],wv=Qa({fields:xv,name:"tooltipping",active:yv,state:Object.freeze({__proto__:null,init:function(){var t=Ec(),n=Ec(),e=function(){t.on(clearTimeout)},o=h("not-implemented");return su({getTooltip:n.get,isShowing:n.isSet,setTooltip:n.set,clearTooltip:n.clear,clearTimer:e,resetTimer:function(n,o){e(),t.set(setTimeout(n,o))},readState:o})}}),apis:bv}),Sv=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),kv=tinymce.util.Tools.resolve("tinymce.EditorManager"),Cv=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},Ov=function(t){return t.getParam("width",Sv.DOM.getStyle(t.getElement(),"width"))},_v=function(t){return I.from(t.getParam("min_width")).filter(d)},Tv=function(t){return I.from(t.getParam("min_height")).filter(d)},Ev=function(t){return I.from(t.getParam("max_width")).filter(d)},Bv=function(t){return I.from(t.getParam("max_height")).filter(d)},Mv=function(t){return!1!==t.getParam("menubar",!0,"boolean")},Av=function(t){var n=t.getParam("toolbar",!0),e=!0===n,r=o(n),u=i(n)&&n.length>0;return!Fv(t)&&(u||r||e)},Dv=function(t){var n=L(9,(function(n){return t.getParam("toolbar"+(n+1),!1,"string")})),e=X(n,(function(t){return"string"==typeof t}));return e.length>0?I.some(e):I.none()},Fv=function(t){return Dv(t).fold((function(){return t.getParam("toolbar",[],"string[]").length>0}),k)};!function(t){t.default="wrap",t.floating="floating",t.sliding="sliding",t.scrolling="scrolling"}(Ch||(Ch={}));var Iv,Rv=function(t){return t.getParam("toolbar_mode","","string")};!function(t){t.auto="auto",t.top="top",t.bottom="bottom"}(Iv||(Iv={}));var Vv,Pv,Hv=function(t){return t.getParam("toolbar_location",Iv.auto,"string")},zv=function(t){return Hv(t)===Iv.bottom},Nv=function(t){if(!t.inline)return I.none();var n=function(t){return t.getParam("fixed_toolbar_container","","string")}(t);if(n.length>0)return Uu(Wn(),n);var e=function(t){return t.getParam("fixed_toolbar_container_target")}(t);return f(e)?I.some(Rt(e)):I.none()},Lv=function(t){return t.inline&&Nv(t).isSome()},Wv=function(t){return Nv(t).getOrThunk((function(){return Hn(Pn(Rt(t.getElement())))}))},Uv=function(t){return t.inline&&!Mv(t)&&!Av(t)&&!Fv(t)},jv=function(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!Lv(t)&&!Uv(t)},Gv=function(t){var n=t.getParam("menu");return n?mt(n,(function(t){return O(O({},t),{items:t.items})})):{}},Xv=function(t){return t.getParam("menubar")},qv=function(t){return t.getParam("anchor_top","#top")},Yv=function(t){return t.getParam("anchor_bottom","#bottom")},Kv="silver.readonly",Jv=vo([("readonly",Wo("readonly",_o))]),$v=function(t,n){var e=t.outerContainer.element;n&&(t.mothership.broadcastOn([_f()],{target:e}),t.uiMothership.broadcastOn([_f()],{target:e})),t.mothership.broadcastOn([Kv],{readonly:n}),t.uiMothership.broadcastOn([Kv],{readonly:n})},Qv=function(t,n){t.on("init",(function(){t.mode.isReadOnly()&&$v(n,!0)})),t.on("SwitchMode",(function(){return $v(n,t.mode.isReadOnly())})),function(t){return t.getParam("readonly",!1,"boolean")}(t)&&t.setMode("readonly")},Zv=function(){var t;return ec.config({channels:(t={},t[Kv]={schema:Jv,onReceive:function(t,n){dd.set(t,n.readonly)}},t)})},tb=function(t){return dd.config({disabled:t})},nb=function(t){return dd.config({disabled:t,disableClass:"tox-tbtn--disabled"})},eb=function(t){return dd.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},ob=function(t,n){var e=t.getApi(n);return function(t){t(e)}},rb=function(t,n){return Ri((function(e){ob(t,e)((function(e){var o=t.onSetup(e);l(o)&&n.set(o)}))}))},ib=function(t,n){return Vi((function(e){return ob(t,e)(n.get())}))},ub=function(t,n){return Hi((function(e,o){ob(t,e)(t.onAction),t.triggersSubmenu||n!==Oh.CLOSE_ON_EXECUTE||(bi(e,ni()),o.stop())}))},ab=((Vv={})[$r()]=["disabling","alloy.base.behaviour","toggling","item-events"],Vv),cb=St,sb=function(t,n,e,o){var r,i=dr(g);return{type:"item",dom:n.dom,components:cb(n.optComponents),data:t.data,eventOrder:ab,hasSubmenu:t.triggersSubmenu,itemBehaviours:Ja([kg("item-events",[ub(t,e),rb(t,i),ib(t,i)]),(r=function(){return t.disabled||o.isDisabled()},dd.config({disabled:r,disableClass:"tox-collection__item--state-disabled"})),Zv(),Sg.config({})].concat(t.itemBehaviours))}},fb=function(t){return{value:t.value,meta:O({text:t.text.getOr("")},t.meta)}},lb=tinymce.util.Tools.resolve("tinymce.Env"),db=function(t){var n=lb.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},e=t.split("+"),o=U(e,(function(t){var e=t.toLowerCase().trim();return yt(n,e)?n[e]:t}));return lb.mac?o.join(""):o.join("+")},mb=function(t,n,e){return void 0===e&&(e=[Mh]),Up(t,{tag:"div",classes:e},n)},gb=function(t){return{dom:{tag:"div",classes:[Ah]},components:[Au(Ip.translate(t))]}},pb=function(t,n){return{dom:{tag:"div",classes:n,innerHtml:t}}},hb=function(t,n){return{dom:{tag:"div",classes:[Ah]},components:[{dom:{tag:t.tag,styles:t.styles},components:[Au(Ip.translate(n))]}]}},vb=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:db(t)}}},bb=function(t){return mb("checkmark",t,["tox-collection__item-checkmark"])},yb=function(t){var n=t.map((function(t){return{attributes:{title:Ip.translate(t)}}})).getOr({});return O({tag:"div",classes:[_h,Th]},n)},xb=function(t,n,e,o){return void 0===o&&(o=I.none()),"color"===t.presets?function(t,n,e){var o,r,i,u=t.ariaLabel,a=t.value,c=t.iconContent.map((function(t){return function(t,n,e){var o=n();return zp(t,o).or(e).getOrThunk(Pp(o))}(t,n.icons,e)}));return{dom:(o=c.getOr(""),r=u.map((function(t){return{title:n.translate(t)}})).getOr({}),i={tag:"div",attributes:r,classes:["tox-swatch"]},O(O({},i),"custom"===a?{tag:"button",classes:T(T([],i.classes,!0),["tox-swatches__picker-btn"],!1),innerHtml:o}:"remove"===a?{classes:T(T([],i.classes,!0),["tox-swatch--remove"],!1),innerHtml:o}:{attributes:O(O({},i.attributes),{"data-mce-color":a}),styles:{"background-color":a}})),optComponents:[]}}(t,n,o):function(t,n,e,o){var r={tag:"div",classes:[Mh]},i=e?t.iconContent.map((function(t){return Up(t,r,n.icons,o)})).orThunk((function(){return I.some({dom:r})})):I.none(),u=t.checkMark,a=I.from(t.meta).fold((function(){return gb}),(function(t){return yt(t,"style")?y(hb,t.style):gb})),c=t.htmlContent.fold((function(){return t.textContent.map(a)}),(function(t){return I.some(pb(t,[Ah]))}));return{dom:yb(t.ariaLabel),optComponents:[i,c,t.shortcutContent.map(vb),u,t.caret]}}(t,n,e,o)},wb=function(t,n){return bt(t,"tooltipWorker").map((function(t){return[wv.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{type:"submenu",item:t,overrides:{maxHeightFunction:Hc}}},mode:"follow-highlight",onShow:function(n,e){t((function(t){wv.setComponents(n,[Du({element:Rt(t)})])}))}})]})).getOr([])},Sb=function(t,n){var e=function(t){return Sv.DOM.encode(t)}(Ip.translate(t));if(n.length>0){var o=new RegExp(function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(n),"gi");return e.replace(o,(function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"}))}return e},kb=function(t,n){return U(t,(function(t){switch(t.type){case"cardcontainer":return function(t,n){var e="vertical"===t.direction?"tox-collection__item-container--column":Rh,o="left"===t.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right";return{dom:{tag:"div",classes:[Ih,e,o,function(){switch(t.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:n}}(t,kb(t.items,n));case"cardimage":return function(t,n,e){return{dom:{tag:"img",classes:n,attributes:{src:t,alt:e.getOr("")}}}}(t.src,t.classes,t.alt);case"cardtext":var e=t.name.exists((function(t){return z(n.cardText.highlightOn,t)})),o=e?I.from(n.cardText.matchText).getOr(""):"";return pb(Sb(t.text,o),t.classes)}}))},Cb=_l($g(),Qg()),Ob=function(t){return{value:t}},_b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Tb=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Eb=function(t){return _b.test(t)||Tb.test(t)},Bb=function(t){return(n=t,function(t,n){return Ot(t,n,0)}(n,"#")?function(t,n){return t.substring(n)}(n,"#".length):n).toUpperCase();var n},Mb=function(t){var n=t.toString(16);return(1===n.length?"0"+n:n).toUpperCase()},Ab=function(t){var n=Mb(t.red)+Mb(t.green)+Mb(t.blue);return Ob(n)},Db=Math.min,Fb=Math.max,Ib=Math.round,Rb=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Vb=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Pb=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},Hb=function(t){var n=parseInt(t,10);return n.toString()===t&&n>=0&&n<=255},zb=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,u=t.value/100;if(i=Fb(0,Db(i,1)),u=Fb(0,Db(u,1)),0===i)return n=e=o=Ib(255*u),Pb(n,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),f=u-c;switch(Math.floor(a)){case 0:n=c,e=s,o=0;break;case 1:n=s,e=c,o=0;break;case 2:n=0,e=c,o=s;break;case 3:n=0,e=s,o=c;break;case 4:n=s,e=0,o=c;break;case 5:n=c,e=0,o=s;break;default:n=e=o=0}return n=Ib(255*(n+f)),e=Ib(255*(e+f)),o=Ib(255*(o+f)),Pb(n,e,o,1)},Nb=function(t){var n,e,o=(n=function(t){var n=t.value.replace(_b,(function(t,n,e,o){return n+n+e+e+o+o}));return{value:n}}(t),null===(e=Tb.exec(n.value))?["FFFFFF","FF","FF","FF"]:e),r=parseInt(o[1],16),i=parseInt(o[2],16),u=parseInt(o[3],16);return Pb(r,i,u,1)},Lb=function(t,n,e,o){var r=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(o);return Pb(r,i,u,a)},Wb=function(t){if("transparent"===t)return I.some(Pb(0,0,0,0));var n=Rb.exec(t);if(null!==n)return I.some(Lb(n[1],n[2],n[3],"1"));var e=Vb.exec(t);return null!==e?I.some(Lb(e[1],e[2],e[3],e[4])):I.none()},Ub=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},jb=Pb(255,0,0,1),Gb=function(t,n){return t.fire("ResizeContent",n)},Xb=function(t,n,e){return{hue:t,saturation:n,value:e}},qb=function(t){var n,e=0,o=0,r=t.red/255,i=t.green/255,u=t.blue/255,a=Math.min(r,Math.min(i,u)),c=Math.max(r,Math.max(i,u));return a===c?Xb(0,0,100*(o=a)):(e=60*((e=r===a?3:u===a?1:5)-(r===a?i-u:u===a?r-i:u-r)/(c-a)),n=(c-a)/c,o=c,Xb(Math.round(e),Math.round(100*n),Math.round(100*o)))},Yb=function(t){return Ab(zb(t))},Kb=function(t){return(n=t,Eb(n)?I.some({value:Bb(n)}):I.none()).orThunk((function(){return Wb(t).map(Ab)})).getOrThunk((function(){var n=document.createElement("canvas");n.height=1,n.width=1;var e=n.getContext("2d");e.clearRect(0,0,n.width,n.height),e.fillStyle="#FFFFFF",e.fillStyle=t,e.fillRect(0,0,1,1);var o=e.getImageData(0,0,1,1).data,r=o[0],i=o[1],u=o[2],a=o[3];return Ab(Pb(r,i,u,a))}));var n},Jb=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),$b="tinymce-custom-colors",Qb="choiceitem",Zb=[{type:Qb,text:"Light Green",value:"#BFEDD2"},{type:Qb,text:"Light Yellow",value:"#FBEEB8"},{type:Qb,text:"Light Red",value:"#F8CAC6"},{type:Qb,text:"Light Purple",value:"#ECCAFA"},{type:Qb,text:"Light Blue",value:"#C2E0F4"},{type:Qb,text:"Green",value:"#2DC26B"},{type:Qb,text:"Yellow",value:"#F1C40F"},{type:Qb,text:"Red",value:"#E03E2D"},{type:Qb,text:"Purple",value:"#B96AD9"},{type:Qb,text:"Blue",value:"#3598DB"},{type:Qb,text:"Dark Turquoise",value:"#169179"},{type:Qb,text:"Orange",value:"#E67E23"},{type:Qb,text:"Dark Red",value:"#BA372A"},{type:Qb,text:"Dark Purple",value:"#843FA1"},{type:Qb,text:"Dark Blue",value:"#236FA1"},{type:Qb,text:"Light Gray",value:"#ECF0F1"},{type:Qb,text:"Medium Gray",value:"#CED4D9"},{type:Qb,text:"Gray",value:"#95A5A6"},{type:Qb,text:"Dark Gray",value:"#7E8C8D"},{type:Qb,text:"Navy Blue",value:"#34495E"},{type:Qb,text:"Black",value:"#000000"},{type:Qb,text:"White",value:"#ffffff"}],ty=function(t){void 0===t&&(t=10);var n,e=Jb.getItem($b),r=o(e)?JSON.parse(e):[],i=t-(n=r).length<0?n.slice(0,t):n,u=function(t){i.splice(t,1)};return{add:function(n){(function(t,n){var e=H(t,n);return-1===e?I.none():I.some(e)})(i,n).each(u),i.unshift(n),i.length>t&&i.pop(),Jb.setItem($b,JSON.stringify(i))},state:function(){return i.slice(0)}}}(10),ny=function(t){return!1!==t.getParam("custom_colors")},ey=function(t){var n=function(t){return t.getParam("color_map")}(t);return void 0!==n?function(t){for(var n=[],e=0;e<t.length;e+=2)n.push({text:t[e+1],value:"#"+Kb(t[e]).value,type:"choiceitem"});return n}(n):Zb},oy=function(t){ty.add(t)},ry="#000000",iy=function(t){var n;return function(t,n){return t.getParam("color_cols",n,"number")}(t,(n=ey(t).length,Math.max(5,Math.ceil(Math.sqrt(n)))))},uy=function(t){var n="choiceitem",e={type:n,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return t?[e,{type:n,text:"Custom color",icon:"color-picker",value:"custom"}]:[e]},ay=function(t,n,e,o){"custom"===e?my(t)((function(e){e.each((function(e){oy(e),t.execCommand("mceApplyTextcolor",n,e),o(e)}))}),ry):"remove"===e?(o(""),t.execCommand("mceRemoveTextcolor",n)):(o(e),t.execCommand("mceApplyTextcolor",n,e))},cy=function(t,n){return t.concat(U(ty.state(),(function(t){return{type:Qb,text:t,value:t}})).concat(uy(n)))},sy=function(t,n){return function(e){e(cy(t,n))}},fy=function(t,n,e){var o="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";t.setIconFill(o,e)},ly=function(t,n,e,o,r){t.ui.registry.addSplitButton(n,{tooltip:o,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(n){var o=function(t,n){var e;return t.dom.getParents(t.selection.getStart(),(function(t){var o;(o=t.style["forecolor"===n?"color":"background-color"])&&(e=e||o)})),I.from(e)}(t,e);return o.bind((function(t){return Wb(t).map((function(t){var e=Ab(t).value;return _t(n.toLowerCase(),e)}))})).getOr(!1)},columns:iy(t),fetch:sy(ey(t),ny(t)),onAction:function(n){ay(t,e,r.get(),g)},onItemAction:function(o,i){ay(t,e,i,(function(e){r.set(e),function(t,n){t.fire("TextColorChange",n)}(t,{name:n,color:e})}))},onSetup:function(e){fy(e,n,r.get());var o=function(t){t.name===n&&fy(e,t.name,t.color)};return t.on("TextColorChange",o),function(){t.off("TextColorChange",o)}}})},dy=function(t,n,e,o){t.ui.registry.addNestedMenuItem(n,{text:o,icon:"forecolor"===n?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(n){ay(t,e,n.value,g)}}]}})},my=function(t){return function(n,e){var o=!1,r={colorpicker:e};t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onAction:function(t,n){"hex-valid"===n.name&&(o=n.value)},onSubmit:function(e){var r=e.getData().colorpicker;o?(n(I.from(r)),e.close()):t.windowManager.alert(t.translate(["Invalid hex color code: {0}",r]))},onClose:g,onCancel:function(){n(I.none())}})}},gy=function(t,n,e,o,r,i,u,a){var c=Xh(n),s=py(n,e,o,"color"!==r?"normal":"color",i,u,a);return Kh(t,c,s,o,r)},py=function(t,n,e,o,r,i,u){return St(U(t,(function(a){return"choiceitem"===a.type?(c=a,Fo("choicemenuitem",rv,c)).fold(qh,(function(c){return I.some(function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=xb({presets:e,textContent:n?t.text:I.none(),htmlContent:I.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:I.none(),checkMark:n?I.some(bb(u.icons)):I.none(),caret:I.none(),value:t.value},u,a);return no(sb({data:fb(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){Ng.set(t,n)},isActive:function(){return Ng.isOn(t)},isDisabled:function(){return dd.isDisabled(t)},setDisabled:function(n){return dd.set(t,n)}}},onAction:function(n){return o(t.value)},onSetup:function(t){return t.setActive(r),g},triggersSubmenu:!1,itemBehaviours:[]},c,i,u),{toggling:{toggleClass:Bh,toggleOnExecute:!1,selected:t.active}})}(c,1===e,o,n,i(a.value),r,u,Xh(t)))})):I.none();var c})))},hy=function(t,n){var e=zh(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},vy=Xi("cell-over"),by=Xi("cell-execute"),yy=function(t,n,e){var o,r=function(e){return yi(e,by,{row:t,col:n})},i=function(t,n){n.stop(),r(t)};return Iu({dom:{tag:"div",attributes:(o={role:"button"},o["aria-labelledby"]=e,o)},behaviours:Ja([kg("insert-table-picker-cell",[Ti(Fr(),Eg.focus),Ti($r(),r),Ti(Nr(),i),Ti(Zr(),i)]),Ng.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),Eg.config({onFocus:function(e){return yi(e,vy,{row:t,col:n})}})])})},xy=function(t){return Q(t,(function(t){return U(t,Ru)}))},wy=function(t,n){return Au(n+"x"+t)},Sy={inserttable:function(t){var n=Xi("size-label"),e=function(t,n,e){for(var o=[],r=0;r<10;r++){for(var i=[],u=0;u<10;u++)i.push(yy(r,u,t));o.push(i)}return o}(n),o=wy(0,0),r=Fp({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:n}},components:[o],behaviours:Ja([Sg.config({})])});return{type:"widget",data:{value:Xi("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Cb.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:xy(e).concat(r.asSpec()),behaviours:Ja([kg("insert-table-picker",[Ri((function(t){Sg.set(r.get(t),[o])})),Ai(vy,(function(t,n,o){var i=o.event,u=i.row,a=i.col;!function(t,n,e,o,r){for(var i=0;i<10;i++)for(var u=0;u<10;u++)Ng.set(t[i][u],i<=n&&u<=e)}(e,u,a),Sg.set(r.get(t),[wy(u+1,a+1)])})),Ai(by,(function(n,e,o){var r=o.event,i=r.row,u=r.col;t.onAction({numRows:i+1,numColumns:u+1}),bi(n,ni())}))]),hg.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(t,n){var e=function(t,n){var e=t.initData.allowCustomColors&&n.colorinput.hasCustomColors();return t.initData.colors.fold((function(){return cy(n.colorinput.getColors(),e)}),(function(t){return t.concat(uy(e))}))}(t,n),o=n.colorinput.getColorCols(),r="color",i=gy(Xi("menu-value"),e,(function(n){t.onAction({value:n})}),o,r,Oh.CLOSE_ON_EXECUTE,S,n.shared.providers),u=O(O({},i),{markers:zh(r),movement:hy(o,r)});return{type:"widget",data:{value:Xi("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Cb.widget(rp.sketch(u))]}}},ky=function(t){var n=t.text.fold((function(){return{}}),(function(t){return{innerHtml:t}}));return{type:"separator",dom:O({tag:"div",classes:[Th,"tox-collection__group-heading"]},n),components:[]}};!function(t){t[t.ContentFocus=0]="ContentFocus",t[t.UiFocus=1]="UiFocus"}(Pv||(Pv={}));var Cy=function(t,n,e,o,r){var i,u=e.shared.providers,a=function(t){return r?O(O({},t),{shortcut:I.none(),icon:t.text.isSome()?I.none():t.icon}):t};switch(t.type){case"menuitem":return(i=t,Fo("menuitem",sv,i)).fold(qh,(function(t){return I.some(function(t,n,e,o){void 0===o&&(o=!0);var r=xb({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:I.none(),ariaLabel:t.text,caret:I.none(),checkMark:I.none(),shortcutContent:t.shortcut},e,o);return sb({data:fb(t),getApi:function(t){return{isDisabled:function(){return dd.isDisabled(t)},setDisabled:function(n){return dd.set(t,n)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e)}(a(t),n,u,o))}));case"nestedmenuitem":return function(t){return Fo("nestedmenuitem",fv,t)}(t).fold(qh,(function(t){return I.some(function(t,n,e,o,r){void 0===o&&(o=!0),void 0===r&&(r=!1);var i,u=r?(i=e.icons,mb("chevron-down",i,[Dh])):function(t){return mb("chevron-right",t,[Dh])}(e.icons),a=xb({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:I.none(),ariaLabel:t.text,caret:I.some(u),checkMark:I.none(),shortcutContent:t.shortcut},e,o);return sb({data:fb(t),getApi:function(t){return{isDisabled:function(){return dd.isDisabled(t)},setDisabled:function(n){return dd.set(t,n)}}},disabled:t.disabled,onAction:g,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},a,n,e)}(a(t),n,u,o,r))}));case"togglemenuitem":return function(t){return Fo("togglemenuitem",lv,t)}(t).fold(qh,(function(t){return I.some(function(t,n,e,o){void 0===o&&(o=!0);var r=xb({iconContent:t.icon,textContent:t.text,htmlContent:I.none(),ariaLabel:t.text,checkMark:I.some(bb(e.icons)),caret:I.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o);return no(sb({data:fb(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){Ng.set(t,n)},isActive:function(){return Ng.isOn(t)},isDisabled:function(){return dd.isDisabled(t)},setDisabled:function(n){return dd.set(t,n)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e),{toggling:{toggleClass:Bh,toggleOnExecute:!1,selected:t.active}})}(a(t),n,u,o))}));case"separator":return function(t){return Fo("separatormenuitem",ah,t)}(t).fold(qh,(function(t){return I.some(ky(t))}));case"fancymenuitem":return function(t){return Fo("fancymenuitem",cv,t)}(t).fold(qh,(function(t){return function(t,n){return bt(Sy,t.fancytype).map((function(e){return e(t,n)}))}(a(t),e)}));default:return console.error("Unknown item in general menu",t),I.none()}},Oy=function(t,n,e,o,r,i,u){var a=1===o,c=!a||Xh(t);return St(U(t,(function(t){switch(t.type){case"separator":return(o=t,Fo("Autocompleter.Separator",ah,o)).fold(qh,(function(t){return I.some(ky(t))}));case"cardmenuitem":return function(t){return Fo("cardmenuitem",ov,t)}(t).fold(qh,(function(t){return I.some(function(t,n,e,o){var r={dom:yb(t.label),optComponents:[I.some({dom:{tag:"div",classes:[Ih,Rh]},components:kb(t.items,o)})]};return sb({data:fb(O({text:I.none()},t)),disabled:t.disabled,getApi:function(t){return{isDisabled:function(){return dd.isDisabled(t)},setDisabled:function(n){dd.set(t,n),j(_s(t.element,"*"),(function(e){t.getSystem().getByDom(e).each((function(t){t.hasConfigured(dd)&&dd.set(t,n)}))}))}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:I.from(o.itemBehaviours).getOr([])},r,n,e.providers)}(O(O({},t),{onAction:function(n){t.onAction(n),e(t.value,t.meta)}}),r,i,{itemBehaviours:wb(t.meta,i),cardText:{matchText:n,highlightOn:u}}))}));default:return function(t){return Fo("Autocompleter.Item",ch,t)}(t).fold(qh,(function(t){return I.some(function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=xb({presets:o,textContent:I.none(),htmlContent:e?t.text.map((function(t){return Sb(t,n)})):I.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:I.none(),checkMark:I.none(),caret:I.none(),value:t.value},u.providers,a,t.icon);return sb({data:fb(t),disabled:t.disabled,getApi:h({}),onAction:function(n){return r(t.value,t.meta)},onSetup:h(g),triggersSubmenu:!1,itemBehaviours:wb(t.meta,u)},c,i,u.providers)}(t,n,a,"normal",e,r,i,c))}))}var o})))},_y=function(t,n,e,o,r){var i=Xh(n),u=St(U(n,(function(t){var n=function(t){return Cy(t,e,o,function(t){return r?!yt(t,"text"):i}(t),r)};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(O(O({},t),{disabled:!0})):n(t)})));return(r?Yh:Kh)(t,i,u,1,"normal")},Ty=function(t){return fp.singleData(t.value,t)},Ey=function(t,n){var e=Ec(),o=dr(!1),r=Iu(lp.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:Ja([kg("dismissAutocompleter",[Ti(fi(),(function(){return a()}))])]),lazySink:n.getSink})),i=function(){return e.get().isSome()},u=function(){i()&&lp.hide(r)},a=function(){if(i()){var n=e.get().map((function(t){return t.element}));$p(n.getOr(Rt(t.selection.getNode()))).each(Ae),u(),e.clear(),o.set(!1)}},c=Ut((function(){return function(t){var n=t.ui.registry.getAll().popups,e=mt(n,(function(t){return(n=t,Fo("Autocompleter",sh,n)).fold((function(t){throw new Error(Vo(t))}),v);var n})),o=function(t){var n={};return j(t,(function(t){n[t]={}})),ft(n)}(pt(e,(function(t){return t.ch}))),r=vt(e);return{dataset:e,triggerChars:o,lookupByChar:function(t){return X(r,(function(n){return n.ch===t}))}}}(t)})),s=function(f){(function(n){return e.get().map((function(e){return nh(t.dom,t.selection.getRng(),e.triggerChar).bind((function(e){return uh(t,c,e,n)}))})).getOrThunk((function(){return function(t,n){var e=n(),o=t.selection.getRng();return function(t,n,e){return st(e.triggerChars,(function(e){return nh(t,n,e)}))}(t.dom,o,e).bind((function(e){return uh(t,n,e)}))}(t,c)}))})(f).fold(a,(function(c){!function(n){if(!i()){var r=Jp(t,n.range);e.set({triggerChar:n.triggerChar,element:r,matchLength:n.text.length}),o.set(!1)}}(c.context),c.lookupData.then((function(i){e.get().map((function(e){var f,l,d,m=c.context;if(e.triggerChar===m.triggerChar){var g=(f=m.triggerChar,d=st(l=i,(function(t){return I.from(t.columns)})).getOr(1),Q(l,(function(e){var r=e.items;return Oy(r,e.matchText,(function(n,r){var i=t.selection.getRng();nh(t.dom,i,f).fold((function(){return console.error("Lost context. Cursor probably moved")}),(function(t){var i=t.range,c={hide:function(){a()},reload:function(t){u(),s(t)}};o.set(!0),e.onAction(c,i,n,r),o.set(!1)}))}),d,Oh.BUBBLE_TO_SANDBOX,n,e.highlightOn)})));g.length>0?function(n,e,o,i){n.matchLength=e.text.length;var u=st(o,(function(t){return I.from(t.columns)})).getOr(1);lp.showAt(r,rp.sketch(function(t,n,e,o){var r=e===Pv.ContentFocus?jd():Ud(),i=hy(n,o),u=zh(o);return{dom:t.dom,components:t.components,items:t.items,value:t.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:e===Pv.ContentFocus,focusManager:r,menuBehaviours:mv("auto"!==n?[]:[Ri((function(t,n){dv(t,4,u.item).each((function(n){var e=n.numColumns,o=n.numRows;hg.setGridSize(t,o,e)}))}))])}}(Kh("autocompleter-value",!0,i,u,"normal"),u,Pv.ContentFocus,"normal")),{anchor:{type:"node",root:Rt(t.getBody()),node:I.from(n.element)}}),lp.getContent(r).each(Sd.highlightFirst)}(e,m,i,g):m.text.length-e.matchLength>=10?a():u()}}))}))}))},f={onKeypress:qp((function(t){27!==t.which&&s()}),50),cancelIfNecessary:a,isMenuOpen:function(){return lp.isOpen(r)},isActive:i,isProcessingAction:o.get,getView:function(){return lp.getContent(r)}};!1===t.hasPlugin("rtc")&&function(t,n){n.on("keypress compositionend",t.onKeypress.throttle),n.on("remove",t.onKeypress.cancel);var e=function(t,n){yi(t,Vr(),{raw:n})};n.on("keydown",(function(n){var o=function(){return t.getView().bind(Sd.getHighlighted)};8===n.which&&t.onKeypress.throttle(n),t.isActive()&&(27===n.which&&t.cancelIfNecessary(),t.isMenuOpen()?13===n.which?(o().each(xi),n.preventDefault()):40===n.which?(o().fold((function(){t.getView().each(Sd.highlightFirst)}),(function(t){e(t,n)})),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||o().each((function(t){e(t,n),n.preventDefault(),n.stopImmediatePropagation()})):13!==n.which&&38!==n.which&&40!==n.which||t.cancelIfNecessary())})),n.on("NodeChange",(function(n){t.isActive()&&!t.isProcessingAction()&&$p(Rt(n.element)).isNone()&&t.cancelIfNecessary()}))}(f,t)},By=function(t,n,e){return ju(t,n,e).isSome()},My=function(t,n){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},schedule:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];e=setTimeout((function(){t.apply(null,o),e=null}),n)}}},Ay=function(t){var n=t.raw;return void 0===n.touches||1!==n.touches.length?I.none():I.some(n.touches[0])},Dy=function(){return yn().browser.isFirefox()},Fy=function(t,n){var e=O({stopBackspace:!0},n),o=function(t){var n=Ec(),e=dr(!1),o=My((function(n){t.triggerEvent(ti(),n),e.set(!0)}),400),r=vr([{key:Or(),value:function(t){return Ay(t).each((function(r){o.cancel();var i={x:r.clientX,y:r.clientY,target:t.target};o.schedule(t),e.set(!1),n.set(i)})),I.none()}},{key:_r(),value:function(t){return o.cancel(),Ay(t).each((function(t){n.on((function(e){(function(t,n){var e=Math.abs(t.clientX-n.x),o=Math.abs(t.clientY-n.y);return e>5||o>5})(t,e)&&n.clear()}))})),I.none()}},{key:Tr(),value:function(r){return o.cancel(),n.get().filter((function(t){return Sn(t.target,r.target)})).map((function(n){return e.get()?(r.prevent(),!1):t.triggerEvent(Zr(),r)}))}}]);return{fireIfReady:function(t,n){return bt(r,n).bind((function(n){return n(t)}))}}}(e),r=U(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(n){return Mc(t,n,(function(t){o.fireIfReady(t,n).each((function(n){n&&t.kill()})),e.triggerEvent(n,t)&&t.kill()}))})),i=Ec(),u=Mc(t,"paste",(function(t){o.fireIfReady(t,"paste").each((function(n){n&&t.kill()})),e.triggerEvent("paste",t)&&t.kill(),i.set(setTimeout((function(){e.triggerEvent(Kr(),t)}),0))})),a=Mc(t,"keydown",(function(t){e.triggerEvent("keydown",t)?t.kill():e.stopBackspace&&function(t){return t.raw.which===kd[0]&&!z(["input","textarea"],Pt(t.target))&&!By(t.target,'[contenteditable="true"]')}(t)&&t.prevent()})),c=function(t,n){return Dy()?Ac(t,"focus",n):Mc(t,"focusin",n)}(t,(function(t){e.triggerEvent("focusin",t)&&t.kill()})),s=Ec(),f=function(t,n){return Dy()?Ac(t,"blur",n):Mc(t,"focusout",n)}(t,(function(t){e.triggerEvent("focusout",t)&&t.kill(),s.set(setTimeout((function(){e.triggerEvent(Yr(),t)}),0))}));return{unbind:function(){j(r,(function(t){t.unbind()})),a.unbind(),c.unbind(),f.unbind(),u.unbind(),i.on(clearTimeout),s.on(clearTimeout)}}},Iy=function(t,n){var e=bt(t,"target").getOr(n);return dr(e)},Ry=mr([{stopped:[]},{resume:["element"]},{complete:[]}]),Vy=function(t,n,e,o,r,i){var u=t(n,o),a=function(t,n){var e=dr(!1),o=dr(!1);return{stop:function(){e.set(!0)},cut:function(){o.set(!0)},isStopped:e.get,isCut:o.get,event:t,setSource:n.set,getSource:n.get}}(e,r);return u.fold((function(){return i.logEventNoHandlers(n,o),Ry.complete()}),(function(t){var e=t.descHandler;return du(e)(a),a.isStopped()?(i.logEventStopped(n,t.element,e.purpose),Ry.stopped()):a.isCut()?(i.logEventCut(n,t.element,e.purpose),Ry.complete()):En(t.element).fold((function(){return i.logNoParent(n,t.element,e.purpose),Ry.complete()}),(function(o){return i.logEventResponse(n,t.element,e.purpose),Ry.resume(o)}))}))},Py=function(t,n,e,o,r,i){return Vy(t,n,e,o,r,i).fold(k,(function(o){return Py(t,n,e,o,r,i)}),S)},Hy=function(t,n,e,o,r){var i=Iy(e,o);return Py(t,n,e,o,i,r)},zy=function(){var t,n=(t={},{registerId:function(n,e,o){dt(o,(function(o,r){var i=void 0!==t[r]?t[r]:{};i[e]=function(t,n){return{cHandler:y.apply(void 0,[t.handler].concat(n)),purpose:t.purpose}}(o,n),t[r]=i}))},unregisterId:function(n){dt(t,(function(t,e){yt(t,n)&&delete t[n]}))},filterByType:function(n){return bt(t,n).map((function(t){return pt(t,(function(t,n){return function(t,n){return{id:t,descHandler:n}}(n,t)}))})).getOr([])},find:function(n,e,o){return bt(t,e).bind((function(t){return xr(o,(function(n){return function(t,n){return Qi(n).bind((function(n){return bt(t,n)})).map((function(t){return function(t,n){return{element:t,descHandler:n}}(n,t)}))}(t,n)}),n)}))}}),e={},o=function(t){Qi(t.element).each((function(t){delete e[t],n.unregisterId(t)}))};return{find:function(t,e,o){return n.find(t,e,o)},filter:function(t){return n.filterByType(t)},register:function(t){var r=function(t){var n=t.element;return Qi(n).getOrThunk((function(){return function(t,n){var e=Xi(Ki+"uid-");return $i(n,e),e}(0,t.element)}))}(t);xt(e,r)&&function(t,n){var r=e[n];if(r!==t)throw new Error('The tagId "'+n+'" is already used by: '+Wi(r.element)+"\nCannot use it for: "+Wi(t.element)+"\nThe conflicting element is"+(Ln(r.element)?" ":" not ")+"already in the DOM");o(t)}(t,r);var i=[t];n.registerId(i,r,t.events),e[r]=t},unregister:o,getById:function(t){return bt(e,t)}}},Ny=ql({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,o=_(n,["attributes"]);return{uid:t.uid,dom:O({tag:"div",attributes:O({role:"presentation"},e)},o),components:t.components,behaviours:qf(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[or("components",[]),Xf("containerBehaviours",[]),or("events",{}),or("domModification",{}),or("eventOrder",{})]}),Ly=function(t){var n=function(n){return En(t.element).fold(k,(function(t){return Sn(n,t)}))},e=zy(),o=function(t,o){return e.find(n,t,o)},r=Fy(t.element,{triggerEvent:function(t,n){return Ku(t,n.target,(function(e){return function(t,n,e,o){return Hy(t,n,e,e.target,o)}(o,t,n,e)}))}}),i={debugInfo:h("real"),triggerEvent:function(t,n,e){Ku(t,n,(function(r){return Hy(o,t,e,n,r)}))},triggerFocus:function(t,n){Qi(t).fold((function(){ic(t)}),(function(e){Ku(qr(),t,(function(e){return function(t,n,e,o,r){var i=Iy(e,o);Vy(t,n,e,o,i,r)}(o,qr(),{originator:n,kill:g,prevent:g,target:t},t,e),!1}))}))},triggerEscape:function(t,n){i.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return p(t)},getByDom:function(t){return v(t)},build:Iu,addToGui:function(t){c(t)},removeFromGui:function(t){s(t)},addToWorld:function(t){u(t)},removeFromWorld:function(t){a(t)},broadcast:function(t){l(t)},broadcastOn:function(t,n){d(t,n)},broadcastEvent:function(t,n){m(t,n)},isConnected:k},u=function(t){t.connect(i),Nt(t.element)||(e.register(t),j(t.components(),u),i.triggerEvent(oi(),t.element,{target:t.element}))},a=function(t){Nt(t.element)||(j(t.components(),a),e.unregister(t)),t.disconnect()},c=function(n){af(t,n)},s=function(t){ff(t)},f=function(t){var n=e.filter(Jr());j(n,(function(n){var e=n.descHandler;du(e)(t)}))},l=function(t){f({universal:!0,data:t})},d=function(t,n){f({universal:!1,channels:t,data:n})},m=function(t,n){return function(t,n,e){var o=function(t){var n=dr(!1);return{stop:function(){n.set(!0)},cut:g,isStopped:n.get,isCut:S,event:t,setSource:w("Cannot set source of a broadcasted event"),getSource:w("Cannot get source of a broadcasted event")}}(n);return j(t,(function(t){var n=t.descHandler;du(n)(o)})),o.isStopped()}(e.filter(t),n)},p=function(t){return e.getById(t).fold((function(){return Ge.error(new Error('Could not find component with uid: "'+t+'" in system.'))}),Ge.value)},v=function(t){var n=Qi(t).getOr("not found");return p(n)};return u(t),{root:t,element:t.element,destroy:function(){r.unbind(),Me(t.element)},add:c,remove:s,getByUid:p,getByDom:v,addToWorld:u,removeFromWorld:a,broadcast:l,broadcastOn:d,broadcastEvent:m}},Wy=h([or("prefix","form-field"),Xf("fieldBehaviours",[Ql,Gf])]),Uy=h([wl({schema:[Lo("dom")],name:"label"}),wl({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Lo("text")],name:"aria-descriptor"}),yl({factory:{sketch:function(t){var n=function(t,n){var e={};return dt(t,(function(t,o){z(n,o)||(e[o]=t)})),e}(t,["factory"]);return t.factory.sketch(n)}},schema:[Lo("factory")],name:"field"})]),jy=Yl({name:"FormField",configFields:Wy(),partFields:Uy(),factory:function(t,n,e,o){var r=Yf(t.fieldBehaviours,[Ql.config({find:function(n){return Fl(n,t,"field")}}),Gf.config({store:{mode:"manual",getValue:function(t){return Ql.getCurrent(t).bind(Gf.getValue)},setValue:function(t,n){Ql.getCurrent(t).each((function(t){Gf.setValue(t,n)}))}}})]),i=Ci([Ri((function(n,e){var o=Rl(n,t,["label","field","aria-descriptor"]);o.field().each((function(n){var e=Xi(t.prefix);o.label().each((function(t){Gn(t.element,"for",e),Gn(n.element,"id",e)})),o["aria-descriptor"]().each((function(e){var o=Xi(t.prefix);Gn(e.element,"id",o),Gn(n.element,"aria-describedby",o)}))}))}))]),u={getField:function(n){return Fl(n,t,"field")},getLabel:function(n){return Fl(n,t,"label")}};return{uid:t.uid,dom:t.dom,components:n,behaviours:r,events:i,apis:u}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),Gy=Object.freeze({__proto__:null,exhibit:function(t,n){return lu({attributes:vr([{key:n.tabAttr,value:"true"}])})}}),Xy=[or("tabAttr","data-alloy-tabstop")],qy=Qa({fields:Xy,name:"tabstopping",active:Gy}),Yy=tinymce.util.Tools.resolve("tinymce.html.Entities"),Ky=function(t,n,e,o){var r=Jy(t,n,e,o);return jy.sketch(r)},Jy=function(t,n,e,o){return{dom:$y(e),components:t.toArray().concat([n]),fieldBehaviours:Ja(o)}},$y=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},Qy=function(t,n){return jy.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},Zy=Xi("form-component-change"),tx=Xi("form-close"),nx=Xi("form-cancel"),ex=Xi("form-action"),ox=Xi("form-submit"),rx=Xi("form-block"),ix=Xi("form-unblock"),ux=Xi("form-tabchange"),ax=Xi("form-resize"),cx=h([Jo("data"),or("inputAttributes",{}),or("inputStyles",{}),or("tag","input"),or("inputClasses",[]),ra("onSetValue"),or("styles",{}),or("eventOrder",{}),Xf("inputBehaviours",[Gf,Eg]),or("selectOnFocus",!0)]),sx=function(t){return Ja([Eg.config({onFocus:t.selectOnFocus?function(t){var n=t.element,e=_u(n);n.dom.setSelectionRange(0,e.length)}:g})])},fx=function(t){return O(O({},sx(t)),Yf(t.inputBehaviours,[Gf.config({store:O(O({mode:"manual"},t.data.map((function(t){return{initialValue:t}})).getOr({})),{getValue:function(t){return _u(t.element)},setValue:function(t,n){_u(t.element)!==n&&Tu(t.element,n)}}),onSetValue:t.onSetValue})]))},lx=function(t){return{tag:t.tag,attributes:O({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},dx=ql({name:"Input",configFields:cx(),factory:function(t,n){return{uid:t.uid,dom:lx(t),components:[],behaviours:fx(t),eventOrder:t.eventOrder}}}),mx={},gx={exports:mx};!function(t,n,e,o){!function(t,o){"object"==typeof n&&void 0!==e?e.exports=o():(t="undefined"!=typeof globalThis?globalThis:t||self).EphoxContactWrapper=o()}(this,(function(){var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n={exports:{}};!function(n){!function(t){var e=setTimeout;function o(){}function r(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(t,this)}function i(t,n){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,r._immediateFn((function(){var e=1===t._state?n.onFulfilled:n.onRejected;if(null!==e){var o;try{o=e(t._value)}catch(t){return void a(n.promise,t)}u(n.promise,o)}else(1===t._state?u:a)(n.promise,t._value)}))):t._deferreds.push(n)}function u(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if(n instanceof r)return t._state=3,t._value=n,void c(t);if("function"==typeof e)return void f((o=e,i=n,function(){o.apply(i,arguments)}),t)}t._state=1,t._value=n,c(t)}catch(n){a(t,n)}var o,i}function a(t,n){t._state=2,t._value=n,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&r._immediateFn((function(){t._handled||r._unhandledRejectionFn(t._value)}));for(var n=0,e=t._deferreds.length;n<e;n++)i(t,t._deferreds[n]);t._deferreds=null}function s(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function f(t,n){var e=!1;try{t((function(t){e||(e=!0,u(n,t))}),(function(t){e||(e=!0,a(n,t))}))}catch(t){if(e)return;e=!0,a(n,t)}}r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,n){var e=new this.constructor(o);return i(this,new s(t,n,e)),e},r.all=function(t){var n=Array.prototype.slice.call(t);return new r((function(t,e){if(0===n.length)return t([]);var o=n.length;function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,(function(t){r(i,t)}),e)}n[i]=u,0==--o&&t(n)}catch(t){e(t)}}for(var i=0;i<n.length;i++)r(i,n[i])}))},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r((function(n){n(t)}))},r.reject=function(t){return new r((function(n,e){e(t)}))},r.race=function(t){return new r((function(n,e){for(var o=0,r=t.length;o<r;o++)t[o].then(n,e)}))},r._immediateFn="function"==typeof setImmediate?function(t){setImmediate(t)}:function(t){e(t,0)},r._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},r._setImmediateFn=function(t){r._immediateFn=t},r._setUnhandledRejectionFn=function(t){r._unhandledRejectionFn=t},n.exports?n.exports=r:t.Promise||(t.Promise=r)}(t)}(n);var e=n.exports;return{boltExport:("undefined"!=typeof window?window:Function("return this;")()).Promise||e}}))}(0,mx,gx);var px,hx=gx.exports.boltExport,vx=function(t){var n=I.none(),e=[],o=function(t){r()?i(t):e.push(t)},r=function(){return n.isSome()},i=function(t){n.each((function(n){setTimeout((function(){t(n)}),0)}))};return t((function(t){r()||(n=I.some(t),j(e,i),e=[])})),{get:o,map:function(t){return vx((function(n){o((function(e){n(t(e))}))}))},isReady:r}},bx={nu:vx,pure:function(t){return vx((function(n){n(t)}))}},yx=function(t){setTimeout((function(){throw t}),0)},xx=function(t){var n=function(n){t().then(n,yx)};return{map:function(n){return xx((function(){return t().then(n)}))},bind:function(n){return xx((function(){return t().then((function(t){return n(t).toPromise()}))}))},anonBind:function(n){return xx((function(){return t().then((function(){return n.toPromise()}))}))},toLazy:function(){return bx.nu(n)},toCached:function(){var n=null;return xx((function(){return null===n&&(n=t()),n}))},toPromise:t,get:n}},wx=function(t){return xx((function(){return new hx(t)}))},Sx=function(t){return xx((function(){return hx.resolve(t)}))},kx=["input","textarea"],Cx=function(t){var n=Pt(t);return z(kx,n)},Ox=function(t,n){var e=n.getRoot(t).getOr(t.element);Su(e,n.invalidClass),n.notify.each((function(n){Cx(t.element)&&Gn(t.element,"aria-invalid",!1),n.getContainer(t).each((function(t){Ni(t,n.validHtml)})),n.onValid(t)}))},_x=function(t,n,e,o){var r=n.getRoot(t).getOr(t.element);wu(r,n.invalidClass),n.notify.each((function(n){Cx(t.element)&&Gn(t.element,"aria-invalid",!0),n.getContainer(t).each((function(t){Ni(t,o)})),n.onInvalid(t,o)}))},Tx=function(t,n,e){return n.validator.fold((function(){return Sx(Ge.value(!0))}),(function(n){return n.validate(t)}))},Ex=function(t,n,e){return n.notify.each((function(n){n.onValidate(t)})),Tx(t,n).map((function(e){return t.getSystem().isConnected()?e.fold((function(e){return _x(t,n,0,e),Ge.error(e)}),(function(e){return Ox(t,n),Ge.value(e)})):Ge.error("No longer in system")}))},Bx=Object.freeze({__proto__:null,markValid:Ox,markInvalid:_x,query:Tx,run:Ex,isInvalid:function(t,n){var e=n.getRoot(t).getOr(t.element);return ku(e,n.invalidClass)}}),Mx=Object.freeze({__proto__:null,events:function(t,n){return t.validator.map((function(n){return Ci([Ti(n.onEvent,(function(n){Ex(n,t).get(v)}))].concat(n.validateOnLoad?[Ri((function(n){Ex(n,t).get(g)}))]:[]))})).getOr({})}}),Ax=[Lo("invalidClass"),or("getRoot",I.none),er("notify",[or("aria","alert"),or("getContainer",I.none),or("validHtml",""),ra("onValid"),ra("onInvalid"),ra("onValidate")]),er("validator",[Lo("validate"),or("onEvent","input"),or("validateOnLoad",!0)])],Dx=Qa({fields:Ax,name:"invalidating",active:Mx,apis:Bx,extra:{validation:function(t){return function(n){var e=Gf.getValue(n);return Sx(t(e))}}}}),Fx=Object.freeze({__proto__:null,getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),Ix=[Wo("others",Do(Ge.value,So()))],Rx=Object.freeze({__proto__:null,init:function(){var t={},n=h({});return su({readState:n,getOrCreate:function(n,e,o){var r=ft(e.others);if(r)return bt(t,o).getOrThunk((function(){var r=bt(e.others,o).getOrDie("No information found for coupled component: "+o)(n),i=n.getSystem().build(r);return t[o]=i,i}));throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))}})}}),Vx=Qa({fields:Ix,name:"coupling",apis:Fx,state:Rx}),Px=h("sink"),Hx=h(wl({name:Px(),overrides:h({dom:{tag:"div"},behaviours:Ja([nf.config({useFixed:k})]),events:Ci([Di(Vr()),Di(Br()),Di(Nr())])})}));!function(t){t[t.HighlightFirst=0]="HighlightFirst",t[t.HighlightNone=1]="HighlightNone"}(px||(px={}));var zx,Nx,Lx,Wx=function(t,n){var e=t.getHotspot(n).getOr(n),o="hotspot",r=t.getAnchorOverrides();return t.layouts.fold((function(){return{type:o,hotspot:e,overrides:r}}),(function(t){return{type:o,hotspot:e,overrides:r,layouts:t}}))},Ux=function(t,n,e,o,r,i,u){var a=function(t,n,e,o,r,i,u){var a=function(t,n,e){return(0,t.fetch)(e).map(n)}(t,n,o),c=Xx(o,t);return a.map((function(t){return t.bind((function(t){return I.from(fp.sketch(O(O({},i.menu()),{uid:Zi(""),data:t,highlightImmediately:u===px.HighlightFirst,onOpenMenu:function(t,n){var o=c().getOrDie();nf.position(o,n,{anchor:e}),Of.decloak(r)},onOpenSubmenu:function(t,n,e){var o=c().getOrDie();nf.position(o,e,{anchor:{type:"submenu",item:n}}),Of.decloak(r)},onRepositionMenu:function(t,n,o){var r=c().getOrDie();nf.position(r,n,{anchor:e}),j(o,(function(t){nf.position(r,t.triggeredMenu,{anchor:{type:"submenu",item:t.triggeringItem}})}))},onEscape:function(){return Eg.focus(o),Of.close(r),I.some(!0)}})))}))}))}(t,n,Wx(t,e),e,o,r,u);return a.map((function(t){return t.fold((function(){Of.isOpen(o)&&Of.close(o)}),(function(t){Of.cloak(o),Of.open(o,t),i(o)})),o}))},jx=function(t,n,e,o,r,i,u){return Of.close(o),Sx(o)},Gx=function(t,n,e,o,r,i){var u=Vx.getCoupled(e,"sandbox");return(Of.isOpen(u)?jx:Ux)(t,n,e,u,o,r,i)},Xx=function(t,n){return t.getSystem().getByUid(n.uid+"-"+Px()).map((function(t){return function(){return Ge.value(t)}})).getOrThunk((function(){return n.lazySink.fold((function(){return function(){return Ge.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(n){return function(){return n(t)}}))}))},qx=function(t){Of.getState(t).each((function(t){fp.repositionMenus(t)}))},Yx=function(t,n,e){var o=Gu(),r=Xx(n,t);return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:Jf(t.sandboxBehaviours,[Gf.config({store:{mode:"memory",initialValue:n}}),Of.config({onOpen:function(r,i){var u=Wx(t,n);o.link(n.element),t.matchWidth&&function(t,n,e){var o=Ql.getCurrent(n).getOr(n),r=ye(t.element);e?Zn(o.element,"min-width",r+"px"):function(t,n){be.set(t,n)}(o.element,r)}(u.hotspot,i,t.useMinWidth),t.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},onClose:function(t,r){o.unlink(n.element),void 0!==e&&void 0!==e.onClose&&e.onClose(t,r)},isPartOf:function(t,e,o){return Xu(e,o)||Xu(n,o)},getAttachPoint:function(){return r().getOrDie()}}),Ql.config({find:function(t){return Of.getState(t).bind((function(t){return Ql.getCurrent(t)}))}}),ec.config({channels:O(O({},Mf({isExtraPart:S})),Df({doReposition:qx}))})])}},Kx=function(t){var n=Vx.getCoupled(t,"sandbox");qx(n)},Jx=function(){return[or("sandboxClasses",[]),Kf("sandboxBehaviours",[Ql,ec,Of,Gf])]},$x=h([Lo("dom"),Lo("fetch"),ra("onOpen"),ia("onExecute"),or("getHotspot",I.some),or("getAnchorOverrides",h({})),Kc(),Xf("dropdownBehaviours",[Ng,Vx,hg,Eg]),Lo("toggleClass"),or("eventOrder",{}),Jo("lazySink"),or("matchWidth",!1),or("useMinWidth",!1),Jo("role")].concat(Jx())),Qx=h([xl({schema:[na()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),Hx()]),Zx=Yl({name:"Dropdown",configFields:$x(),partFields:Qx(),factory:function(t,n,e,o){var r,i=function(t){Of.getState(t).each((function(t){fp.highlightPrimary(t)}))},u={expand:function(n){Ng.isOn(n)||Gx(t,v,n,o,g,px.HighlightNone).get(g)},open:function(n){Ng.isOn(n)||Gx(t,v,n,o,g,px.HighlightFirst).get(g)},isOpen:Ng.isOn,close:function(n){Ng.isOn(n)&&Gx(t,v,n,o,g,px.HighlightFirst).get(g)},repositionMenus:function(t){Ng.isOn(t)&&Kx(t)}},a=function(t,n){return xi(t),I.some(!0)};return{uid:t.uid,dom:t.dom,components:n,behaviours:Yf(t.dropdownBehaviours,[Ng.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),Vx.config({others:{sandbox:function(n){return Yx(t,n,{onOpen:function(){return Ng.on(n)},onClose:function(){return Ng.off(n)}})}}}),hg.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t,n){if(Zx.isOpen(t)){var e=Vx.getCoupled(t,"sandbox");i(e)}else Zx.open(t);return I.some(!0)},onEscape:function(t,n){return Zx.isOpen(t)?(Zx.close(t),I.some(!0)):I.none()}}),Eg.config({})]),events:Wg(I.some((function(n){Gx(t,v,n,o,i,px.HighlightFirst).get(g)}))),eventOrder:O(O({},t.eventOrder),(r={},r[$r()]=["disabling","toggling","alloy.base.behaviour"],r)),apis:u,domModification:{attributes:O(O({"aria-haspopup":"true"},t.role.fold((function(){return{}}),(function(t){return{role:t}}))),"button"===t.dom.tag?{type:("type",bt(t.dom,"attributes").bind((function(t){return bt(t,"type")}))).getOr("button")}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),tw=Object.freeze({__proto__:null,events:function(){return Ci([Oi(jr(),k)])},exhibit:function(){return lu({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}}),nw=Qa({fields:[],name:"unselecting",active:tw}),ew=Xi("color-input-change"),ow=Xi("color-swatch-change"),rw=Xi("color-picker-cancel"),iw=wl({schema:[Lo("dom")],name:"label"}),uw=function(t){return wl({name:t+"-edge",overrides:function(n){return n.model.manager.edgeActions[t].fold((function(){return{}}),(function(t){return{events:Ci([Ei(Or(),(function(n,e,o){return t(n,o)}),[n]),Ei(Br(),(function(n,e,o){return t(n,o)}),[n]),Ei(Mr(),(function(n,e,o){o.mouseIsDown.get()&&t(n,o)}),[n])])}}))}})},aw=uw("top-left"),cw=uw("top"),sw=uw("top-right"),fw=uw("right"),lw=uw("bottom-right"),dw=uw("bottom"),mw=uw("bottom-left"),gw=uw("left"),pw=yl({name:"thumb",defaults:h({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:Ci([Mi(Or(),t,"spectrum"),Mi(_r(),t,"spectrum"),Mi(Tr(),t,"spectrum"),Mi(Br(),t,"spectrum"),Mi(Mr(),t,"spectrum"),Mi(Dr(),t,"spectrum")])}}}),hw=yl({schema:[zo("mouseIsDown",(function(){return dr(!1)}))],name:"spectrum",overrides:function(t){var n=t.model.manager,e=function(e,o){return n.getValueFromEvent(o).map((function(o){return n.setValueFrom(e,t,o)}))};return{behaviours:Ja([hg.config({mode:"special",onLeft:function(e){return n.onLeft(e,t)},onRight:function(e){return n.onRight(e,t)},onUp:function(e){return n.onUp(e,t)},onDown:function(e){return n.onDown(e,t)}}),Eg.config({})]),events:Ci([Ti(Or(),e),Ti(_r(),e),Ti(Br(),e),Ti(Mr(),(function(n,o){t.mouseIsDown.get()&&e(n,o)}))])}}}),vw=[iw,gw,fw,cw,dw,aw,sw,mw,lw,pw,hw],bw=h("slider.change.value"),yw=function(t){var n=t.event.raw;if(function(t){return-1!==t.type.indexOf("touch")}(n)){var e=n;return void 0!==e.touches&&1===e.touches.length?I.some(e.touches[0]).map((function(t){return ge(t.clientX,t.clientY)})):I.none()}var o=n;return void 0!==o.clientX?I.some(o).map((function(t){return ge(t.clientX,t.clientY)})):I.none()},xw=function(t){return t.model.minX},ww=function(t){return t.model.minY},Sw=function(t){return t.model.minX-1},kw=function(t){return t.model.minY-1},Cw=function(t){return t.model.maxX},Ow=function(t){return t.model.maxY},_w=function(t){return t.model.maxX+1},Tw=function(t){return t.model.maxY+1},Ew=function(t,n,e){return n(t)-e(t)},Bw=function(t){return Ew(t,Cw,xw)},Mw=function(t){return Ew(t,Ow,ww)},Aw=function(t){return Bw(t)/2},Dw=function(t){return Mw(t)/2},Fw=function(t){return t.stepSize},Iw=function(t){return t.snapToGrid},Rw=function(t){return t.snapStart},Vw=function(t){return t.rounded},Pw=function(t,n){return void 0!==t[n+"-edge"]},Hw=function(t){return Pw(t,"left")},zw=function(t){return Pw(t,"right")},Nw=function(t){return Pw(t,"top")},Lw=function(t){return Pw(t,"bottom")},Ww=function(t){return t.model.value.get()},Uw=function(t){return{x:t}},jw=function(t){return{y:t}},Gw=function(t,n){return{x:t,y:n}},Xw=function(t,n){yi(t,bw(),{value:n})},qw=function(t,n,e,o){return t<n?t:t>e?e:t===n?n-1:Math.max(n,t-o)},Yw=function(t,n,e,o){return t>e?t:t<n?n:t===e?e+1:Math.min(e,t+o)},Kw=function(t,n,e){return Math.max(n,Math.min(e,t))},Jw=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,f=t.hasMaxEdge,l=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=f?e+1:e;if(r<l)return g;if(r>d)return p;var h=function(t,n,e){return Math.min(e,Math.max(t,n))-n}(r,l,d),v=Kw(h/m*o+n,g,p);return u&&v>=n&&v<=e?function(t,n,e,o,r){return r.fold((function(){var r=t-n,i=Math.round(r/o)*o;return Kw(n+i,n-1,e+1)}),(function(n){var r=(t-n)%o,i=Math.round(r/o),u=Math.floor((t-n)/o),a=Math.floor((e-n)/o),c=n+Math.min(a,u+i)*o;return Math.max(n,c)}))}(v,n,e,i,a):c?Math.round(v):v},$w=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,f=t.centerMaxEdge;return r<n?i?0:s:r>e?u?a:f:(r-n)/o*c},Qw="top",Zw="right",tS="bottom",nS="left",eS=function(t){return t.element.dom.getBoundingClientRect()},oS=function(t,n){return t[n]},rS=function(t){var n=eS(t);return oS(n,nS)},iS=function(t){var n=eS(t);return oS(n,Zw)},uS=function(t){var n=eS(t);return oS(n,Qw)},aS=function(t){var n=eS(t);return oS(n,tS)},cS=function(t){var n=eS(t);return oS(n,"width")},sS=function(t){var n=eS(t);return oS(n,"height")},fS=function(t,n,e){return(t+n)/2-e},lS=function(t,n){var e=eS(t),o=eS(n),r=oS(e,nS),i=oS(e,Zw),u=oS(o,nS);return fS(r,i,u)},dS=function(t,n){var e=eS(t),o=eS(n),r=oS(e,Qw),i=oS(e,tS),u=oS(o,Qw);return fS(r,i,u)},mS=function(t,n){yi(t,bw(),{value:n})},gS=function(t){return{x:t}},pS=function(t,n,e){var o={min:xw(n),max:Cw(n),range:Bw(n),value:e,step:Fw(n),snap:Iw(n),snapStart:Rw(n),rounded:Vw(n),hasMinEdge:Hw(n),hasMaxEdge:zw(n),minBound:rS(t),maxBound:iS(t),screenRange:cS(t)};return Jw(o)},hS=function(t){return function(n,e){return function(t,n,e){var o=(t>0?Yw:qw)(Ww(e).x,xw(e),Cw(e),Fw(e));return mS(n,gS(o)),I.some(o)}(t,n,e).map(k)}},vS=function(t,n,e,o,r,i){var u=function(t,n,e,o,r){var i=cS(t),u=o.bind((function(n){return I.some(lS(n,t))})).getOr(0),a=r.bind((function(n){return I.some(lS(n,t))})).getOr(i),c={min:xw(n),max:Cw(n),range:Bw(n),value:e,hasMinEdge:Hw(n),hasMaxEdge:zw(n),minBound:rS(t),minOffset:0,maxBound:iS(t),maxOffset:i,centerMinEdge:u,centerMaxEdge:a};return $w(c)}(n,i,e,o,r);return rS(n)-rS(t)+u},bS=hS(-1),yS=hS(1),xS=I.none,wS=I.none,SS={"top-left":I.none(),top:I.none(),"top-right":I.none(),right:I.some((function(t,n){Xw(t,Uw(_w(n)))})),"bottom-right":I.none(),bottom:I.none(),"bottom-left":I.none(),left:I.some((function(t,n){Xw(t,Uw(Sw(n)))}))},kS=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=pS(t,n,e),r=gS(o);return mS(t,r),o},setToMin:function(t,n){var e=xw(n);mS(t,gS(e))},setToMax:function(t,n){var e=Cw(n);mS(t,gS(e))},findValueOfOffset:pS,getValueFromEvent:function(t){return yw(t).map((function(t){return t.left}))},findPositionOfValue:vS,setPositionFromValue:function(t,n,e,o){var r=Ww(e),i=vS(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=ye(n.element)/2;Zn(n.element,"left",i-u+"px")},onLeft:bS,onRight:yS,onUp:xS,onDown:wS,edgeActions:SS}),CS=function(t,n){yi(t,bw(),{value:n})},OS=function(t){return{y:t}},_S=function(t,n,e){var o={min:ww(n),max:Ow(n),range:Mw(n),value:e,step:Fw(n),snap:Iw(n),snapStart:Rw(n),rounded:Vw(n),hasMinEdge:Nw(n),hasMaxEdge:Lw(n),minBound:uS(t),maxBound:aS(t),screenRange:sS(t)};return Jw(o)},TS=function(t){return function(n,e){return function(t,n,e){var o=(t>0?Yw:qw)(Ww(e).y,ww(e),Ow(e),Fw(e));return CS(n,OS(o)),I.some(o)}(t,n,e).map(k)}},ES=function(t,n,e,o,r,i){var u=function(t,n,e,o,r){var i=sS(t),u=o.bind((function(n){return I.some(dS(n,t))})).getOr(0),a=r.bind((function(n){return I.some(dS(n,t))})).getOr(i),c={min:ww(n),max:Ow(n),range:Mw(n),value:e,hasMinEdge:Nw(n),hasMaxEdge:Lw(n),minBound:uS(t),minOffset:0,maxBound:aS(t),maxOffset:i,centerMinEdge:u,centerMaxEdge:a};return $w(c)}(n,i,e,o,r);return uS(n)-uS(t)+u},BS=I.none,MS=I.none,AS=TS(-1),DS=TS(1),FS={"top-left":I.none(),top:I.some((function(t,n){Xw(t,jw(kw(n)))})),"top-right":I.none(),right:I.none(),"bottom-right":I.none(),bottom:I.some((function(t,n){Xw(t,jw(Tw(n)))})),"bottom-left":I.none(),left:I.none()},IS=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=_S(t,n,e),r=OS(o);return CS(t,r),o},setToMin:function(t,n){var e=ww(n);CS(t,OS(e))},setToMax:function(t,n){var e=Ow(n);CS(t,OS(e))},findValueOfOffset:_S,getValueFromEvent:function(t){return yw(t).map((function(t){return t.top}))},findPositionOfValue:ES,setPositionFromValue:function(t,n,e,o){var r=Ww(e),i=ES(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),u=le(n.element)/2;Zn(n.element,"top",i-u+"px")},onLeft:BS,onRight:MS,onUp:AS,onDown:DS,edgeActions:FS}),RS=function(t,n){yi(t,bw(),{value:n})},VS=function(t,n){return{x:t,y:n}},PS=function(t,n){return function(e,o){return function(t,n,e,o){var r=t>0?Yw:qw,i=n?Ww(o).x:r(Ww(o).x,xw(o),Cw(o),Fw(o)),u=n?r(Ww(o).y,ww(o),Ow(o),Fw(o)):Ww(o).y;return RS(e,VS(i,u)),I.some(i)}(t,n,e,o).map(k)}},HS=PS(-1,!1),zS=PS(1,!1),NS=PS(-1,!0),LS=PS(1,!0),WS={"top-left":I.some((function(t,n){Xw(t,Gw(Sw(n),kw(n)))})),top:I.some((function(t,n){Xw(t,Gw(Aw(n),kw(n)))})),"top-right":I.some((function(t,n){Xw(t,Gw(_w(n),kw(n)))})),right:I.some((function(t,n){Xw(t,Gw(_w(n),Dw(n)))})),"bottom-right":I.some((function(t,n){Xw(t,Gw(_w(n),Tw(n)))})),bottom:I.some((function(t,n){Xw(t,Gw(Aw(n),Tw(n)))})),"bottom-left":I.some((function(t,n){Xw(t,Gw(Sw(n),Tw(n)))})),left:I.some((function(t,n){Xw(t,Gw(Sw(n),Dw(n)))}))},US=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=pS(t,n,e.left),r=_S(t,n,e.top),i=VS(o,r);return RS(t,i),i},setToMin:function(t,n){var e=xw(n),o=ww(n);RS(t,VS(e,o))},setToMax:function(t,n){var e=Cw(n),o=Ow(n);RS(t,VS(e,o))},getValueFromEvent:function(t){return yw(t)},setPositionFromValue:function(t,n,e,o){var r=Ww(e),i=vS(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=ES(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),a=ye(n.element)/2,c=le(n.element)/2;Zn(n.element,"left",i-a+"px"),Zn(n.element,"top",u-c+"px")},onLeft:HS,onRight:zS,onUp:NS,onDown:LS,edgeActions:WS}),jS=Yl({name:"Slider",configFields:[or("stepSize",1),or("onChange",g),or("onChoose",g),or("onInit",g),or("onDragStart",g),or("onDragEnd",g),or("snapToGrid",!1),or("rounded",!0),Jo("snapStart"),Wo("model",Po("mode",{x:[or("minX",0),or("maxX",100),zo("value",(function(t){return dr(t.mode.minX)})),Lo("getInitialValue"),ca("manager",kS)],y:[or("minY",0),or("maxY",100),zo("value",(function(t){return dr(t.mode.minY)})),Lo("getInitialValue"),ca("manager",IS)],xy:[or("minX",0),or("maxX",100),or("minY",0),or("maxY",100),zo("value",(function(t){return dr({x:t.mode.minX,y:t.mode.minY})})),Lo("getInitialValue"),ca("manager",US)]})),Xf("sliderBehaviours",[hg,Gf]),zo("mouseIsDown",(function(){return dr(!1)}))],partFields:vw,factory:function(t,n,e,o){var r,i=function(n){return Il(n,t,"thumb")},u=function(n){return Il(n,t,"spectrum")},a=function(n){return Fl(n,t,"left-edge")},c=function(n){return Fl(n,t,"right-edge")},s=function(n){return Fl(n,t,"top-edge")},f=function(n){return Fl(n,t,"bottom-edge")},l=t.model,d=l.manager,m=function(n,e){d.setPositionFromValue(n,e,t,{getLeftEdge:a,getRightEdge:c,getTopEdge:s,getBottomEdge:f,getSpectrum:u})},g=function(t,n){l.value.set(n);var e=i(t);m(t,e)},p=function(n){var e=t.mouseIsDown.get();t.mouseIsDown.set(!1),e&&Fl(n,t,"thumb").each((function(e){var o=l.value.get();t.onChoose(n,e,o)}))},h=function(n,e){e.stop(),t.mouseIsDown.set(!0),t.onDragStart(n,i(n))},v=function(n,e){e.stop(),t.onDragEnd(n,i(n)),p(n)};return{uid:t.uid,dom:t.dom,components:n,behaviours:Yf(t.sliderBehaviours,[hg.config({mode:"special",focusIn:function(n){return Fl(n,t,"spectrum").map(hg.focusIn).map(k)}}),Gf.config({store:{mode:"manual",getValue:function(t){return l.value.get()}}}),ec.config({channels:(r={},r[Ef()]={onReceive:p},r)})]),events:Ci([Ti(bw(),(function(n,e){!function(n,e){g(n,e);var o=i(n);t.onChange(n,o,e),I.some(!0)}(n,e.event.value)})),Ri((function(n,e){var o=l.getInitialValue();l.value.set(o);var r=i(n);m(n,r);var a=u(n);t.onInit(n,r,a,l.value.get())})),Ti(Or(),h),Ti(Tr(),v),Ti(Br(),h),Ti(Dr(),v)]),apis:{resetToMin:function(n){d.setToMin(n,t)},resetToMax:function(n){d.setToMax(n,t)},setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(t,n,e){t.setValue(n,e)},resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),GS=Xi("rgb-hex-update"),XS=Xi("slider-update"),qS=Xi("palette-update"),YS="form",KS=[Xf("formBehaviours",[Gf])],JS=function(t){return"<alloy.field."+t+">"},$S=function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:Yf(t.formBehaviours,[Gf.config({store:{mode:"manual",getValue:function(n){var e=Vl(n,t);return mt(e,(function(t,n){return t().bind((function(t){var e,o;return e=Ql.getCurrent(t),o=new Error("Cannot find a current component to extract the value from for form part '"+n+"': "+Wi(t.element)),e.fold((function(){return Ge.error(o)}),Ge.value)})).map(Gf.getValue)}))},setValue:function(n,e){dt(e,(function(e,o){Fl(n,t,o).each((function(t){Ql.getCurrent(t).each((function(t){Gf.setValue(t,e)}))}))}))}}})]),apis:{getField:function(n,e){return Fl(n,t,e).bind(Ql.getCurrent)}}}},QS={getField:au((function(t,n,e){return t.getField(n,e)})),sketch:function(t){var n=function(){var t=[];return{field:function(n,e){return t.push(n),El(YS,JS(n),e)},record:h(t)}}(),e=t(n),o=n.record(),r=U(o,(function(t){return yl({name:t,pname:JS(t)})}));return Ul(YS,KS,r,$S,e)}},ZS=Xi("valid-input"),tk=Xi("invalid-input"),nk=Xi("validating-input"),ek="colorcustom.rgb.",ok=function(t,n,e,o){var r=function(e,o){return Dx.config({invalidClass:n("invalid"),notify:{onValidate:function(t){yi(t,nk,{type:e})},onValid:function(t){yi(t,ZS,{type:e,value:Gf.getValue(t)})},onInvalid:function(t){yi(t,tk,{type:e,value:Gf.getValue(t)})}},validator:{validate:function(n){var e=Gf.getValue(n),r=o(e)?Ge.value(!0):Ge.error(t("aria.input.invalid"));return Sx(r)},validateOnLoad:!1}})},i=function(e,o,i,u,a){var c=t("colorcustom.rgb.range"),s=jy.parts.label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":u}}}),f=jy.parts.field({data:a,factory:dx,inputAttributes:O({type:"text"},"hex"===o?{"aria-live":"polite"}:{}),inputClasses:[n("textfield")],inputBehaviours:Ja([r(o,e),qy.config({})]),onSetValue:function(t){Dx.isInvalid(t)&&Dx.run(t).get(g)}}),l=[s,f],d="hex"!==o?[jy.parts["aria-descriptor"]({text:c})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:l.concat(d)}},u=function(t,n){var e=n.red,o=n.green,r=n.blue;Gf.setValue(t,{red:e,green:o,blue:r})},a=Fp({dom:{tag:"div",classes:[n("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),c=function(t,n){a.getOpt(t).each((function(t){Zn(t.element,"background-color","#"+n.value)}))},s=ql({factory:function(){var r={red:dr(I.some(255)),green:dr(I.some(255)),blue:dr(I.some(255)),hex:dr(I.some("ffffff"))},s=function(t){return r[t].get()},f=function(t,n){r[t].set(n)},l=function(t){var n=t.red,e=t.green,o=t.blue;f("red",I.some(n)),f("green",I.some(e)),f("blue",I.some(o))},d=function(t,n){var e=n.event;"hex"!==e.type?f(e.type,I.none()):o(t)},m=function(t,n){var o=n.event;!function(t){return"hex"===t.type}(o)?function(t,n,e){var o=parseInt(e,10);f(n,I.some(o)),s("red").bind((function(t){return s("green").bind((function(n){return s("blue").map((function(e){return Pb(t,n,e,1)}))}))})).each((function(n){var e=function(t,n){var e=Ab(n);return QS.getField(t,"hex").each((function(n){Eg.isFocused(n)||Gf.setValue(t,{hex:e.value})})),e}(t,n);yi(t,GS,{hex:e}),c(t,e)}))}(t,o.type,o.value):function(t,n){e(t);var o=Ob(n);f("hex",I.some(n));var r=Nb(o);u(t,r),l(r),yi(t,GS,{hex:o}),c(t,o)}(t,o.value)},g=function(n){return{label:t(ek+n+".label"),description:t(ek+n+".description")}},p=g("red"),h=g("green"),v=g("blue"),b=g("hex");return no(QS.sketch((function(e){return{dom:{tag:"form",classes:[n("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[e.field("red",jy.sketch(i(Hb,"red",p.label,p.description,255))),e.field("green",jy.sketch(i(Hb,"green",h.label,h.description,255))),e.field("blue",jy.sketch(i(Hb,"blue",v.label,v.description,255))),e.field("hex",jy.sketch(i(Eb,"hex",b.label,b.description,"ffffff"))),a.asSpec()],formBehaviours:Ja([Dx.config({invalidClass:n("form-invalid")}),kg("rgb-form-events",[Ti(ZS,m),Ti(tk,d),Ti(nk,d)])])}})),{apis:{updateHex:function(t,n){Gf.setValue(t,{hex:n.value}),function(t,n){var e=Nb(n);u(t,e),l(e)}(t,n),c(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}});return s},rk=function(t,n){var e=ql({name:"ColourPicker",configFields:[Lo("dom"),or("onValidHex",g),or("onInvalidHex",g)],factory:function(e){var o,r=ok(t,n,e.onValidHex,e.onInvalidHex),i=function(t,n){var e=jS.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),o=jS.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:"<div class="+n("sv-palette-inner-thumb")+' role="presentation"></div>'}}),r=function(t,n){var e=t.width,o=t.height,r=t.getContext("2d");if(null!==r){r.fillStyle=n,r.fillRect(0,0,e,o);var i=r.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=i,r.fillRect(0,0,e,o);var u=r.createLinearGradient(0,0,0,o);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=u,r.fillRect(0,0,e,o)}};return ql({factory:function(t){var i=h({x:0,y:0}),u=Ja([Ql.config({find:I.some}),Eg.config({})]);return jS.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:i},rounded:!1,components:[e,o],onChange:function(t,n,e){yi(t,qS,{value:e})},onInit:function(t,n,e,o){r(e.element.dom,Ub(jb))},sliderBehaviours:u})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:function(t,n,e){!function(t,n){var e=t.components()[0].element.dom,o=Xb(n,100,100),i=zb(o);r(e,Ub(i))}(n,e)},setThumb:function(t,n,e){!function(t,n){var e=qb(Nb(n));jS.setValue(t,{x:e.saturation,y:100-e.value})}(n,e)}},extraApis:{}})}(0,n),u=function(t){return 100-t/360*100},a={paletteRgba:dr(jb),paletteHue:dr(0)},c=Fp(function(t,n){var e=jS.parts.spectrum({dom:{tag:"div",classes:[n("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=jS.parts.thumb({dom:{tag:"div",classes:[n("hue-slider-thumb")],attributes:{role:"presentation"}}});return jS.sketch({dom:{tag:"div",classes:[n("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:h({y:0})},components:[e,o],sliderBehaviours:Ja([Eg.config({})]),onChange:function(t,n,e){yi(t,XS,{value:e})}})}(0,n)),s=Fp(i.sketch({})),f=Fp(r.sketch({})),l=function(t,n,e){s.getOpt(t).each((function(t){i.setHue(t,e)}))},d=function(t,n){f.getOpt(t).each((function(t){r.updateHex(t,n)}))},m=function(t,n,e,o){!function(t,n){var e=Nb(t);a.paletteRgba.set(e),a.paletteHue.set(n)}(n,e),j(o,(function(o){o(t,n,e)}))};return{uid:e.uid,dom:e.dom,components:[s.asSpec(),c.asSpec(),f.asSpec()],behaviours:Ja([kg("colour-picker-events",[Ti(GS,(o=[l,function(t,n,e){c.getOpt(t).each((function(t){jS.setValue(t,{y:u(e)})}))},function(t,n){s.getOpt(t).each((function(t){i.setThumb(t,n)}))}],function(t,n){var e=n.event.hex,r=function(t){return qb(Nb(t))}(e);m(t,e,r.hue,o)})),Ti(qS,function(){var t=[d];return function(n,e){var o=e.event.value,r=a.paletteHue.get(),i=Xb(r,o.x,100-o.y),u=Yb(i);m(n,u,r,t)}}()),Ti(XS,function(){var t=[l,d];return function(n,e){var o=function(t){return(100-t)/100*360}(e.event.value.y),r=a.paletteRgba.get(),i=qb(r),u=Xb(o,i.saturation,i.value),c=Yb(u);m(n,c,o,t)}}())]),Ql.config({find:function(t){return f.getOpt(t)}}),hg.config({mode:"acyclic"})])}}});return e},ik=function(){return Ql.config({find:I.some})},uk=function(t){return Ql.config({find:function(n){return An(n.element,t).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))}})},ak={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},ck=function(t){return function(t){return ak[t]}(t)},sk=tinymce.util.Tools.resolve("tinymce.Resource"),fk=tinymce.util.Tools.resolve("tinymce.util.Tools"),lk=vo([or("preprocess",v),or("postprocess",v)]),dk=function(t,n,e){return Gf.config(no({store:{mode:"manual",getValue:n,setValue:e}},t.map((function(t){return{store:{initialValue:t}}})).getOr({})))},mk=function(t,n){var e=Ro("RepresentingConfigs.memento processors",lk,n);return Gf.config({store:{mode:"manual",getValue:function(n){var o=t.get(n),r=Gf.getValue(o);return e.postprocess(r)},setValue:function(n,o){var r=e.preprocess(o),i=t.get(n);Gf.setValue(i,r)}}})},gk=dk,pk=function(t){return n=zi,e=Ni,dk(t,(function(t){return n(t.element)}),(function(t,n){return e(t.element,n)}));var n,e},hk=function(t){return Gf.config({store:{mode:"memory",initialValue:t}})},vk=Xi("alloy-fake-before-tabstop"),bk=Xi("alloy-fake-after-tabstop"),yk=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:Ja([Eg.config({ignore:!0}),qy.config({})])}},xk=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[yk([vk]),t,yk([bk])],behaviours:Ja([uk(1)])}},wk=function(t,n){yi(t,Vr(),{raw:{which:9,shiftKey:n}})},Sk=function(t,n){var e=n.element;ku(e,vk)?wk(t,!0):ku(e,bk)&&wk(t,!1)},kk=function(t){return By(t,["."+vk,"."+bk].join(","),S)},Ck=!(yn().browser.isIE()||yn().browser.isEdge()),Ok=function(t,n){return Ek(document.createElement("canvas"),t,n)},_k=function(t){var n=Ok(t.width,t.height);return Tk(n).drawImage(t,0,0),n},Tk=function(t){return t.getContext("2d")},Ek=function(t,n,e){return t.width=n,t.height=e,t},Bk=function(t){return t.naturalWidth||t.width},Mk=function(t){return t.naturalHeight||t.height},Ak=function(t,n,e){return n=n||"image/png",l(HTMLCanvasElement.prototype.toBlob)?new hx((function(o,r){t.toBlob((function(t){t?o(t):r()}),n,e)})):(o=t.toDataURL(n,e),new hx((function(t,n){(function(t){var n=t.split(","),e=/data:([^;]+)/.exec(n[0]);if(!e)return I.none();for(var o=e[1],r=n[1],i=1024,u=atob(r),a=u.length,c=Math.ceil(a/i),s=new Array(c),f=0;f<c;++f){for(var l=f*i,d=Math.min(l+i,a),m=new Array(d-l),g=l,p=0;g<d;++p,++g)m[p]=u[g].charCodeAt(0);s[f]=new Uint8Array(m)}return I.some(new Blob(s,{type:o}))})(o).fold((function(){n("uri is not base64: "+o)}),t)})));var o},Dk=function(t){URL.revokeObjectURL(t.src)},Fk=function(t,n,e){var o=n.type,r=h(o),i=h(e),u=function(n,e){return t.then((function(t){return function(t,n,e){return n=n||"image/png",t.toDataURL(n,e)}(t,n,e)}))};return{getType:r,toBlob:function(){return hx.resolve(n)},toDataURL:i,toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(n,e){return t.then((function(t){return Ak(t,n,e)}))},toAdjustedDataURL:u,toAdjustedBase64:function(t,n){return u(t,n).then((function(t){return t.split(",")[1]}))},toCanvas:function(){return t.then(_k)}}},Ik=function(t){return function(t){return new hx((function(n){var e=new FileReader;e.onloadend=function(){n(e.result)},e.readAsDataURL(t)}))}(t).then((function(n){return Fk(function(t){return function(t){return new hx((function(n,e){var o=URL.createObjectURL(t),r=new Image,i=function(){r.removeEventListener("load",u),r.removeEventListener("error",a)},u=function(){i(),n(r)},a=function(){i(),e("Unable to load data of type "+t.type+": "+o)};r.addEventListener("load",u),r.addEventListener("error",a),r.src=o,r.complete&&setTimeout(u,0)}))}(t).then((function(t){Dk(t);var n=Ok(Bk(t),Mk(t));return Tk(n).drawImage(t,0,0),n}))}(t),t,n)}))},Rk=function(t,n){return Ak(t,n).then((function(n){return Fk(hx.resolve(t),n,t.toDataURL())}))},Vk=function(t,n,e){var o="string"==typeof t?parseFloat(t):t;return o>e?o=e:o<n&&(o=n),o},Pk=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],Hk=function(t,n){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i];for(u=0;u<5;u++){e=0;for(var a=0;a<5;a++)e+=t[u+5*a]*o[a];r[u+5*i]=e}}return r},zk=function(t,n){return t.toCanvas().then((function(e){return Nk(e,t.getType(),n)}))},Nk=function(t,n,e){var o=Tk(t),r=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],f=n[3],l=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*f+l,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return t}(o.getImageData(0,0,t.width,t.height),e);return o.putImageData(r,0,0),Rk(t,n)},Lk=function(t){return function(n,e){return zk(n,t([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],e))}},Wk=function(t){return function(n){return zk(n,t)}}([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),Uk=Lk((function(t,n){return n=Vk(255*n,-255,255),Hk(t,[1,0,0,0,n,0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])})),jk=Lk((function(t,n){var e;return n=Vk(n,-1,1),e=(n*=100)<0?127+n/100*127:127*(e=0==(e=n%1)?Pk[n]:Pk[Math.floor(n)]*(1-e)+Pk[Math.floor(n)+1]*e)+127,Hk(t,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])})),Gk=(zx=[0,-1,0,-1,5,-1,0,-1,0],function(t){return function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){var o=Tk(t),r=o.getImageData(0,0,t.width,t.height),i=o.getImageData(0,0,t.width,t.height);return i=function(t,n,e){for(var o=function(t,n,e){return t>e?t=e:t<n&&(t=n),t},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,f=0;f<s;f++)for(var l=0;l<c;l++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(l+h-i,0,c-1),b=4*(o(f+p-i,0,s-1)*c+v),y=e[p*r+h];d+=u[b]*y,m+=u[b+1]*y,g+=u[b+2]*y}var x=4*(f*c+l);a[x]=o(d,0,255),a[x+1]=o(m,0,255),a[x+2]=o(g,0,255)}return n}(r,i,e),o.putImageData(i,0,0),Rk(t,n)}(e,t.getType(),n)}))}(t,zx)}),Xk=(Nx=function(t,n){return 255*Math.pow(t/255,1-n)},function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){for(var o=Tk(t),r=new Array(256),i=0;i<r.length;i++)r[i]=Nx(i,e);var u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t}(o.getImageData(0,0,t.width,t.height),r);return o.putImageData(u,0,0),Rk(t,n)}(e,t.getType(),n)}))}),qk=function(t,n,e){var o=Bk(t),r=Mk(t),i=n/o,u=e/r,a=!1;(i<.5||i>2)&&(i=i<.5?.5:2,a=!0),(u<.5||u>2)&&(u=u<.5?.5:2,a=!0);var c=Yk(t,i,u);return a?c.then((function(t){return qk(t,n,e)})):c},Yk=function(t,n,e){return new hx((function(o){var r=Bk(t),i=Mk(t),u=Math.floor(r*n),a=Math.floor(i*e),c=Ok(u,a);Tk(c).drawImage(t,0,0,r,i,0,0,u,a),o(c)}))},Kk=function(t,n){void 0===n&&(n=2);var e=Math.pow(10,n),o=Math.round(t*e);return Math.ceil(o/e)},Jk=function(t){return Wk(t)},$k=function(t){return Gk(t)},Qk=function(t,n){return Xk(t,n)},Zk=function(t,n){return Uk(t,n)},tC=function(t,n){return jk(t,n)},nC=function(t,n){return function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){var o=Ok(t.width,t.height),r=Tk(o);return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),Rk(o,n)}(e,t.getType(),n)}))}(t,n)},eC=function(t,n,e,o,r){return function(t,n,e,o,r){return t.toCanvas().then((function(i){return function(t,n,e,o,r,i){var u=Ok(r,i);return Tk(u).drawImage(t,-e,-o),Rk(u,n)}(i,t.getType(),n,e,o,r)}))}(t,n,e,o,r)},oC=function(t,n){return function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){var o=(e<0?360+e:e)*Math.PI/180,r=t.width,i=t.height,u=Math.sin(o),a=Math.cos(o),c=Kk(Math.abs(r*a)+Math.abs(i*u)),s=Kk(Math.abs(r*u)+Math.abs(i*a)),f=Ok(c,s),l=Tk(f);return l.translate(c/2,s/2),l.rotate(o),l.drawImage(t,-r/2,-i/2),Rk(f,n)}(e,t.getType(),n)}))}(t,n)},rC=function(t,n,e){return Up(t,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:e},n)},iC=function(t,n){return rC(t,n,[])},uC=function(t,n){return rC(t,n,[Sg.config({})])},aC=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:Ja([Sg.config({})])}},cC=Xi("toolbar.button.execute"),sC=((Lx={})[$r()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],Lx),fC=Xi("update-menu-text"),lC=Xi("update-menu-icon"),dC=function(t,n,e){var o=dr(g),r=t.text.map((function(t){return Fp(aC(t,n,e.providers))})),i=t.icon.map((function(t){return Fp(uC(t,e.providers.icons))})),u=function(t,n){var e=Gf.getValue(t);return Eg.focus(e),yi(e,"keydown",{raw:n.event.raw}),Zx.close(e),I.some(!0)},a=t.role.fold((function(){return{}}),(function(t){return{role:t}})),c=t.tooltip.fold((function(){return{}}),(function(t){var n=e.providers.translate(t);return{title:n,"aria-label":n}})),s=Up("chevron-down",{tag:"div",classes:[n+"__select-chevron"]},e.providers.icons);return Fp(Zx.sketch(O(O(O({},t.uid?{uid:t.uid}:{}),a),{dom:{tag:"button",classes:[n,n+"--select"].concat(U(t.classes,(function(t){return n+"--"+t}))),attributes:O({},c)},components:cb([i.map((function(t){return t.asSpec()})),r.map((function(t){return t.asSpec()})),I.some(s)]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:Ja(T(T([],t.dropdownBehaviours,!0),[tb((function(){return t.disabled||e.providers.isDisabled()})),Zv(),nw.config({}),Sg.config({}),kg("dropdown-events",[rb(t,o),ib(t,o)]),kg("menubutton-update-display-text",[Ti(fC,(function(t,n){r.bind((function(n){return n.getOpt(t)})).each((function(t){Sg.set(t,[Au(e.providers.translate(n.event.text))])}))})),Ti(lC,(function(t,n){i.bind((function(n){return n.getOpt(t)})).each((function(t){Sg.set(t,[uC(n.event.icon,e.providers.icons)])}))}))])],!1)),eventOrder:no(sC,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:Ja([hg.config({mode:"special",onLeft:u,onRight:u})]),lazySink:e.getSink,toggleClass:n+"--active",parts:{menu:Wh(0,t.columns,t.presets)},fetch:function(n){return wx(y(t.fetch,n))}}))).asSpec()},mC=function(t){return"separator"===t.type},gC={type:"separator"},pC=function(t,n){var e=function(t,n){var e=Y(t,(function(t,e){return function(t){return o(t)}(e)?""===e?t:"|"===e?t.length>0&&!mC(t[t.length-1])?t.concat([gC]):t:yt(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])}),[]);return e.length>0&&mC(e[e.length-1])&&e.pop(),e}(o(t)?t.split(" "):t,n);return q(e,(function(t,e){var o=function(t){if(mC(t))return t;var n=bt(t,"value").getOrThunk((function(){return Xi("generated-menu-item")}));return no({value:n},t)}(e),r=function(t,n){return function(t){return yt(t,"getSubmenuItems")}(t)?function(t,n){var e=t.getSubmenuItems(),o=pC(e,n);return{item:t,menus:no(o.menus,hr(t.value,o.items)),expansions:no(o.expansions,hr(t.value,t.value))}}(t,n):{item:t,menus:{},expansions:{}}}(o,n);return{menus:no(t.menus,r.menus),items:[r.item].concat(t.items),expansions:no(t.expansions,r.expansions)}}),{menus:{},expansions:{},items:[]})},hC=function(t,n,e,o){var r=Xi("primary-menu"),i=pC(t,e.shared.providers.menuItems());if(0===i.items.length)return I.none();var u=_y(r,i.items,n,e,o),a=mt(i.menus,(function(t,o){return _y(o,t,n,e,!1)})),c=no(a,hr(r,u));return I.from(fp.tieredData(r,c,i.expansions))},vC=function(t){return{isDisabled:function(){return dd.isDisabled(t)},setDisabled:function(n){return dd.set(t,n)},setActive:function(n){var e=t.element;n?(wu(e,"tox-tbtn--enabled"),Gn(e,"aria-pressed",!0)):(Su(e,"tox-tbtn--enabled"),Jn(e,"aria-pressed"))},isActive:function(){return ku(t.element,"tox-tbtn--enabled")}}},bC=function(t,n,e,o){return dC({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n,o){t.fetch((function(t){o(hC(t,Oh.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:t.onSetup,getApi:vC,columns:1,presets:"normal",classes:[],dropdownBehaviours:[qy.config({})]},n,e.shared)},yC=function(t,n,e){var o=function(t){return function(o){var r=!o.isActive();o.setActive(r),t.storage.set(r),e.shared.getSink().each((function(e){n().getOpt(e).each((function(n){ic(n.element),yi(n,ex,{name:t.name,value:t.storage.get()})}))}))}},r=function(t){return function(n){n.setActive(t.storage.get())}};return function(n){n(U(t,(function(t){var n=t.text.fold((function(){return{}}),(function(t){return{text:t}}));return O(O({type:t.type,active:!1},n),{onAction:o(t),onSetup:r(t)})})))}},xC=function(t,n,e,o,r,i){void 0===e&&(e=[]);var u=n.fold((function(){return{}}),(function(t){return{action:t}})),a=O({buttonBehaviours:Ja([tb((function(){return t.disabled||i.isDisabled()})),Zv(),qy.config({}),kg("button press",[_i("click"),_i("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=no(a,{dom:o});return no(c,{components:r})},wC=function(t,n,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map((function(t){return{"aria-label":e.translate(t),title:e.translate(t)}})).getOr({})},i=t.icon.map((function(t){return iC(t,e.icons)})),u=cb([i]);return xC(t,n,o,r,u,e)},SC=function(t,n,e,o){void 0===o&&(o=[]);var r=wC(t,I.some(n),e,o);return Dp.sketch(r)},kC=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(t.text),u=t.icon?t.icon.map((function(t){return iC(t,e.icons)})):I.none(),a=u.isSome()?cb([u]):[],c=u.isSome()?{}:{innerHtml:i},s=T(T(T(T([],t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],!0),u.isSome()?["tox-button--icon"]:[],!0),t.borderless?["tox-button--naked"]:[],!0),r,!0),f=O(O({tag:"button",classes:s},c),{attributes:{title:i}});return xC(t,n,o,f,a,e)},CC=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=kC(t,I.some(n),e,o,r);return Dp.sketch(i)},OC=function(t,n){return function(e){"custom"===n?yi(e,ex,{name:t,value:{}}):"submit"===n?bi(e,ox):"cancel"===n?bi(e,nx):console.error("Unknown button type: ",n)}},_C=function(t,n,e){if(function(t,n){return"menu"===n}(0,n)){var o=t,r=O(O({},t),{onSetup:function(n){return n.setDisabled(t.disabled),g},fetch:yC(o.items,(function(){return i}),e)}),i=Fp(bC(r,"tox-tbtn",e,I.none()));return i.asSpec()}if(function(t,n){return"custom"===n||"cancel"===n||"submit"===n}(0,n)){var u=OC(t.name,n),a=O(O({},t),{borderless:!1});return CC(a,u,e.shared.providers,[])}console.error("Unknown footer button type: ",n)},TC=h([or("field1Name","field1"),or("field2Name","field2"),ua("onLockedChange"),ea(["lockClass"]),or("locked",!1),Kf("coupledFieldBehaviours",[Ql,Gf])]),EC=function(t,n){return yl({factory:jy,name:t,overrides:function(t){return{fieldBehaviours:Ja([kg("coupled-input-behaviour",[Ti(Hr(),(function(e){(function(t,n,e){return Fl(t,n,e).bind(Ql.getCurrent)})(e,t,n).each((function(n){Fl(e,t,"lock").each((function(o){Ng.isOn(o)&&t.onLockedChange(e,n,o)}))}))}))])])}}})},BC=h([EC("field1","field2"),EC("field2","field1"),yl({factory:Dp,schema:[Lo("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:Ja([Ng.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),MC=Yl({name:"FormCoupledInputs",configFields:TC(),partFields:BC(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:Jf(t.coupledFieldBehaviours,[Ql.config({find:I.some}),Gf.config({store:{mode:"manual",getValue:function(n){var e,o=Hl(n,t,["field1","field2"]);return(e={})[t.field1Name]=Gf.getValue(o.field1()),e[t.field2Name]=Gf.getValue(o.field2()),e},setValue:function(n,e){var o=Hl(n,t,["field1","field2"]);xt(e,t.field1Name)&&Gf.setValue(o.field1(),e[t.field1Name]),xt(e,t.field2Name)&&Gf.setValue(o.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return Fl(n,t,"field1")},getField2:function(n){return Fl(n,t,"field2")},getLock:function(n){return Fl(n,t,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),AC=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);if(null!==n){var e=parseFloat(n[1]),o=n[2];return Ge.value({value:e,unit:o})}return Ge.error(t)},DC=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(t){return yt(e,t)};return t.unit===n?I.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?I.some(t.value):I.some(t.value/e[t.unit]*e[n]):I.none()},FC=function(t){return I.none()},IC=function(t,n){var e=FC,o=Xi("ratio-event"),r=function(t){return Up(t,{tag:"span",classes:["tox-icon","tox-lock-icon__"+t]},n.icons)},i=MC.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[r("lock"),r("unlock")],buttonBehaviours:Ja([dd.config({disabled:function(){return t.disabled||n.isDisabled()}}),Zv(),qy.config({})])}),u=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},a=function(e){return jy.parts.field({factory:dx,inputClasses:["tox-textfield"],inputBehaviours:Ja([dd.config({disabled:function(){return t.disabled||n.isDisabled()}}),Zv(),qy.config({}),kg("size-input-events",[Ti(Ir(),(function(t,n){yi(t,o,{isField1:e})})),Ti(zr(),(function(n,e){yi(n,Zy,{name:t.name})}))])]),selectOnFocus:!1})},c=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},s=MC.parts.field1(u([jy.parts.label(c("Width")),a(!0)])),f=MC.parts.field2(u([jy.parts.label(c("Height")),a(!1)]));return MC.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[s,f,u([c("&nbsp;"),i])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n,o){AC(Gf.getValue(t)).each((function(t){e(t).each((function(t){Gf.setValue(n,function(t){var n,e={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},o=t.value.toFixed((n=t.unit)in e?e[n]:1);return-1!==o.indexOf(".")&&(o=o.replace(/\.?0*$/,"")),o+t.unit}(t))}))}))},coupledFieldBehaviours:Ja([dd.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){MC.getField1(t).bind(jy.getField).each(dd.disable),MC.getField2(t).bind(jy.getField).each(dd.disable),MC.getLock(t).each(dd.disable)},onEnabled:function(t){MC.getField1(t).bind(jy.getField).each(dd.enable),MC.getField2(t).bind(jy.getField).each(dd.enable),MC.getLock(t).each(dd.enable)}}),Zv(),kg("size-input-events2",[Ti(o,(function(t,n){var o,r,i,u=n.event.isField1,a=u?MC.getField1(t):MC.getField2(t),c=u?MC.getField2(t):MC.getField1(t),s=a.map(Gf.getValue).getOr(""),f=c.map(Gf.getValue).getOr("");o=f,r=AC(s).toOptional(),i=AC(o).toOptional(),e=kt(r,i,(function(t,n){return DC(t,n.unit).map((function(t){return n.value/t})).map((function(t){return function(t,n){return function(e){return DC(e,n).map((function(e){return{value:e*t,unit:n}}))}}(t,n.unit)})).getOr(FC)})).getOr(FC)}))])])})},RC={undo:h(Xi("undo")),redo:h(Xi("redo")),zoom:h(Xi("zoom")),back:h(Xi("back")),apply:h(Xi("apply")),swap:h(Xi("swap")),transform:h(Xi("transform")),tempTransform:h(Xi("temp-transform")),transformApply:h(Xi("transform-apply"))},VC=h("save-state"),PC=h("disable"),HC=h("enable"),zC={formActionEvent:ex,saveState:VC,disable:PC,enable:HC},NC=function(t,n){var e=function(t,e,o,r){return Fp(CC({name:t,text:t,disabled:o,primary:r,icon:I.none(),borderless:!1},e,n))},o=function(t,e,o,r){return Fp(SC({name:t,icon:I.some(t),tooltip:I.some(e),disabled:r,primary:!1,borderless:!1},o,n))},r=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(dd)&&dd.disable(e)}))},i=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(dd)&&dd.enable(e)}))},u={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},a=g,c=function(t,n,e){yi(t,n,e)},s=function(t){return bi(t,zC.disable())},f=function(t){return bi(t,zC.enable())},l=function(t,n){s(t),c(t,RC.transform(),{transform:n}),f(t)},d=function(t){return function(){tt.getOpt(t).each((function(t){Sg.set(t,[Q])}))}},m=function(t,n){s(t),c(t,RC.transformApply(),{transform:n,swap:d(t)}),f(t)},p=function(){return e("Back",(function(t){return c(t,RC.back(),{swap:d(t)})}),!1,!1)},v=function(){return Fp({dom:{tag:"div",classes:["tox-spacer"]},behaviours:Ja([dd.config({})])})},b=function(){return e("Apply",(function(t){return c(t,RC.apply(),{swap:d(t)})}),!0,!0)},y=[p(),v(),e("Apply",(function(n){m(n,(function(n){var e=t.getRect();return eC(n,e.x,e.y,e.w,e.h)})),t.hideCrop()}),!1,!0)],x=Ny.sketch({dom:u,components:y.map((function(t){return t.asSpec()})),containerBehaviours:Ja([kg("image-tools-crop-buttons-events",[Ti(zC.disable(),(function(t,n){r(y,t)})),Ti(zC.enable(),(function(t,n){i(y,t)}))])])}),w=Fp(IC({name:"size",label:I.none(),constrain:!0,disabled:!1},n)),S=[p(),v(),w,v(),e("Apply",(function(t){w.getOpt(t).each((function(n){var e,o,r=Gf.getValue(n),i=(e=parseInt(r.width,10),o=parseInt(r.height,10),function(t){return function(t,n,e){return function(t,n,e){return t.toCanvas().then((function(o){return qk(o,n,e).then((function(n){return Rk(n,t.getType())}))}))}(t,n,e)}(t,e,o)});m(t,i)}))}),!1,!0)],k=Ny.sketch({dom:u,components:S.map((function(t){return t.asSpec()})),containerBehaviours:Ja([kg("image-tools-resize-buttons-events",[Ti(zC.disable(),(function(t,n){r(S,t)})),Ti(zC.enable(),(function(t,n){i(S,t)}))])])}),C=function(t,n){return function(e){return t(e,n)}},O=C(nC,"h"),_=C(nC,"v"),T=C(oC,-90),E=C(oC,90),B=function(t,n){!function(t,n){s(t),c(t,RC.tempTransform(),{transform:n}),f(t)}(t,n)},M=[p(),v(),o("flip-horizontally","Flip horizontally",(function(t){B(t,O)}),!1),o("flip-vertically","Flip vertically",(function(t){B(t,_)}),!1),o("rotate-left","Rotate counterclockwise",(function(t){B(t,T)}),!1),o("rotate-right","Rotate clockwise",(function(t){B(t,E)}),!1),v(),b()],A=Ny.sketch({dom:u,components:M.map((function(t){return t.asSpec()})),containerBehaviours:Ja([kg("image-tools-fliprotate-buttons-events",[Ti(zC.disable(),(function(t,n){r(M,t)})),Ti(zC.enable(),(function(t,n){i(M,t)}))])])}),D=function(t,e,o,r,i){var u=jS.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}),a=jS.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),c=jS.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Fp(jS.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:o,maxX:i,getInitialValue:h({x:r})},components:[u,a,c],sliderBehaviours:Ja([Eg.config({})]),onChoose:e}))},F=function(t,n,e,o,r){return D(t,(function(t,e,o){var r=C(n,o.x/100);l(t,r)}),e,o,r)},R=function(t,n,e,o,a){var c=function(t,n,e,o,r){return[p(),F(t,n,e,o,r),b()]}(t,n,e,o,a);return Ny.sketch({dom:u,components:c.map((function(t){return t.asSpec()})),containerBehaviours:Ja([kg("image-tools-filter-panel-buttons-events",[Ti(zC.disable(),(function(t,n){r(c,t)})),Ti(zC.enable(),(function(t,n){i(c,t)}))])])})},V=[p(),v(),b()],P=Ny.sketch({dom:u,components:V.map((function(t){return t.asSpec()}))}),H=R("Brightness",Zk,-100,0,100),z=R("Contrast",tC,-100,0,100),N=R("Gamma",Qk,-100,0,100),L=function(t,n,e){return function(o){return function(t,n,e,o){return function(t,n,e,o){return zk(t,function(t,n,e,o){return n=Vk(n,0,2),e=Vk(e,0,2),o=Vk(o,0,2),Hk([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],[n,0,0,0,0,0,e,0,0,0,0,0,o,0,0,0,0,0,1,0,0,0,0,0,1])}(0,n,e,o))}(t,n,e,o)}(o,t,n,e)}},W=function(t){return D(t,(function(t,n,e){var o=U.getOpt(t),r=G.getOpt(t),i=j.getOpt(t);o.each((function(n){r.each((function(e){i.each((function(o){var r=Gf.getValue(n).x/100,i=Gf.getValue(o).x/100,u=Gf.getValue(e).x/100,a=L(r,i,u);l(t,a)}))}))}))}),0,100,200)},U=W("R"),j=W("G"),G=W("B"),X=[p(),U,j,G,b()],q=Ny.sketch({dom:u,components:X.map((function(t){return t.asSpec()}))}),Y=function(t,n,e){return function(o){c(o,RC.swap(),{transform:n,swap:function(){tt.getOpt(o).each((function(n){Sg.set(n,[t]),e(n)}))}})}},K=I.some($k),J=I.some(Jk),$=[o("crop","Crop",Y(x,I.none(),(function(n){t.showCrop()})),!1),o("resize","Resize",Y(k,I.none(),(function(n){w.getOpt(n).each((function(n){var e=t.getMeasurements(),o=e.width,r=e.height;Gf.setValue(n,{width:o,height:r})}))})),!1),o("orientation","Orientation",Y(A,I.none(),a),!1),o("brightness","Brightness",Y(H,I.none(),a),!1),o("sharpen","Sharpen",Y(P,K,a),!1),o("contrast","Contrast",Y(z,I.none(),a),!1),o("color-levels","Color levels",Y(q,I.none(),a),!1),o("gamma","Gamma",Y(N,I.none(),a),!1),o("invert","Invert",Y(P,J,a),!1)],Q=Ny.sketch({dom:u,components:$.map((function(t){return t.asSpec()}))}),Z=Ny.sketch({dom:{tag:"div"},components:[Q],containerBehaviours:Ja([Sg.config({})])}),tt=Fp(Z);return{memContainer:tt,getApplyButton:function(t){return tt.getOpt(t).map((function(t){var n=t.components()[0];return n.components()[n.components().length-1]}))}}},LC=tinymce.util.Tools.resolve("tinymce.geom.Rect"),WC=tinymce.util.Tools.resolve("tinymce.util.Observable"),UC=tinymce.util.Tools.resolve("tinymce.util.VK"),jC=function(t){if(function(t){return f(t.changedTouches)}(t))for(var n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]};var GC,XC,qC=0,YC=function(t,n,e,o,r){var i,u=[],a="tox-crid-"+qC++,c=Rt(o),s=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],l=["top","right","bottom","left"],d=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}},m=function(n,o,r,i){var u=o.x+r*n.deltaX,a=o.y+i*n.deltaY,c=Math.max(20,o.w+r*n.deltaW),s=Math.max(20,o.h+i*n.deltaH),f=t=LC.clamp({x:u,y:a,w:c,h:s},e,"move"===n.name);f=d(e,f),v.fire("updateRect",{rect:f}),h(f)},g=function(t){var e=function(t,n){Uu(c,"#"+a+"-"+t).each((function(t){te(t,{left:n.x+"px",top:n.y+"px",width:Math.max(0,n.w)+"px",height:Math.max(0,n.h)+"px"})}))};j(s,(function(n){Uu(c,"#"+a+"-"+n.name).each((function(e){te(e,{left:t.w*n.xMul+t.x+"px",top:t.h*n.yMul+t.y+"px"})}))})),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)},p=function(n){g(t=n)},h=function(t){var n,o;p((n=e,{x:(o=t).x+n.x,y:o.y+n.y,w:o.w,h:o.h}))};!function(){var n=Ft("div");Xn(n,{id:a,class:"tox-croprect-container",role:"grid","aria-dropeffect":"execute"}),Te(c,n),j(l,(function(t){Uu(c,"#"+a).each((function(n){var e=Ft("div");Xn(e,{id:a+"-"+t,class:"tox-croprect-block","data-mce-bogus":"all"}),Zn(e,"display","none"),Te(n,e)}))})),j(s,(function(t){Uu(c,"#"+a).each((function(n){var e=Ft("div");Xn(e,{id:a+"-"+t.name,"aria-label":t.label,"aria-grabbed":"false","data-mce-bogus":"all",role:"gridcell",tabindex:"-1",title:t.label}),Cu(e,["tox-croprect-handle","tox-croprect-handle-"+t.name]),Zn(e,"display","none"),Te(n,e)}))})),i=U(s,(function(n){var e;return function(t,n){var e,o,r,i,u,a,c,s=[],l=[],d=null!==(e=n.document)&&void 0!==e?e:document,m=null!==(o=n.root)&&void 0!==o?o:d,g=Rt(d),p=Rt(m.getElementById(null!==(r=n.handle)&&void 0!==r?r:t)),h=function(t){var e=t.raw,o=function(t){var n=Math.max,e=t.documentElement,o=t.body,r=n(e.scrollWidth,o.scrollWidth),i=n(e.clientWidth,o.clientWidth),u=n(e.offsetWidth,o.offsetWidth),a=n(e.scrollHeight,o.scrollHeight),c=n(e.clientHeight,o.clientHeight);return{width:r<u?i:r,height:a<n(e.offsetHeight,o.offsetHeight)?c:a}}(d);jC(e),t.prevent(),u=e.button,a=e.screenX,c=e.screenY;var r=ee(p,"cursor");i=Ft("div",d),te(i,{position:"absolute",top:"0",left:"0",width:o.width+"px",height:o.height+"px","z-index":"2147483647",opacity:"0.0001",cursor:r}),Te(Un(g),i),l.push(Mc(g,"mousemove",v),Mc(g,"touchmove",v),Mc(g,"mouseup",b),Mc(g,"touchend",b)),n.start(e)},v=function(t){var e=t.raw;if(jC(e),e.button!==u)return b(t);e.deltaX=e.screenX-a,e.deltaY=e.screenY-c,t.prevent(),n.drag(e)},b=function(t){jC(t.raw),j(l,(function(t){return t.unbind()})),l=[],Me(i),n.stop&&n.stop(t.raw)};return s.push(Mc(p,"mousedown",h),Mc(p,"touchstart",h)),{destroy:function(){j(l.concat(s),(function(t){return t.unbind()})),l=[],s=[],f(i)&&Me(i)}}}(a,{document:o.ownerDocument,root:Pn(c).dom,handle:a+"-"+n.name,start:function(){e=t},drag:function(t){m(n,e,t.deltaX,t.deltaY)}})})),g(t);var e=function(t){Gn(t.target,"aria-grabbed","focus"===t.raw.type?"true":"false")};u.push(Mc(c,"focusin",e),Mc(c,"focusout",e),Mc(c,"keydown",(function(n){var e;j(s,(function(t){if(qn(n.target,"id")===a+"-"+t.name)return e=t,!1}));var o=function(t,n,o,r,i){t.stopPropagation(),t.preventDefault(),m(e,o,r,i)};switch(n.raw.keyCode){case UC.LEFT:o(n,0,t,-10,0);break;case UC.RIGHT:o(n,0,t,10,0);break;case UC.UP:o(n,0,t,0,-10);break;case UC.DOWN:o(n,0,t,0,10);break;case UC.ENTER:case UC.SPACEBAR:n.prevent(),r()}})))}();var v=O(O({},WC),{toggleVisibility:function(t){var n=T(T([],U(s,(function(t){return"#"+a+"-"+t.name})),!0),U(l,(function(t){return"#"+a+"-"+t})),!0).join(","),e=_s(c,n);j(e,t?function(t){return ae(t,"display")}:function(t){return Zn(t,"display","none")})},setClampRect:function(n){e=n,g(t)},setRect:p,getInnerRect:function(){return d(e,t)},setInnerRect:h,setViewPortRect:function(e){n=e,g(t)},destroy:function(){j(i,(function(t){return t.destroy()})),i=[],j(u,(function(t){return t.unbind()})),u=[]}});return v},KC=function(t,n,e,o,r){return SC({name:t,icon:I.some(n),disabled:e,tooltip:I.some(t),primary:!1,borderless:!1},o,r)},JC=function(t,n){n?dd.enable(t):dd.disable(t)},$C=function(t,n){var e=function(t){var n,e,o,r,i=dr(t),u=Ec(),a=(e=-1,{data:n=[],add:function(t){var o=n.splice(++e);return n.push(t),{state:t,removed:o}},undo:function(){if(o())return n[--e]},redo:function(){if(r())return n[++e]},canUndo:o=function(){return e>0},canRedo:r=function(){return-1!==e&&e<n.length-1}});a.add(t);var c=function(t){i.set(t)},s=function(t){return{blob:t,url:URL.createObjectURL(t)}},f=function(t){URL.revokeObjectURL(t.url)},l=function(){u.on(f),u.clear()},d=function(t){var n,e=s(t);return c(e),n=a.add(e).removed,fk.each(n,f),e.url};return{getBlobState:function(){return i.get()},setBlobState:c,addBlobState:d,getTempState:function(){return u.get().getOrThunk(i.get)},updateTempState:function(t){var n=s(t);return l(),u.set(n),n.url},addTempState:function(t){var n=s(t);return u.set(n),n.url},applyTempState:function(t){return u.get().fold(g,(function(n){d(n.blob),t()}))},destroyTempState:l,undo:function(){var t=a.undo();return c(t),t.url},redo:function(){var t=a.redo();return c(t),t.url},getHistoryStates:function(){return{undoEnabled:a.canUndo(),redoEnabled:a.canRedo()}}}}(t.currentState),o=function(t){var n=e.getHistoryStates();d.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),yi(t,zC.formActionEvent,{name:zC.saveState(),value:n.undoEnabled})},r=function(t){return t.toBlob()},i=function(t){yi(t,zC.formActionEvent,{name:zC.disable(),value:{}})},u=function(t){m.getApplyButton(t).each((function(t){dd.enable(t)})),yi(t,zC.formActionEvent,{name:zC.enable(),value:{}})},a=function(t,n){return i(t),l.updateSrc(t,n)},c=function(t,n,e,c,s){i(t),function(t){return Ik(t)}(n).then(e).then(r).then(c).then((function(n){return a(t,n)})).then((function(){o(t),s(),u(t)})).catch((function(n){console.log(n),t.getSystem().isConnected()&&u(t)}))},s=function(t,n,o){var r=e.getBlobState().blob;c(t,r,n,(function(t){return e.updateTempState(t)}),o)},f=function(t){var n=e.getBlobState().url;return e.destroyTempState(),o(t),n},l=function(t){var n,e=Fp({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),o=dr(1),r=(n=_c(),O(O({},n),{run:function(t){return n.get().each(t)}})),i=dr({x:0,y:0,w:1,h:1}),u=dr({x:0,y:0,w:1,h:1}),a=function(t,n){f.getOpt(t).each((function(t){var u=o.get(),a=ye(t.element),c=le(t.element),s=n.dom.naturalWidth*u,f=n.dom.naturalHeight*u,l=Math.max(0,a/2-s/2),d=Math.max(0,c/2-f/2),m={left:l.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:f.toString()+"px",position:"absolute"};te(n,m),e.getOpt(t).each((function(t){te(t.element,m)})),r.run((function(t){var n=i.get();t.setRect({x:n.x*u+l,y:n.y*u+d,w:n.w*u,h:n.h*u}),t.setClampRect({x:l,y:d,w:s,h:f}),t.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},c=function(t,n){var e,r=Ft("img");return Gn(r,"src",n),(e=r.dom,new eh((function(t){var n=function(){e.removeEventListener("load",n),t(e)};e.complete?t(e):e.addEventListener("load",n)}))).then((function(){t.getSystem().isConnected()&&f.getOpt(t).map((function(t){var n=Du({element:r});Sg.replaceAt(t,1,I.some(n));var e=u.get(),c={x:0,y:0,w:r.dom.naturalWidth,h:r.dom.naturalHeight};u.set(c);var s=LC.inflate(c,-20,-20);i.set(s),e.w===c.w&&e.h===c.h||function(t,n){f.getOpt(t).each((function(t){var e=ye(t.element),r=le(t.element),i=n.dom.naturalWidth,u=n.dom.naturalHeight,a=Math.min(e/i,r/u);a>=1?o.set(1):o.set(a)}))}(t,r),a(t,r)}))}))},s=Ny.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[e.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:Ja([kg("image-panel-crop-events",[Ri((function(t){f.getOpt(t).each((function(t){var n=t.element.dom,e=YC({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},n,g);e.toggleVisibility(!1),e.on("updateRect",(function(t){var n=t.rect,e=o.get(),r={x:Math.round(n.x/e),y:Math.round(n.y/e),w:Math.round(n.w/e),h:Math.round(n.h/e)};i.set(r)})),r.set(e)}))})),Vi((function(){r.clear()}))])])}],containerBehaviours:Ja([Sg.config({}),kg("image-panel-events",[Ri((function(n){c(n,t)}))])])}),f=Fp(s);return{memContainer:f,updateSrc:c,zoom:function(t,n){var e=o.get(),r=n>0?Math.min(2,e+.1):Math.max(.1,e-.1);o.set(r),f.getOpt(t).each((function(t){var n=t.components()[1].element;a(t,n)}))},showCrop:function(){r.run((function(t){t.toggleVisibility(!0)}))},hideCrop:function(){r.run((function(t){t.toggleVisibility(!1)}))},getRect:function(){return i.get()},getMeasurements:function(){var t=u.get();return{width:t.w,height:t.h}}}}(t.currentState.url),d=function(t){var n=Fp(KC("Undo","undo",!0,(function(t){yi(t,RC.undo(),{direction:1})}),t)),e=Fp(KC("Redo","redo",!0,(function(t){yi(t,RC.redo(),{direction:1})}),t));return{container:Ny.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[n.asSpec(),e.asSpec(),KC("Zoom in","zoom-in",!1,(function(t){yi(t,RC.zoom(),{direction:1})}),t),KC("Zoom out","zoom-out",!1,(function(t){yi(t,RC.zoom(),{direction:-1})}),t)]}),updateButtonUndoStates:function(t,o,r){n.getOpt(t).each((function(t){JC(t,o)})),e.getOpt(t).each((function(t){JC(t,r)}))}}}(n),m=NC(l,n);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[m.memContainer.asSpec(),l.memContainer.asSpec(),d.container],behaviours:Ja([Gf.config({store:{mode:"manual",getValue:function(){return e.getBlobState()}}}),kg("image-tools-events",[Ti(RC.undo(),(function(t,n){var r=e.undo();a(t,r).then((function(n){u(t),o(t)}))})),Ti(RC.redo(),(function(t,n){var r=e.redo();a(t,r).then((function(n){u(t),o(t)}))})),Ti(RC.zoom(),(function(t,n){var e=n.event.direction;l.zoom(t,e)})),Ti(RC.back(),(function(t,n){!function(t){var n=f(t);a(t,n).then((function(n){u(t)}))}(t),(0,n.event.swap)(),l.hideCrop()})),Ti(RC.apply(),(function(t,n){e.applyTempState((function(){f(t),(0,n.event.swap)()}))})),Ti(RC.transform(),(function(t,n){return s(t,n.event.transform,g)})),Ti(RC.tempTransform(),(function(t,n){return function(t,n){var o=e.getTempState().blob;c(t,o,n,(function(t){return e.addTempState(t)}),g)}(t,n.event.transform)})),Ti(RC.transformApply(),(function(t,n){return function(t,n,o){var r=e.getBlobState().blob;c(t,r,n,(function(n){var o=e.addBlobState(n);return f(t),o}),o)}(t,n.event.transform,n.event.swap)})),Ti(RC.swap(),(function(t,n){!function(t){d.updateButtonUndoStates(t,!1,!1)}(t);var e=n.event.transform,o=n.event.swap;e.fold((function(){o()}),(function(n){s(t,n,o)}))}))]),ik()])}},QC=function(t){return!yt(t,"items")},ZC="data-value",tO=function(t,n,e,o){return U(e,(function(e){return QC(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){Gf.setValue(t,e.value),yi(t,Zy,{name:n}),Eg.focus(t)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return tO(t,n,e.items,o)}}}))},nO=function(t,n){return st(t,(function(t){return QC(t)?Ct(t.value===n,t):nO(t.items,n)}))},eO=ql({name:"HtmlSelect",configFields:[Lo("options"),Xf("selectBehaviours",[Eg,Gf]),or("selectClasses",[]),or("selectAttributes",{}),Jo("data")],factory:function(t,n){var e=U(t.options,(function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}})),o=t.data.map((function(t){return hr("initialValue",t)})).getOr({});return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:e,behaviours:Yf(t.selectBehaviours,[Eg.config({}),Gf.config({store:O({mode:"manual",getValue:function(t){return _u(t.element)},setValue:function(n,e){K(t.options,(function(t){return t.value===e})).isSome()&&Tu(n.element,e)}},o)})])}}}),oO=function(t,n){var e=t.label.map((function(t){return Qy(t,n)})),o=[dd.config({disabled:function(){return t.disabled||n.isDisabled()}}),Zv(),hg.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return bi(t,ox),I.some(!0)}}),kg("textfield-change",[Ti(Hr(),(function(n,e){yi(n,Zy,{name:t.name})})),Ti(Kr(),(function(n,e){yi(n,Zy,{name:t.name})}))]),qy.config({})],r=t.validation.map((function(t){return Dx.config({getRoot:function(t){return En(t.element)},invalidClass:"tox-invalid",validator:{validate:function(n){var e=Gf.getValue(n),o=t.validator(e);return Sx(!0===o?Ge.value(e):Ge.error(o))},validateOnLoad:t.validateOnLoad}})})).toArray(),i=t.placeholder.fold(h({}),(function(t){return{placeholder:n.translate(t)}})),u=t.inputMode.fold(h({}),(function(t){return{inputmode:t}})),a=O(O({},i),u),c=jy.parts.field({tag:!0===t.multiline?"textarea":"input",inputAttributes:a,inputClasses:[t.classname],inputBehaviours:Ja($([o,r])),selectOnFocus:!1,factory:dx}),s=(t.flex?["tox-form__group--stretched"]:[]).concat(t.maximized?["tox-form-group--maximize"]:[]),f=[dd.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){jy.getField(t).each(dd.disable)},onEnabled:function(t){jy.getField(t).each(dd.enable)}}),Zv()];return Ky(e,c,s,f)},rO=Object.freeze({__proto__:null,events:function(t,n){var e=t.stream.streams.setup(t,n);return Ci([Ti(t.event,e),Vi((function(){return n.cancel()}))].concat(t.cancelEvent.map((function(t){return[Ti(t,(function(){return n.cancel()}))]})).getOr([])))}}),iO=function(t){var n=dr(null);return su({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get();null!==t&&t.cancel()}})},uO=Object.freeze({__proto__:null,throttle:iO,init:function(t){return t.stream.streams.state(t)}}),aO=[Wo("stream",Po("mode",{throttle:[Lo("delay"),or("stopEvent",!0),ca("streams",{setup:function(t,n){var e=t.stream,o=qp(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:iO})]})),or("event","input"),Jo("cancelEvent"),ua("onStream")],cO=Qa({fields:aO,name:"streaming",active:rO,state:uO}),sO=function(t,n,e){var o=Gf.getValue(e);Gf.setValue(n,o),lO(n)},fO=function(t,n){var e=t.element,o=_u(e),r=e.dom;"number"!==qn(e,"type")&&n(r,o)},lO=function(t){fO(t,(function(t,n){return t.setSelectionRange(n.length,n.length)}))},dO=h("alloy.typeahead.itemexecute"),mO=h([Jo("lazySink"),Lo("fetch"),or("minChars",5),or("responseTime",1e3),ra("onOpen"),or("getHotspot",I.some),or("getAnchorOverrides",h({})),or("layouts",I.none()),or("eventOrder",{}),lr("model",{},[or("getDisplayText",(function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value})),or("selectsOver",!0),or("populateFromBrowse",!0)]),ra("onSetValue"),ia("onExecute"),ra("onItemExecute"),or("inputClasses",[]),or("inputAttributes",{}),or("inputStyles",{}),or("matchWidth",!0),or("useMinWidth",!1),or("dismissOnBlur",!0),ea(["openClass"]),Jo("initialData"),Xf("typeaheadBehaviours",[Eg,Gf,cO,hg,Ng,Vx]),zo("previewing",(function(){return dr(!0)}))].concat(cx()).concat(Jx())),gO=h([xl({schema:[na()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each((function(o){(function(t,n,e){if(t.selectsOver){var o=Gf.getValue(n),r=t.getDisplayText(o),i=Gf.getValue(e);return 0===t.getDisplayText(i).indexOf(r)?I.some((function(){sO(0,n,e),function(t,n){fO(t,(function(t,e){return t.setSelectionRange(n,e.length)}))}(n,r.length)})):I.none()}return I.none()})(t.model,o,e).fold((function(){return Sd.dehighlight(n,e)}),(function(t){return t()}))})):n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&sO(t.model,n,e)})),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOptional().map((function(t){return yi(t,dO(),{item:e}),!0}))},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&sO(t.model,n,e)}))}}}})]),pO=Yl({name:"Typeahead",configFields:mO(),partFields:gO(),factory:function(t,n,e,o){var r=function(n,e,r){t.previewing.set(!1);var i=Vx.getCoupled(n,"sandbox");Of.isOpen(i)?Ql.getCurrent(i).each((function(t){Sd.getHighlighted(t).fold((function(){r(t)}),(function(){ki(i,t.element,"keydown",e)}))})):Ux(t,u(n),n,i,o,(function(t){Ql.getCurrent(t).each(r)}),px.HighlightFirst).get(g)},i=sx(t),u=function(t){return function(n){return n.map((function(n){var e=vt(n.menus),o=Q(e,(function(t){return X(t.items,(function(t){return"item"===t.type}))}));return Gf.getState(t).update(U(o,(function(t){return t.data}))),n}))}},a=[Eg.config({}),Gf.config({onSetValue:t.onSetValue,store:O({mode:"dataset",getDataKey:function(t){return _u(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(n,e){Tu(n.element,t.model.getDisplayText(e))}},t.initialData.map((function(t){return hr("initialValue",t)})).getOr({}))}),cO.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(n,e){var r=Vx.getCoupled(n,"sandbox");if(Eg.isFocused(n)&&_u(n.element).length>=t.minChars){var i=Ql.getCurrent(r).bind((function(t){return Sd.getHighlighted(t).map(Gf.getValue)}));t.previewing.set(!0),Ux(t,u(n),n,r,o,(function(n){Ql.getCurrent(r).each((function(n){i.fold((function(){t.model.selectsOver&&Sd.highlightFirst(n)}),(function(t){Sd.highlightBy(n,(function(n){return Gf.getValue(n).value===t.value})),Sd.getHighlighted(n).orThunk((function(){return Sd.highlightFirst(n),I.none()}))}))}))}),px.HighlightFirst).get(g)}},cancelEvent:ei()}),hg.config({mode:"special",onDown:function(t,n){return r(t,n,Sd.highlightFirst),I.some(!0)},onEscape:function(t){var n=Vx.getCoupled(t,"sandbox");return Of.isOpen(n)?(Of.close(n),I.some(!0)):I.none()},onUp:function(t,n){return r(t,n,Sd.highlightLast),I.some(!0)},onEnter:function(n){var e=Vx.getCoupled(n,"sandbox"),o=Of.isOpen(e);if(o&&!t.previewing.get())return Ql.getCurrent(e).bind((function(t){return Sd.getHighlighted(t)})).map((function(t){return yi(n,dO(),{item:t}),!0}));var r=Gf.getValue(n);return bi(n,ei()),t.onExecute(e,n,r),o&&Of.close(e),I.some(!0)}}),Ng.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),Vx.config({others:{sandbox:function(n){return Yx(t,n,{onOpen:function(){return Ng.on(n)},onClose:function(){return Ng.off(n)}})}}}),kg("typeaheadevents",[Hi((function(n){var e=g;Gx(t,u(n),n,o,e,px.HighlightFirst).get(g)})),Ti(dO(),(function(n,e){var o=Vx.getCoupled(n,"sandbox");sO(t.model,n,e.event.item),bi(n,ei()),t.onItemExecute(n,o,e.event.item,Gf.getValue(n)),Of.close(o),lO(n)}))].concat(t.dismissOnBlur?[Ti(Yr(),(function(t){var n=Vx.getCoupled(t,"sandbox");cc(n.element).isNone()&&Of.close(n)}))]:[]))];return{uid:t.uid,dom:lx(no(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:O(O({},i),Yf(t.typeaheadBehaviours,a)),eventOrder:t.eventOrder}}}),hO=function(t){return O(O({},t),{toCached:function(){return hO(t.toCached())},bindFuture:function(n){return hO(t.bind((function(t){return t.fold((function(t){return Sx(Ge.error(t))}),(function(t){return n(t)}))})))},bindResult:function(n){return hO(t.map((function(t){return t.bind(n)})))},mapResult:function(n){return hO(t.map((function(t){return t.map(n)})))},mapError:function(n){return hO(t.map((function(t){return t.mapError(n)})))},foldResult:function(n,e){return t.map((function(t){return t.fold(n,e)}))},withTimeout:function(n,e){return hO(wx((function(o){var r=!1,i=setTimeout((function(){r=!0,o(Ge.error(e()))}),n);t.get((function(t){r||(clearTimeout(i),o(t))}))})))}})},vO=function(t){return hO(wx(t))},bO={type:"separator"},yO=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:g}},xO=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:g}},wO=function(t,n){return function(t){return U(t,yO)}(function(t,n){return X(n,(function(n){return n.type===t}))}(t,n))},SO=function(t){return wO("header",t.targets)},kO=function(t){return wO("anchor",t.targets)},CO=function(t){return I.from(t.anchorTop).map((function(t){return xO("<top>",t)})).toArray()},OO=function(t){return I.from(t.anchorBottom).map((function(t){return xO("<bottom>",t)})).toArray()},_O=function(t,n){var e=t.toLowerCase();return X(n,(function(t){var n=void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.text;return _t(n.toLowerCase(),e)||_t(t.value.toLowerCase(),e)}))},TO=Xi("aria-invalid"),EO=function(t){return function(n,e,o){return bt(e,"name").fold((function(){return t(e,o)}),(function(r){return n.field(r,t(e,o))}))}},BO={bar:EO((function(t,n){return function(t,n){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:U(t.items,n.interpreter)}}(t,n.shared)})),collection:EO((function(t,n){return function(t,n){var e,o,r=t.label.map((function(t){return Qy(t,n)})),i=function(t){return function(n,e){ju(e.event.target,"[data-collection-item-value]").each((function(o){t(n,e,o,qn(o,"data-collection-item-value"))}))}},u=i((function(e,o,r,i){o.stop(),n.isDisabled()||yi(e,ex,{name:t.name,value:i})})),a=[Ti(Fr(),i((function(t,n,e){ic(e)}))),Ti(Nr(),u),Ti(Zr(),u),Ti(Ir(),i((function(t,n,e){Uu(t.element,"."+Fh).each((function(t){Su(t,Fh)})),wu(e,Fh)}))),Ti(Rr(),i((function(t){Uu(t.element,"."+Fh).each((function(t){Su(t,Fh)}))}))),Hi(i((function(n,e,o,r){yi(n,ex,{name:t.name,value:r})})))],c=function(t,n){return U(_s(t.element,".tox-collection__item"),n)},s=jy.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:v},behaviours:Ja([dd.config({disabled:n.isDisabled,onDisabled:function(t){c(t,(function(t){wu(t,"tox-collection__item--state-disabled"),Gn(t,"aria-disabled",!0)}))},onEnabled:function(t){c(t,(function(t){Su(t,"tox-collection__item--state-disabled"),Jn(t,"aria-disabled")}))}}),Zv(),Sg.config({}),Gf.config({store:{mode:"memory",initialValue:[]},onSetValue:function(e,o){!function(e,o){var r=U(o,(function(e){var o=Ip.translate(e.text),r=1===t.columns?'<div class="tox-collection__item-label">'+o+"</div>":"",i='<div class="tox-collection__item-icon">'+e.icon+"</div>",u={_:" "," - ":" ","-":" "},a=o.replace(/\_| \- |\-/g,(function(t){return u[t]}));return'<div class="tox-collection__item'+(n.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+Yy.encodeAllRaw(e.value)+'" title="'+a+'" aria-label="'+a+'">'+i+r+"</div>"})),i="auto"!==t.columns&&t.columns>1?W(r,t.columns):[r],u=U(i,(function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"}));Ni(e.element,u.join(""))}(e,o),"auto"===t.columns&&dv(e,5,"tox-collection__item").each((function(t){var n=t.numRows,o=t.numColumns;hg.setGridSize(e,n,o)})),bi(e,ax)}}),qy.config({}),hg.config((o=t.columns,1===o?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===o?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:"."+Th}})),kg("collection-events",a)]),eventOrder:(e={},e[$r()]=["disabling","alloy.base.behaviour","collection-events"],e)});return Ky(r,s,["tox-form__group--collection"],[])}(t,n.shared.providers)})),alertbanner:EO((function(t,n){return function(t,n){return Ny.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+t.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[Dp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:Np(t.icon,n.icons),attributes:{title:n.translate(t.iconTooltip)}},action:function(n){yi(n,ex,{name:"alert-banner",value:t.url})},buttonBehaviours:Ja([Lp()])})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:n.translate(t.text)}}]})}(t,n.shared.providers)})),input:EO((function(t,n){return function(t,n){return oO({name:t.name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:t.disabled,classname:"tox-textfield",validation:I.none(),maximized:t.maximized},n)}(t,n.shared.providers)})),textarea:EO((function(t,n){return function(t,n){return oO({name:t.name,multiline:!0,label:t.label,inputMode:I.none(),placeholder:t.placeholder,flex:!0,disabled:t.disabled,classname:"tox-textarea",validation:I.none(),maximized:t.maximized},n)}(t,n.shared.providers)})),label:EO((function(t,n){return function(t,n){var e={dom:{tag:"label",innerHtml:n.providers.translate(t.label),classes:["tox-label"]}},o=U(t.items,n.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[e].concat(o),behaviours:Ja([ik(),Sg.config({}),pk(I.none()),hg.config({mode:"acyclic"})])}}(t,n.shared)})),iframe:(XC=function(t,n){return function(t,n){var e=Ck&&t.sandboxed,o=O(O({},t.label.map((function(t){return{title:t}})).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),r=function(t){var n=dr("");return{getValue:function(t){return n.get()},setValue:function(e,o){if(t)Gn(e.element,"srcdoc",o);else{Gn(e.element,"src","javascript:''");var r=e.element.dom.contentWindow.document;r.open(),r.write(o),r.close()}n.set(o)}}}(e),i=t.label.map((function(t){return Qy(t,n)})),u=jy.parts.field({factory:{sketch:function(t){return xk({uid:t.uid,dom:{tag:"iframe",attributes:o},behaviours:Ja([qy.config({}),Eg.config({}),gk(I.none(),r.getValue,r.setValue)])})}}});return Ky(i,u,["tox-form__group--stretched"],[])}(t,n.shared.providers)},function(t,n,e){var o=no(n,{source:"dynamic"});return EO(XC)(t,o,e)}),button:EO((function(t,n){return function(t,n){var e,o,r=OC(t.name,"custom");return e=I.none(),o=jy.parts.field(O({factory:Dp},kC(t,I.some(r),n,[hk(""),ik()]))),Ky(e,o,[],[])}(t,n.shared.providers)})),checkbox:EO((function(t,n){return function(t,n){var e=Gf.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,n){t.element.dom.checked=n}}}),o=function(t){return t.element.dom.click(),I.some(!0)},r=jy.parts.field({factory:{sketch:v},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:Ja([ik(),dd.config({disabled:function(){return t.disabled||n.isDisabled()}}),qy.config({}),Eg.config({}),e,hg.config({mode:"special",onEnter:o,onSpace:o,stopSpaceKeyup:!0}),kg("checkbox-events",[Ti(zr(),(function(n,e){yi(n,Zy,{name:t.name})}))])])}),i=jy.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:n.translate(t.label)},behaviours:Ja([nw.config({})])}),u=function(t){return Up("checked"===t?"selected":"unselected",{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t]},n.icons)},a=Fp({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[u("checked"),u("unchecked")]});return jy.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[r,a.asSpec(),i],fieldBehaviours:Ja([dd.config({disabled:function(){return t.disabled||n.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){jy.getField(t).each(dd.disable)},onEnabled:function(t){jy.getField(t).each(dd.enable)}}),Zv()])})}(t,n.shared.providers)})),colorinput:EO((function(t,n){return function(t,n,e){var o=jy.parts.field({factory:dx,inputClasses:["tox-textfield"],onSetValue:function(t){return Dx.run(t).get(g)},inputBehaviours:Ja([dd.config({disabled:n.providers.isDisabled}),Zv(),qy.config({}),Dx.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return En(t.element)},notify:{onValid:function(t){var n=Gf.getValue(t);yi(t,ew,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=Gf.getValue(t);if(0===n.length)return Sx(Ge.value(!0));var e=Ft("span");Zn(e,"background-color",n);var o=re(e,"background-color").fold((function(){return Ge.error("blah")}),(function(t){return Ge.value(n)}));return Sx(o)}}})]),selectOnFocus:!1}),r=t.label.map((function(t){return Qy(t,n.providers)})),i=function(t,n){yi(t,ow,{value:n})},u=Fp(function(t,n){return Zx.sketch({dom:t.dom,components:t.components,toggleClass:"mce-active",dropdownBehaviours:Ja([tb(n.providers.isDisabled),Zv(),nw.config({}),qy.config({})]),layouts:t.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:n.getSink,fetch:function(e){return wx((function(n){return t.fetch(n)})).map((function(o){return I.from(Ty(no(gy(Xi("menu-value"),o,(function(n){t.onItemAction(e,n)}),t.columns,t.presets,Oh.CLOSE_ON_EXECUTE,S,n.providers),{movement:hy(t.columns,t.presets)})))}))},parts:{menu:Wh(0,0,t.presets)}})}({dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Da,Aa,Va]},onLtr:function(){return[Aa,Da,Va]}},components:[],fetch:sy(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:function(t,n){u.getOpt(t).each((function(t){"custom"===n?e.colorPicker((function(n){n.fold((function(){return bi(t,rw)}),(function(n){i(t,n),oy(n)}))}),"#ffffff"):i(t,"remove"===n?"":n)}))}},n));return jy.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:r.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[o,u.asSpec()]}]),fieldBehaviours:Ja([kg("form-field-events",[Ti(ew,(function(n,e){u.getOpt(n).each((function(t){Zn(t.element,"background-color",e.event.color)})),yi(n,Zy,{name:t.name})})),Ti(ow,(function(t,n){jy.getField(t).each((function(e){Gf.setValue(e,n.event.value),Ql.getCurrent(t).each(Eg.focus)}))})),Ti(rw,(function(t,n){jy.getField(t).each((function(n){Ql.getCurrent(t).each(Eg.focus)}))}))])])})}(t,n.shared,n.colorinput)})),colorpicker:EO((function(t){var n=function(t){return"tox-"+t},e=rk(ck,n),o=Fp(e.sketch({dom:{tag:"div",classes:[n("color-picker-container")],attributes:{role:"presentation"}},onValidHex:function(t){yi(t,ex,{name:"hex-valid",value:!0})},onInvalidHex:function(t){yi(t,ex,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:Ja([Gf.config({store:{mode:"manual",getValue:function(t){var n=o.get(t);return Ql.getCurrent(n).bind((function(t){return Gf.getValue(t).hex})).map((function(t){return"#"+t})).getOr("")},setValue:function(t,n){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),r=o.get(t);Ql.getCurrent(r).fold((function(){console.log("Can not find form")}),(function(t){Gf.setValue(t,{hex:I.from(e[1]).getOr("")}),QS.getField(t,"hex").each((function(t){bi(t,Hr())}))}))}}}),ik()])}})),dropzone:EO((function(t,n){return function(t,n){var e=function(t,n){n.stop()},o=function(t){return function(n,e){j(t,(function(t){t(n,e)}))}},r=function(t,n){if(!dd.isDisabled(t)){var e=n.event.raw;u(t,e.dataTransfer.files)}},i=function(t,n){var e=n.event.raw.target;u(t,e.files)},u=function(e,o){Gf.setValue(e,function(t,n){var e=fk.explode(n.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string"));return X(ct(t),(function(t){return N(e,(function(n){return Tt(t.name.toLowerCase(),"."+n.toLowerCase())}))}))}(o,n)),yi(e,Zy,{name:t.name})},a=Fp({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:Ja([kg("input-file-events",[Di(Nr()),Di(Zr())])])}),c=t.label.map((function(t){return Qy(t,n)})),s=jy.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:Ja([hk([]),ik(),dd.config({}),Ng.config({toggleClass:"dragenter",toggleOnExecute:!1}),kg("dropzone-events",[Ti("dragenter",o([e,Ng.toggle])),Ti("dragleave",o([e,Ng.toggle])),Ti("dragover",e),Ti("drop",o([e,r])),Ti(zr(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},Dp.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){a.get(t).element.dom.click()},buttonBehaviours:Ja([qy.config({}),tb(n.isDisabled),Zv()])})]}]}}}});return Ky(c,s,["tox-form__group--stretched"],[])}(t,n.shared.providers)})),grid:EO((function(t,n){return function(t,n){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:U(t.items,n.interpreter)}}(t,n.shared)})),listbox:EO((function(t,n){return function(t,n){var e=n.shared.providers,o=ut(t.items).filter(QC),r=t.label.map((function(t){return Qy(t,e)})),i={dom:{tag:"div",classes:["tox-listboxfield"]},components:[jy.parts.field({dom:{},factory:{sketch:function(e){return dC({uid:e.uid,text:o.map((function(t){return t.text})),icon:I.none(),tooltip:t.label,role:I.none(),fetch:function(e,o){var r=tO(e,t.name,t.items,Gf.getValue(e));o(hC(r,Oh.CLOSE_ON_EXECUTE,n,!1))},onSetup:h(g),getApi:h({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[qy.config({}),Gf.config({store:{mode:"manual",initialValue:o.map((function(t){return t.value})).getOr(""),getValue:function(t){return qn(t.element,ZC)},setValue:function(n,e){nO(t.items,e).each((function(t){Gn(n.element,ZC,t.value),yi(n,fC,{text:t.text})}))}}})]},"tox-listbox",n.shared)}}})]};return jy.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:$([r.toArray(),[i]]),fieldBehaviours:Ja([dd.config({disabled:h(t.disabled),onDisabled:function(t){jy.getField(t).each(dd.disable)},onEnabled:function(t){jy.getField(t).each(dd.enable)}})])})}(t,n)})),selectbox:EO((function(t,n){return function(t,n){var e=U(t.items,(function(t){return{text:n.translate(t.text),value:t.value}})),o=t.label.map((function(t){return Qy(t,n)})),r=jy.parts.field({dom:{},selectAttributes:{size:t.size},options:e,factory:eO,selectBehaviours:Ja([dd.config({disabled:function(){return t.disabled||n.isDisabled()}}),qy.config({}),kg("selectbox-change",[Ti(zr(),(function(n,e){yi(n,Zy,{name:t.name})}))])])}),i=t.size>1?I.none():I.some(Up("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},n.icons)),u={dom:{tag:"div",classes:["tox-selectfield"]},components:$([[r],i.toArray()])};return jy.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:$([o.toArray(),[u]]),fieldBehaviours:Ja([dd.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){jy.getField(t).each(dd.disable)},onEnabled:function(t){jy.getField(t).each(dd.enable)}}),Zv()])})}(t,n.shared.providers)})),sizeinput:EO((function(t,n){return IC(t,n.shared.providers)})),urlinput:EO((function(t,n){return function(t,n,e){var o,r=n.shared.providers,i=function(n){var o=Gf.getValue(n);e.addToHistory(o.value,t.filetype)},u=jy.parts.field({factory:pO,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":TO,type:"url"},minChars:0,responseTime:0,fetch:function(o){var r=function(t,n,e){var o=Gf.getValue(n),r=void 0!==o.meta.text?o.meta.text:o.value;return e.getLinkInformation().fold((function(){return[]}),(function(n){var o,i=_O(r,function(t){return U(t,(function(t){return xO(t,t)}))}(e.getHistory(t)));return"file"===t?(o=[i,_O(r,SO(n)),_O(r,$([CO(n),kO(n),OO(n)]))],Y(o,(function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(bO,n)}),[])):i}))}(t.filetype,o,e),i=hC(r,Oh.BUBBLE_TO_SANDBOX,n,!1);return Sx(i)},getHotspot:function(t){return d.getOpt(t)},onSetValue:function(t,n){t.hasConfigured(Dx)&&Dx.run(t).get(g)},typeaheadBehaviours:Ja($([e.getValidationHandler().map((function(n){return Dx.config({getRoot:function(t){return En(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){c.getOpt(t).each((function(t){Gn(t.element,"title",r.translate(n))}))}},validator:{validate:function(e){var o=Gf.getValue(e);return vO((function(e){n({type:t.filetype,url:o.value},(function(t){if("invalid"===t.status){var n=Ge.error(t.message);e(n)}else{var o=Ge.value(t.message);e(o)}}))}))},validateOnLoad:!1}})})).toArray(),[dd.config({disabled:function(){return t.disabled||r.isDisabled()}}),qy.config({}),kg("urlinput-events",$(["file"===t.filetype?[Ti(Hr(),(function(n){yi(n,Zy,{name:t.name})}))]:[],[Ti(zr(),(function(n){yi(n,Zy,{name:t.name}),i(n)})),Ti(Kr(),(function(n){yi(n,Zy,{name:t.name}),i(n)}))]]))]])),eventOrder:(o={},o[Hr()]=["streaming","urlinput-events","invalidating"],o),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:Wh(0,0,"normal")},onExecute:function(t,n,e){yi(n,ox,{})},onItemExecute:function(n,e,o,r){i(n),yi(n,Zy,{name:t.name})}}),a=t.label.map((function(t){return Qy(t,r)})),c=Fp(function(t,n,e,o){return void 0===e&&(e=t),void 0===o&&(o=t),Up(e,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+t],attributes:O({title:r.translate(o),"aria-live":"polite"},n.fold((function(){return{}}),(function(t){return{id:t}})))},r.icons)}("invalid",I.some(TO),"warning")),s=Fp({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[c.asSpec()]}),f=e.getUrlPicker(t.filetype),l=Xi("browser.url.event"),d=Fp({dom:{tag:"div",classes:["tox-control-wrap"]},components:[u,s.asSpec()],behaviours:Ja([dd.config({disabled:function(){return t.disabled||r.isDisabled()}})])}),m=Fp(CC({name:t.name,icon:I.some("browse"),text:t.label.getOr(""),disabled:t.disabled,primary:!1,borderless:!0},(function(t){return bi(t,l)}),r,[],["tox-browse-url"]));return jy.sketch({dom:$y([]),components:a.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:$([[d.asSpec()],f.map((function(){return m.asSpec()})).toArray()])}]),fieldBehaviours:Ja([dd.config({disabled:function(){return t.disabled||r.isDisabled()},onDisabled:function(t){jy.getField(t).each(dd.disable),m.getOpt(t).each(dd.disable)},onEnabled:function(t){jy.getField(t).each(dd.enable),m.getOpt(t).each(dd.enable)}}),Zv(),kg("url-input-events",[Ti(l,(function(n){Ql.getCurrent(n).each((function(e){var o=Gf.getValue(e),r=O({fieldname:t.name},o);f.each((function(o){o(r).get((function(o){Gf.setValue(e,o),yi(n,Zy,{name:t.name})}))}))}))}))])])})}(t,n,n.urlinput)})),customeditor:EO((function(t){var n=Ec(),e=Fp({dom:{tag:t.tag}}),o=Ec();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:Ja([kg("custom-editor-events",[Ri((function(r){e.getOpt(r).each((function(e){(!function(t){return yt(t,"init")}(t)?sk.load(t.scriptId,t.scriptUrl).then((function(n){return n(e.element.dom,t.settings)})):t.init(e.element.dom)).then((function(t){o.on((function(n){t.setValue(n)})),o.clear(),n.set(t)}))}))}))]),Gf.config({store:{mode:"manual",getValue:function(){return n.get().fold((function(){return o.get().getOr("")}),(function(t){return t.getValue()}))},setValue:function(t,e){n.get().fold((function(){o.set(e)}),(function(t){return t.setValue(e)}))}}}),ik()]),components:[e.asSpec()]}})),htmlpanel:EO((function(t){return"presentation"===t.presets?Ny.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):Ny.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:Ja([qy.config({}),Eg.config({})])})})),imagetools:EO((function(t,n){return $C(t,n.shared.providers)})),table:EO((function(t,n){return function(t,n){var e,o,r=function(t){return{dom:{tag:"td",innerHtml:n.translate(t)}}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(o=t.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:U(o,(function(t){return{dom:{tag:"th",innerHtml:n.translate(t)}}}))}]}),(e=t.cells,{dom:{tag:"tbody"},components:U(e,(function(t){return{dom:{tag:"tr"},components:U(t,r)}}))})],behaviours:Ja([qy.config({}),Eg.config({})])}}(t,n.shared.providers)})),panel:EO((function(t,n){return function(t,n){return{dom:{tag:"div",classes:t.classes},components:U(t.items,n.shared.interpreter)}}(t,n)}))},MO={field:function(t,n){return n}},AO=function(t,n,e){var o=no(e,{shared:{interpreter:function(n){return DO(t,n,o)}}});return DO(t,n,o)},DO=function(t,n,e){return bt(BO,n.type).fold((function(){return console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n}),(function(o){return o(t,n,e)}))},FO={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},IO=function(t,n,e){var o={maxHeightFunction:Hc()};return function(){return e()?{type:"node",root:Hn(t()),node:I.from(t()),bubble:Wc(12,12,FO),layouts:{onRtl:function(){return[Sp]},onLtr:function(){return[wp]}},overrides:o}:{type:"hotspot",hotspot:n(),bubble:Wc(-12,12,FO),layouts:{onRtl:function(){return[Aa]},onLtr:function(){return[Da]}},overrides:o}}},RO=function(t,n,e){return function(){return e()?{type:"node",root:Hn(t()),node:I.from(t()),layouts:{onRtl:function(){return[kp]},onLtr:function(){return[kp]}}}:{type:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[Va]},onLtr:function(){return[Va]}}}}},VO=function(t,n){return function(){return{type:"selection",root:n(),getSelection:function(){var n=t.selection.getRng();return I.some(gs.range(Rt(n.startContainer),n.startOffset,Rt(n.endContainer),n.endOffset))}}}},PO=function(t){return function(n){return{type:"node",root:t(),node:n}}},HO=function(t,n,e){var o=Lv(t),r=function(){return Rt(t.getBody())},i=function(){return Rt(t.getContentAreaContainer())},u=function(){return o||!e()};return{inlineDialog:IO(i,n,u),banner:RO(i,n,u),cursor:VO(t,r),node:PO(r)}},zO=function(t){return function(n,e){my(t)(n,e)}},NO=function(t){return function(){return ny(t)}},LO=function(t){return function(){return ey(t)}},WO=function(t){return function(){return iy(t)}},UO=function(t){return{colorPicker:zO(t),hasCustomColors:NO(t),getColors:LO(t),getColorCols:WO(t)}},jO=function(t){return function(){return function(t){return t.getParam("draggable_modal",!1,"boolean")}(t)}},GO=function(t){return{isDraggableModal:jO(t)}},XO=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],qO=function(t){return Y(t,(function(t,n){if(yt(n,"items")){var e=qO(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(yt(n,"inline")||function(t){return yt(t,"block")}(n)||function(t){return yt(t,"selector")}(n)){var r="custom-"+(o(n.name)?n.name:n.title.toLowerCase());return{customFormats:t.customFormats.concat([{name:r,format:n}]),formats:t.formats.concat([{title:n.title,format:r,icon:n.icon}])}}return O(O({},t),{formats:t.formats.concat(n)})}),{customFormats:[],formats:[]})},YO=function(t){return function(t){return I.from(t.getParam("style_formats")).filter(i)}(t).map((function(n){var e=function(t,n){var e=qO(n),o=function(n){j(n,(function(n){t.formatter.has(n.name)||t.formatter.register(n.name,n.format)}))};return t.formatter?o(e.customFormats):t.on("init",(function(){o(e.customFormats)})),e.formats}(t,n);return function(t){return t.getParam("style_formats_merge",!1,"boolean")}(t)?XO.concat(e):e})).getOr(XO)},KO=function(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return no(t,o)},JO=function(t,n,e,r){var i=function(n){return U(n,(function(n){var u=ft(n);if(xt(n,"items")){var a=i(n.items);return no(function(t){return no(t,{type:"submenu"})}(n),{getStyleItems:h(a)})}return xt(n,"format")?function(t){return KO(t,e,r)}(n):1===u.length&&z(u,"title")?no(n,{type:"separator"}):function(n){var i=o(n.name)?n.name:Xi(n.title),u="custom-"+i,a={type:"formatter",format:u,isSelected:e(u),getStylePreview:r(u)},c=no(n,a);return t.formatter.register(i,c),c}(n)}))};return i(n)},$O=function(t){var n=function(n){return function(){return t.formatter.match(n)}},e=function(n){return function(){var e=t.formatter.get(n);return void 0!==e?I.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):I.none()}},o=function(t){var n=t.items;return void 0!==n&&n.length>0?Q(n,o):[t.format]},r=dr([]),i=dr([]),u=dr([]),a=dr([]),c=dr(!1);return t.on("PreInit",(function(u){var a=YO(t),c=JO(t,a,n,e);r.set(c),i.set(Q(c,o))})),t.on("addStyleModifications",(function(r){var i=JO(t,r.items,n,e);u.set(i),c.set(r.replace),a.set(Q(i,o))})),{getData:function(){var t=c.get()?[]:r.get(),n=u.get();return t.concat(n)},getFlattenedKeys:function(){var t=c.get()?[]:i.get(),n=a.get();return t.concat(n)}}},QO=fk.trim,ZO=function(t){return function(n){if(function(t){return f(t)&&1===t.nodeType}(n)){if(n.contentEditable===t)return!0;if(n.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},t_=ZO("true"),n_=ZO("false"),e_=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},o_=function(t){return t.innerText||t.textContent},r_=function(t){return function(t){return t&&"A"===t.nodeName&&void 0!==(t.id||t.name)}(t)&&u_(t)},i_=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},u_=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return t_(t)}return!1}(t)&&!n_(t)},a_=function(t){return i_(t)&&u_(t)},c_=function(t){var n=function(t){return t.id?t.id:Xi("h")}(t);return e_("header",o_(t),"#"+n,function(t){return i_(t)?parseInt(t.nodeName.substr(1),10):0}(t),(function(){t.id=n}))},s_=function(t){var n=t.id||t.name,e=o_(t);return e_("anchor",e||"#"+n,"#"+n,0,g)},f_=function(t){return QO(t.title).length>0},l_=function(t){var n=function(t){var n=U(_s(Rt(t),"h1,h2,h3,h4,h5,h6,a:not([href])"),(function(t){return t.dom}));return n}(t);return X(function(t){return U(X(t,a_),c_)}(n).concat(function(t){return U(X(t,r_),s_)}(n)),f_)},d_="tinymce-url-history",m_=function(t){return o(t)&&/^https?/.test(t)},g_=function(t){return r(t)&&ht(t,(function(t){return!(i(n=t)&&n.length<=5&&Z(n,m_));var n})).isNone()},p_=function(){var t,n=Jb.getItem(d_);if(null===n)return{};try{t=JSON.parse(n)}catch(t){if(t instanceof SyntaxError)return console.log("Local storage "+d_+" was not valid JSON",t),{};throw t}return g_(t)?t:(console.log("Local storage "+d_+" was not valid format",t),{})},h_=function(t){var n=p_();return bt(n,t).getOr([])},v_=function(t,n){if(m_(t)){var e=p_(),o=bt(e,n).getOr([]),r=X(o,(function(n){return n!==t}));e[n]=[t].concat(r).slice(0,5),function(t){if(!g_(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));Jb.setItem(d_,JSON.stringify(t))}(e)}},b_=function(t){return!!t},y_=function(t){return mt(fk.makeMap(t,/[, ]/),b_)},x_=function(t){return I.from(function(t){return t.getParam("file_picker_callback")}(t)).filter(l)},w_=function(t){return I.from(t).filter(o).getOrUndefined()},S_=function(t){return{getHistory:h_,addToHistory:v_,getLinkInformation:function(){return function(t){return function(t){return!1===t.getParam("typeahead_urls")}(t)?I.none():I.some({targets:l_(t.getBody()),anchorTop:w_(qv(t)),anchorBottom:w_(Yv(t))})}(t)},getValidationHandler:function(){return function(t){return I.from(function(t){var n=t.getParam("file_picker_validator_handler",void 0,"function");return void 0===n?t.getParam("filepicker_validator_handler",void 0,"function"):n}(t))}(t)},getUrlPicker:function(n){return function(t,n){return function(t,n){var e=function(t){var n=I.some(function(t){return t.getParam("file_picker_types")}(t)).filter(b_),e=I.some(function(t){return t.getParam("file_browser_callback_types")}(t)).filter(b_),o=n.or(e).map(y_);return x_(t).fold(S,(function(t){return o.fold(k,(function(t){return ft(t).length>0&&t}))}))}(t);return a(e)?e?x_(t):I.none():e[n]?x_(t):I.none()}(t,n).map((function(e){return function(i){return wx((function(u){var a=O({filetype:n,fieldname:i.fieldname},I.from(i.meta).getOr({}));e.call(t,(function(t,n){if(!o(t))throw new Error("Expected value to be string");if(void 0!==n&&!r(n))throw new Error("Expected meta to be a object");u({value:t,meta:n})}),i.value,a)}))}}))}(t,n)}}},k_=Ll,C_=Cl,O_=h([or("shell",!1),Lo("makeItem"),or("setupItem",g),Kf("listBehaviours",[Sg])]),__=wl({name:"items",overrides:function(){return{behaviours:Ja([Sg.config({})])}}}),T_=h([__]),E_=Yl({name:h("CustomList")(),configFields:O_(),partFields:T_(),factory:function(t,n,e,o){var r=t.shell?{behaviours:[Sg.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:r.components,behaviours:Yf(t.listBehaviours,r.behaviours),apis:{setItems:function(n,e){var o;(o=n,t.shell?I.some(o):Fl(o,t,"items")).fold((function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(o){var r=Sg.contents(o),i=e.length,u=i-r.length,a=u>0?L(u,(function(){return t.makeItem()})):[],c=r.slice(i);j(c,(function(t){return Sg.remove(o,t)})),j(a,(function(t){return Sg.append(o,t)}));var s=Sg.contents(o);j(s,(function(o,r){t.setupItem(n,o,e[r],r)}))}))}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),B_=h([Lo("dom"),or("shell",!0),Xf("toolbarBehaviours",[Sg])]),M_=h([wl({name:"groups",overrides:function(){return{behaviours:Ja([Sg.config({})])}}})]),A_=Yl({name:"Toolbar",configFields:B_(),partFields:M_(),factory:function(t,n,e,o){var r=t.shell?{behaviours:[Sg.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:r.components,behaviours:Yf(t.toolbarBehaviours,r.behaviours),apis:{setGroups:function(n,e){var o;(o=n,t.shell?I.some(o):Fl(o,t,"groups")).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(t){Sg.set(t,e)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),D_=g,F_=S,I_=h([]),R_=Object.freeze({__proto__:null,setup:D_,isDocked:F_,getBehaviours:I_}),V_=function(t){return(wt(re(t,"position"),"fixed")?I.none():Bn(t)).orThunk((function(){var n=Ft("span");return En(t).bind((function(t){Te(t,n);var e=Bn(n);return Me(n),e}))}))},P_=function(t){return V_(t).map(he).getOrThunk((function(){return ge(0,0)}))},H_=mr([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),z_=function(t,n){var e=t.element;wu(e,n.transitionClass),Su(e,n.fadeOutClass),wu(e,n.fadeInClass),n.onShow(t)},N_=function(t,n){var e=t.element;wu(e,n.transitionClass),Su(e,n.fadeInClass),wu(e,n.fadeOutClass),n.onHide(t)},L_=function(t,n,e){return Z(t,(function(t){switch(t){case"bottom":return function(t,n){return t.bottom<=n.bottom}(n,e);case"top":return function(t,n){return t.y>=n.y}(n,e)}}))},W_=function(t,n){return n.getInitialPos().map((function(n){return ze(n.bounds.x,n.bounds.y,ye(t),le(t))}))},U_=function(t,n,e){return e.getInitialPos().bind((function(o){switch(e.clearInitialPos(),o.position){case"static":return I.some(H_.static());case"absolute":var r=V_(t).map(Ne).getOrThunk((function(){return Ne(Wn())}));return I.some(H_.absolute(fc("absolute",bt(o.style,"left").map((function(t){return n.x-r.x})),bt(o.style,"top").map((function(t){return n.y-r.y})),bt(o.style,"right").map((function(t){return r.right-n.right})),bt(o.style,"bottom").map((function(t){return r.bottom-n.bottom})))));default:return I.none()}}))},j_=function(t,n,e){var o=t.element;return wt(re(o,"position"),"fixed")?function(t,n,e){return W_(t,e).filter((function(t){return L_(e.getModes(),t,n)})).bind((function(n){return U_(t,n,e)}))}(o,n,e):function(t,n,e){var o=Ne(t);if(L_(e.getModes(),o,n))return I.none();!function(t,n,e){e.setInitialPos({style:ie(t),position:ee(t,"position")||"static",bounds:n})}(t,o,e);var r=We(),i=o.x-r.x,u=n.y-r.y,a=r.bottom-n.bottom,c=o.y<=n.y;return I.some(H_.fixed(fc("fixed",I.some(i),c?I.some(u):I.none(),I.none(),c?I.none():I.some(a))))}(o,n,e)},G_=function(t,n,e){e.setDocked(!1),j(["left","right","top","bottom","position"],(function(n){return ae(t.element,n)})),n.onUndocked(t)},X_=function(t,n,e,o){var r="fixed"===o.position;e.setDocked(r),lc(t.element,o),(r?n.onDocked:n.onUndocked)(t)},q_=function(t,n,e,o,r){void 0===r&&(r=!1),n.contextual.each((function(n){n.lazyContext(t).each((function(i){var u=function(t,n){return t.y<n.bottom&&t.bottom>n.y}(i,o);u!==e.isVisible()&&(e.setVisible(u),r&&!u?(Cu(t.element,[n.fadeOutClass]),n.onHide(t)):(u?z_:N_)(t,n))}))}))},Y_=function(t,n,e){t.getSystem().isConnected()&&function(t,n,e){var o=n.lazyViewport(t);e.isDocked()&&q_(t,n,e,o),j_(t,o,e).each((function(r){r.fold((function(){return G_(t,n,e)}),(function(o){return X_(t,n,e,o)}),(function(r){q_(t,n,e,o,!0),X_(t,n,e,r)}))}))}(t,n,e)},K_=function(t,n,e){e.isDocked()&&function(t,n,e){var o=t.element;e.setDocked(!1),function(t,n){var e=t.element;return W_(e,n).bind((function(t){return U_(e,t,n)}))}(t,e).each((function(o){o.fold((function(){return G_(t,n,e)}),(function(o){return X_(t,n,e,o)}),g)})),e.setVisible(!0),n.contextual.each((function(n){Ou(o,[n.fadeInClass,n.fadeOutClass,n.transitionClass]),n.onShow(t)})),Y_(t,n,e)}(t,n,e)},J_=Object.freeze({__proto__:null,refresh:Y_,reset:K_,isDocked:function(t,n,e){return e.isDocked()},getModes:function(t,n,e){return e.getModes()},setModes:function(t,n,e,o){return e.setModes(o)}}),$_=Object.freeze({__proto__:null,events:function(t,n){return Ci([Ii(Wr(),(function(e,o){t.contextual.each((function(t){ku(e.element,t.transitionClass)&&(Ou(e.element,[t.transitionClass,t.fadeInClass]),(n.isVisible()?t.onShown:t.onHidden)(e)),o.stop()}))})),Ti(ui(),(function(e,o){Y_(e,t,n)})),Ti(ai(),(function(e,o){K_(e,t,n)}))])}}),Q_=[er("contextual",[jo("fadeInClass"),jo("fadeOutClass"),jo("transitionClass"),Xo("lazyContext"),ra("onShow"),ra("onShown"),ra("onHide"),ra("onHidden")]),sr("lazyViewport",We),fr("modes",["top","bottom"],Oo),ra("onDocked"),ra("onUndocked")],Z_=Qa({fields:Q_,name:"docking",active:$_,apis:J_,state:Object.freeze({__proto__:null,init:function(t){var n=dr(!1),e=dr(!0),o=Ec(),r=dr(t.modes);return su({isDocked:n.get,setDocked:n.set,getInitialPos:o.get,setInitialPos:o.set,clearInitialPos:o.clear,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}})}),tT=h(Xi("toolbar-height-change")),nT={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},eT="tox-tinymce--toolbar-sticky-on",oT="tox-tinymce--toolbar-sticky-off",rT=function(t,n){return z(Z_.getModes(t),n)},iT=function(t){var n=t.element;En(n).each((function(e){var o="padding-"+Z_.getModes(t)[0];if(Z_.isDocked(t)){var r=ye(e);Zn(n,"width",r+"px"),Zn(e,o,function(t){return de(t)+(parseInt(ee(t,"margin-top"),10)||0)+(parseInt(ee(t,"margin-bottom"),10)||0)}(n)+"px")}else ae(n,"width"),ae(e,o)}))},uT=function(t,n){n?(Su(t,nT.fadeOutClass),Cu(t,[nT.transitionClass,nT.fadeInClass])):(Su(t,nT.fadeInClass),Cu(t,[nT.fadeOutClass,nT.transitionClass]))},aT=function(t,n){var e=Rt(t.getContainer());n?(wu(e,eT),Su(e,oT)):(wu(e,oT),Su(e,eT))},cT=function(t,n){var e=Ec(),o=n.getSink,r=function(t){o().each((function(n){return t(n.element)}))},i=function(n){t.inline||iT(n),aT(t,Z_.isDocked(n)),n.getSystem().broadcastOn([Tf()],{}),o().each((function(t){return t.getSystem().broadcastOn([Tf()],{})}))},u=t.inline?[]:function(){var t;return[ec.config({channels:(t={},t[tT()]={onReceive:iT},t)})]}();return T([Eg.config({}),Z_.config({contextual:O({lazyContext:function(n){var e=de(n.element),o=t.inline?t.getContentAreaContainer():t.getContainer(),r=Ne(Rt(o)),i=r.height-e,u=r.y+(rT(n,"top")?0:e);return I.some(ze(r.x,u,r.width,i))},onShow:function(){r((function(t){return uT(t,!0)}))},onShown:function(t){r((function(t){return Ou(t,[nT.transitionClass,nT.fadeInClass])})),e.get().each((function(n){var o,r,i;o=t.element,i=Cn(r=n),ac(i).filter((function(t){return!Sn(r,t)})).filter((function(t){return Sn(t,Rt(i.dom.body))||kn(o,t)})).each((function(){return ic(r)})),e.clear()}))},onHide:function(t){(function(t,n){return cc(t).orThunk((function(){return n().toOptional().bind((function(t){return cc(t.element)}))}))})(t.element,o).fold(e.clear,e.set),r((function(t){return uT(t,!1)}))},onHidden:function(){r((function(t){return Ou(t,[nT.transitionClass])}))}},nT),lazyViewport:function(n){var e=We(),o=function(t){return t.getParam("toolbar_sticky_offset",0,"number")}(t),r=e.y+(rT(n,"top")?o:0),i=e.height-(rT(n,"bottom")?o:0);return ze(e.x,r,e.width,i)},modes:[n.header.getDockingMode()],onDocked:i,onUndocked:i})],u,!0)},sT=Object.freeze({__proto__:null,setup:function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",(function(){e().each(Z_.reset)})),t.on("ResizeWindow ResizeEditor",(function(){e().each(iT)})),t.on("SkinLoaded",(function(){e().each((function(t){Z_.isDocked(t)?Z_.reset(t):Z_.refresh(t)}))})),t.on("FullscreenStateChanged",(function(){e().each(Z_.reset)}))),t.on("AfterScrollIntoView",(function(t){e().each((function(n){Z_.refresh(n);var e=n.element;fm(e)&&function(t,n){var e=Cn(n),o=e.dom.defaultView.innerHeight,r=De(e),i=Rt(t.elm),u=Le(i),a=le(i),c=u.y,s=c+a,f=he(n),l=le(n),d=f.top,m=d+l,g=Math.abs(d-r.top)<2,p=Math.abs(m-(r.top+o))<2;if(g&&c<m)Fe(r.left,c-l,e);else if(p&&s>d){var h=c-o+a+l;Fe(r.left,h,e)}}(t,e)}))})),t.on("PostRender",(function(){aT(t,!1)}))},isDocked:function(t){return t().map(Z_.isDocked).getOr(!1)},getBehaviours:cT}),fT=vo([jo("type"),Wo("items",yo([wo([jo("name"),Ko("items",Oo)]),Oo]))].concat(fh)),lT=[Zo("text"),Zo("tooltip"),Zo("icon"),Xo("fetch"),sr("onSetup",(function(){return g}))],dT=vo(T([jo("type")],lT,!0)),mT=function(t){return Fo("menubutton",dT,t)},gT=vo([jo("type"),Zo("tooltip"),Zo("icon"),Zo("text"),tr("select"),Xo("fetch"),sr("onSetup",(function(){return g})),ar("presets","normal",["normal","color","listpreview"]),or("columns",1),Xo("onAction"),Xo("onItemAction")]),pT=ql({factory:function(t,n){var e={focus:hg.focusIn,setMenus:function(t,e){var o=U(e,(function(t){var e={type:"menubutton",text:t.text,fetch:function(n){n(t.getItems())}},o=mT(e).mapError((function(t){return Vo(t)})).getOrDie();return bC(o,"tox-mbtn",n.backstage,I.some("menuitem"))}));Sg.set(t,o)}};return{uid:t.uid,dom:t.dom,components:[],behaviours:Ja([Sg.config({}),kg("menubar-events",[Ri((function(n){t.onSetup(n)})),Ti(Fr(),(function(t,n){Uu(t.element,".tox-mbtn--active").each((function(e){ju(n.event.target,".tox-mbtn").each((function(n){Sn(e,n)||t.getSystem().getByDom(e).each((function(e){t.getSystem().getByDom(n).each((function(t){Zx.expand(t),Zx.close(e),Eg.focus(t)}))}))}))}))})),Ti(di(),(function(t,n){n.event.prevFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(e){n.event.newFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(t){Zx.isOpen(e)&&(Zx.expand(t),Zx.close(e))}))}))}))]),hg.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),I.some(!0)}}),qy.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Lo("dom"),Lo("uid"),Lo("onEscape"),Lo("backstage"),or("onSetup",g)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),hT=function(t,n){return n.getAnimationRoot.fold((function(){return t.element}),(function(n){return n(t)}))},vT=function(t){return t.dimension.property},bT=function(t,n){return t.dimension.getDimension(n)},yT=function(t,n){var e=hT(t,n);Ou(e,[n.shrinkingClass,n.growingClass])},xT=function(t,n){Su(t.element,n.openClass),wu(t.element,n.closedClass),Zn(t.element,vT(n),"0px"),ce(t.element)},wT=function(t,n){Su(t.element,n.closedClass),wu(t.element,n.openClass),ae(t.element,vT(n))},ST=function(t,n,e,o){e.setCollapsed(),Zn(t.element,vT(n),bT(n,t.element)),ce(t.element),yT(t,n),xT(t,n),n.onStartShrink(t),n.onShrunk(t)},kT=function(t,n,e,o){var r=o.getOrThunk((function(){return bT(n,t.element)}));e.setCollapsed(),Zn(t.element,vT(n),r),ce(t.element);var i=hT(t,n);Su(i,n.growingClass),wu(i,n.shrinkingClass),xT(t,n),n.onStartShrink(t)},CT=function(t,n,e){var o=bT(n,t.element);("0px"===o?ST:kT)(t,n,e,I.some(o))},OT=function(t,n,e){var o=hT(t,n),r=ku(o,n.shrinkingClass),i=bT(n,t.element);wT(t,n);var u=bT(n,t.element);(r?function(){Zn(t.element,vT(n),i),ce(t.element)}:function(){xT(t,n)})(),Su(o,n.shrinkingClass),wu(o,n.growingClass),wT(t,n),Zn(t.element,vT(n),u),e.setExpanded(),n.onStartGrow(t)},_T=function(t,n,e){var o=hT(t,n);return!0===ku(o,n.growingClass)},TT=function(t,n,e){var o=hT(t,n);return!0===ku(o,n.shrinkingClass)},ET=Object.freeze({__proto__:null,refresh:function(t,n,e){if(e.isExpanded()){ae(t.element,vT(n));var o=bT(n,t.element);Zn(t.element,vT(n),o)}},grow:function(t,n,e){e.isExpanded()||OT(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&CT(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&ST(t,n,e)},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:_T,isShrinking:TT,isTransitioning:function(t,n,e){return _T(t,n)||TT(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?CT:OT)(t,n,e)},disableTransitions:yT}),BT=Object.freeze({__proto__:null,exhibit:function(t,n,e){var o=n.expanded;return lu(o?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:hr(n.dimension.property,"0px")})},events:function(t,n){return Ci([Ii(Wr(),(function(e,o){o.event.raw.propertyName===t.dimension.property&&(yT(e,t),n.isExpanded()&&ae(e.element,t.dimension.property),(n.isExpanded()?t.onGrown:t.onShrunk)(e))}))])}}),MT=[Lo("closedClass"),Lo("openClass"),Lo("shrinkingClass"),Lo("growingClass"),Jo("getAnimationRoot"),ra("onShrunk"),ra("onStartShrink"),ra("onGrown"),ra("onStartGrow"),or("expanded",!1),Wo("dimension",Po("property",{width:[ca("property","width"),ca("getDimension",(function(t){return ye(t)+"px"}))],height:[ca("property","height"),ca("getDimension",(function(t){return le(t)+"px"}))]}))],AT=Qa({fields:MT,name:"sliding",active:BT,apis:ET,state:Object.freeze({__proto__:null,init:function(t){var n=dr(t.expanded);return su({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:y(n.set,!1),setExpanded:y(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),DT="container",FT=[Xf("slotBehaviours",[])],IT=function(t){return"<alloy.field."+t+">"},RT=function(t,n){var e,o=function(n){return Pl(t)},r=function(n,e){return function(o,r){return Fl(o,t,r).map((function(t){return n(t,r)})).getOr(e)}},i=function(t,n){return"true"!==qn(t.element,"aria-hidden")},u=r(i,!1),a=r((function(t,n){if(i(t)){var e=t.element;Zn(e,"display","none"),Gn(e,"aria-hidden","true"),yi(t,mi(),{name:n,visible:!1})}})),c=(e=a,function(t,n){j(n,(function(n){return e(t,n)}))}),s=r((function(t,n){if(!i(t)){var e=t.element;ae(e,"display"),Jn(e,"aria-hidden"),yi(t,mi(),{name:n,visible:!0})}})),f={getSlotNames:o,getSlot:function(n,e){return Fl(n,t,e)},isShowing:u,hideSlot:a,hideAllSlots:function(t){return c(t,o())},showSlot:s};return{uid:t.uid,dom:t.dom,components:n,behaviours:qf(t.slotBehaviours),apis:f}},VT=mt({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},(function(t){return au(t)})),PT=O(O({},VT),{sketch:function(t){var n=function(){var t=[];return{slot:function(n,e){return t.push(n),El(DT,IT(n),e)},record:h(t)}}(),e=t(n),o=n.record(),r=U(o,(function(t){return yl({name:t,pname:IT(t)})}));return Ul(DT,FT,r,RT,e)}}),HT=vo([Zo("icon"),Zo("tooltip"),sr("onShow",g),sr("onHide",g),sr("onSetup",(function(){return g}))]),zT=function(t){return{element:function(){return t.element.dom}}},NT=function(t,n){var e=U(ft(n),(function(t){var e=n[t],o=Io(function(t){return Fo("sidebar",HT,t)}(e));return{name:t,getApi:zT,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}));return U(e,(function(n){var o=dr(g);return t.slot(n.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:mv([rb(n,o),ib(n,o),Ti(mi(),(function(t,n){var o=n.event,r=K(e,(function(t){return t.name===o.name}));r.each((function(n){(o.visible?n.onShow:n.onHide)(n.getApi(t))}))}))])})}))},LT=function(t){return PT.sketch((function(n){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:NT(n,t),slotBehaviours:mv([Ri((function(t){return PT.hideAllSlots(t)}))])}}))},WT=function(t){return Ql.getCurrent(t).bind((function(t){return AT.isGrowing(t)||AT.hasGrown(t)?Ql.getCurrent(t).bind((function(t){return K(PT.getSlotNames(t),(function(n){return PT.isShowing(t,n)}))})):I.none()}))},UT=Xi("FixSizeEvent"),jT=Xi("AutoSizeEvent"),GT=Object.freeze({__proto__:null,block:function(t,n,e,o){Gn(t.element,"aria-busy",!0);var r=n.getRoot(t).getOr(t),i=Ja([hg.config({mode:"special",onTab:function(){return I.some(!0)},onShiftTab:function(){return I.some(!0)}}),Eg.config({})]),u=o(r,i),a=r.getSystem().build(u);Sg.append(r,Ru(a)),a.hasConfigured(hg)&&n.focus&&hg.focusIn(a),e.isBlocked()||n.onBlock(t),e.blockWith((function(){return Sg.remove(r,a)}))},unblock:function(t,n,e){Jn(t.element,"aria-busy"),e.isBlocked()&&n.onUnblock(t),e.clear()}}),XT=[sr("getRoot",I.none),cr("focus",!0),ra("onBlock"),ra("onUnblock")],qT=Qa({fields:XT,name:"blocking",apis:GT,state:Object.freeze({__proto__:null,init:function(){var t=_c();return su({readState:t.isSet,blockWith:function(n){t.set({destroy:n})},clear:t.clear,isBlocked:t.isSet})}})}),YT=function(t){var n=Dt(t),e=Mn(n),o=function(t){var n=void 0!==t.dom.attributes?t.dom.attributes:[];return Y(n,(function(t,n){var e;return"class"===n.name?t:O(O({},t),((e={})[n.name]=n.value,e))}),{})}(n),r=function(t){return Array.prototype.slice.call(t.dom.classList,0)}(n),i=0===e.length?{}:{innerHtml:zi(n)};return O({tag:Pt(n),classes:r,attributes:o},i)},KT=function(t){return Ql.getCurrent(t).each((function(t){return ic(t.element)}))},JT=function(t,n,e){var o=dr(!1),r=Ec(),i=function(e){var r;!o.get()||function(t){return"focusin"===t.type}(r=e)&&(r.composed?ut(r.composedPath()):I.from(r.target)).map(Rt).filter(zt).exists((function(t){return ku(t,"mce-pastebin")}))||(e.preventDefault(),KT(n()),t.editorManager.setActive(t))};t.inline||t.on("PreInit",(function(){t.dom.bind(t.getWin(),"focusin",i),t.on("BeforeExecCommand",(function(t){"mcefocus"===t.command.toLowerCase()&&!0!==t.value&&i(t)}))}));var u=function(r){r!==o.get()&&(o.set(r),function(t,n,e,o){var r=n.element;if(function(t,n){var e="tabindex",o="data-mce-tabindex";I.from(t.iframeElement).map(Rt).each((function(t){n?(Yn(t,e).each((function(n){return Gn(t,o,n)})),Gn(t,e,-1)):(Jn(t,e),Yn(t,o).each((function(n){Gn(t,e,n),Jn(t,o)})))}))}(t,e),e)qT.block(n,function(t){return function(n,e){return{dom:{tag:"div",attributes:{"aria-label":t.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:YT('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}}(o)),ae(r,"display"),Jn(r,"aria-hidden"),t.hasFocus()&&KT(n);else{var i=Ql.getCurrent(n).exists((function(t){return uc(t.element)}));qT.unblock(n),Zn(r,"display","none"),Gn(r,"aria-hidden","true"),i&&t.focus()}}(t,n(),r,e.providers),t.fire("AfterProgressState",{state:r}))};t.on("ProgressState",(function(n){if(r.on(Ap.clearTimeout),d(n.time)){var e=Ap.setEditorTimeout(t,(function(){return u(n.state)}),n.time);r.set(e)}else u(n.state),r.clear()}))},$T=function(t,n,e){return{within:t,extra:n,withinWidth:e}},QT=function(t,n,e){var o=Y(t,(function(t,n){return(o=n,r=t.len,i=e(o),I.some({element:o,start:r,finish:r+i,width:i})).fold(h(t),(function(n){return{len:n.finish,list:t.list.concat([n])}}));var o,r,i}),{len:0,list:[]}).list,r=X(o,(function(t){return t.finish<=n})),i=q(r,(function(t,n){return t+n.width}),0);return{within:r,extra:o.slice(r.length),withinWidth:i}},ZT=function(t){return U(t,(function(t){return t.element}))},tE=function(t,n){var e=U(n,(function(t){return Ru(t)}));A_.setGroups(t,e)},nE=function(t,n,e){var o=n.builtGroups.get();if(0!==o.length){var r=Il(t,n,"primary"),i=Vx.getCoupled(t,"overflowGroup");Zn(r.element,"visibility","hidden");var u=o.concat([i]),a=st(u,(function(t){return cc(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))}));e([]),tE(r,u);var c=function(t,n,e,o){var r=function(t,n,e){var o=QT(n,t,e);return 0===o.extra.length?I.some(o):I.none()}(t,n,e).getOrThunk((function(){return QT(n,t-e(o),e)})),i=r.within,u=r.extra,a=r.withinWidth;return 1===u.length&&u[0].width<=e(o)?function(t,n,e){var o=ZT(t.concat(n));return $T(o,[],e)}(i,u,a):u.length>=1?function(t,n,e,o){var r=ZT(t).concat([e]);return $T(r,ZT(n),o)}(i,u,o,a):function(t,n,e){return $T(ZT(t),[],e)}(i,0,a)}(ye(r.element),n.builtGroups.get(),(function(t){return ye(t.element)}),i);0===c.extra.length?(Sg.remove(r,i),e([])):(tE(r,c.within),e(c.extra)),ae(r.element,"visibility"),ce(r.element),a.each(Eg.focus)}},eE=h([Xf("splitToolbarBehaviours",[Vx]),zo("builtGroups",(function(){return dr([])}))]),oE=h([ea(["overflowToggledClass"]),tr("getOverflowBounds"),Lo("lazySink"),zo("overflowGroups",(function(){return dr([])}))].concat(eE())),rE=h([yl({factory:A_,schema:B_(),name:"primary"}),xl({schema:B_(),name:"overflow"}),xl({name:"overflow-button"}),xl({name:"overflow-group"})]),iE=h((function(t,n){!function(t,n){var e=be.max(t,n,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);Zn(t,"max-width",e+"px")}(t,Math.floor(n))})),uE=h([ea(["toggledClass"]),Lo("lazySink"),Xo("fetch"),tr("getBounds"),er("fireDismissalEventInstead",[or("event",fi())]),Kc()]),aE=h([xl({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:Ja([Ng.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),xl({factory:A_,schema:B_(),name:"toolbar",overrides:function(t){return{toolbarBehaviours:Ja([hg.config({mode:"cyclic",onEscape:function(n){return Fl(n,t,"button").each(Eg.focus),I.none()}})])}}})]),cE=function(t,n){var e=Vx.getCoupled(t,"toolbarSandbox");Of.isOpen(e)?Of.close(e):Of.open(e,n.toolbar())},sE=function(t,n,e,o){var r=e.getBounds.map((function(t){return t()})),i=e.lazySink(t).getOrDie();nf.positionWithinBounds(i,n,{anchor:{type:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:iE()}}},r)},fE=function(t,n,e,o,r){A_.setGroups(n,r),sE(t,n,e,o),Ng.on(t)},lE=Yl({name:"FloatingToolbarButton",factory:function(t,n,e,o){return O(O({},Dp.sketch(O(O({},o.button()),{action:function(t){cE(t,o)},buttonBehaviours:Jf({dump:o.button().buttonBehaviours},[Vx.config({others:{toolbarSandbox:function(n){return function(t,n,e){var o=Gu();return{dom:{tag:"div",attributes:{id:o.id}},behaviours:Ja([hg.config({mode:"special",onEscape:function(t){return Of.close(t),I.some(!0)}}),Of.config({onOpen:function(r,i){e.fetch().get((function(r){fE(t,i,e,n.layouts,r),o.link(t.element),hg.focusIn(i)}))},onClose:function(){Ng.off(t),Eg.focus(t),o.unlink(t.element)},isPartOf:function(n,e,o){return Xu(e,o)||Xu(t,o)},getAttachPoint:function(){return e.lazySink(t).getOrDie()}}),ec.config({channels:O(O({},Mf(O({isExtraPart:S},e.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),Df({doReposition:function(){Of.getState(Vx.getCoupled(t,"toolbarSandbox")).each((function(o){sE(t,o,e,n.layouts)}))}}))})])}}(n,e,t)}}})])}))),{apis:{setGroups:function(n,o){Of.getState(Vx.getCoupled(n,"toolbarSandbox")).each((function(r){fE(n,r,t,e.layouts,o)}))},reposition:function(n){Of.getState(Vx.getCoupled(n,"toolbarSandbox")).each((function(o){sE(n,o,t,e.layouts)}))},toggle:function(t){cE(t,o)},getToolbar:function(t){return Of.getState(Vx.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return Of.isOpen(Vx.getCoupled(t,"toolbarSandbox"))}}})},configFields:uE(),partFields:aE(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),dE=h([Lo("items"),ea(["itemSelector"]),Xf("tgroupBehaviours",[hg])]),mE=h([Sl({name:"items",unit:"item"})]),gE=Yl({name:"ToolbarGroup",configFields:dE(),partFields:mE(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:Yf(t.tgroupBehaviours,[hg.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),pE=function(t){return U(t,(function(t){return Ru(t)}))},hE=function(t,n,e){nE(t,e,(function(o){e.overflowGroups.set(o),n.getOpt(t).each((function(t){lE.setGroups(t,pE(o))}))}))},vE=Yl({name:"SplitFloatingToolbar",configFields:oE(),partFields:rE(),factory:function(t,n,e,o){var r=Fp(lE.sketch({fetch:function(){return wx((function(n){n(pE(t.overflowGroups.get()))}))},layouts:{onLtr:function(){return[Da,Aa]},onRtl:function(){return[Aa,Da]},onBottomLtr:function(){return[Ia,Fa]},onBottomRtl:function(){return[Fa,Ia]}},getBounds:e.getOverflowBounds,lazySink:t.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:t.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:t.uid,dom:t.dom,components:n,behaviours:Yf(t.splitToolbarBehaviours,[Vx.config({others:{overflowGroup:function(){return gE.sketch(O(O({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(n,e){t.builtGroups.set(U(e,n.getSystem().build)),hE(n,r,t)},refresh:function(n){return hE(n,r,t)},toggle:function(t){r.getOpt(t).each((function(t){lE.toggle(t)}))},isOpen:function(t){return r.getOpt(t).map(lE.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each((function(t){lE.reposition(t)}))},getOverflow:function(t){return r.getOpt(t).bind(lE.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),bE=h([ea(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),ra("onOpened"),ra("onClosed")].concat(eE())),yE=h([yl({factory:A_,schema:B_(),name:"primary"}),yl({factory:A_,schema:B_(),name:"overflow",overrides:function(t){return{toolbarBehaviours:Ja([AT.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(n){Fl(n,t,"overflow-button").each((function(t){Ng.off(t),Eg.focus(t)})),t.onClosed(n)},onGrown:function(n){hg.focusIn(n),t.onOpened(n)},onStartGrow:function(n){Fl(n,t,"overflow-button").each(Ng.on)}}),hg.config({mode:"acyclic",onEscape:function(n){return Fl(n,t,"overflow-button").each(Eg.focus),I.some(!0)}})])}}}),xl({name:"overflow-button",overrides:function(t){return{buttonBehaviours:Ja([Ng.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),xl({name:"overflow-group"})]),xE=function(t,n){Fl(t,n,"overflow-button").bind((function(){return Fl(t,n,"overflow")})).each((function(e){wE(t,n),AT.toggleGrow(e)}))},wE=function(t,n){Fl(t,n,"overflow").each((function(e){nE(t,n,(function(t){var n=U(t,(function(t){return Ru(t)}));A_.setGroups(e,n)})),Fl(t,n,"overflow-button").each((function(t){AT.hasGrown(e)&&Ng.on(t)})),AT.refresh(e)}))},SE=Yl({name:"SplitSlidingToolbar",configFields:bE(),partFields:yE(),factory:function(t,n,e,o){var r="alloy.toolbar.toggle";return{uid:t.uid,dom:t.dom,components:n,behaviours:Yf(t.splitToolbarBehaviours,[Vx.config({others:{overflowGroup:function(t){return gE.sketch(O(O({},o["overflow-group"]()),{items:[Dp.sketch(O(O({},o["overflow-button"]()),{action:function(n){bi(t,r)}}))]}))}}}),kg("toolbar-toggle-events",[Ti(r,(function(n){xE(n,t)}))])]),apis:{setGroups:function(n,e){!function(n,e){var o=U(e,n.getSystem().build);t.builtGroups.set(o)}(n,e),wE(n,t)},refresh:function(n){return wE(n,t)},toggle:function(n){return xE(n,t)},isOpen:function(n){return function(t,n){return Fl(t,n,"overflow").map(AT.hasGrown).getOr(!1)}(n,t)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),kE=function(t){var n=t.title.fold((function(){return{}}),(function(t){return{attributes:{title:t}}}));return{dom:O({tag:"div",classes:["tox-toolbar__group"]},n),components:[gE.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:Ja([qy.config({}),Eg.config({})])}},CE=function(t){return gE.sketch(kE(t))},OE=function(t,n){var e=Ri((function(n){var e=U(t.initGroups,CE);A_.setGroups(n,e)}));return Ja([eb(t.providers.isDisabled),Zv(),hg.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),kg("toolbar-events",[e])])},_E=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":kE({title:I.none(),items:[]}),"overflow-button":wC({name:"more",icon:I.some("more-drawer"),disabled:!1,tooltip:I.some("More..."),primary:!1,borderless:!1},I.none(),t.providers)},splitToolbarBehaviours:OE(t,n)}},TE=function(t){var n=_E(t),e=vE.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return vE.sketch(O(O({},n),{lazySink:t.getSink,getOverflowBounds:function(){var n=t.moreDrawerData.lazyHeader().element,e=Le(n),o=_n(n),r=Le(o),i=Math.max(o.dom.scrollHeight,r.height);return ze(e.x+4,r.y,e.width-8,i)},parts:O(O({},n.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:t.attributes}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},EE=function(t){var n=SE.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=SE.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=_E(t);return SE.sketch(O(O({},o),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([tT()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([tT()],{type:"closed"})}}))},BE=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return A_.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===Ch.scrolling?["tox-toolbar--scrolling"]:[])},components:[A_.parts.groups({})],toolbarBehaviours:OE(t,n)})},ME=C_.optional({factory:pT,name:"menubar",schema:[Lo("backstage")]}),AE=C_.optional({factory:{sketch:function(t){return E_.sketch({uid:t.uid,dom:t.dom,listBehaviours:Ja([hg.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return BE({type:t.type,uid:Xi("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),I.some(!0)}})},setupItem:function(t,n,e,o){A_.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[Lo("dom"),Lo("onEscape")]}),DE=C_.optional({factory:{sketch:function(t){var n=function(t){return t.type===Ch.sliding?EE:t.type===Ch.floating?TE:BE}(t);return n({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),I.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[Lo("dom"),Lo("onEscape"),Lo("getSink")]}),FE=C_.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?cT:I_;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:Ja(e(n,t.sharedBackstage))}}},name:"header",schema:[Lo("dom")]}),IE=C_.optional({name:"socket",schema:[Lo("dom")]}),RE=C_.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:Ja([qy.config({}),Eg.config({}),AT.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){Ql.getCurrent(t).each(PT.hideAllSlots),bi(t,jT)},onGrown:function(t){bi(t,jT)},onStartGrow:function(t){yi(t,UT,{width:re(t.element,"width").getOr("")})},onStartShrink:function(t){yi(t,UT,{width:ye(t.element)+"px"})}}),Sg.config({}),Ql.config({find:function(t){var n=Sg.contents(t);return ut(n)}})])}],behaviours:Ja([uk(0),kg("sidebar-sliding-events",[Ti(UT,(function(t,n){Zn(t.element,"width",n.event.width)})),Ti(jT,(function(t,n){ae(t.element,"width")}))])])}}},name:"sidebar",schema:[Lo("dom")]}),VE=C_.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:Ja([Sg.config({}),qT.config({focus:!1}),Ql.config({find:function(t){return ut(t.components())}})]),components:[]}}},name:"throbber",schema:[Lo("dom")]}),PE=Yl({name:"OuterContainer",factory:function(t,n,e){var o={getSocket:function(n){return k_.getPart(n,t,"socket")},setSidebar:function(n,e){k_.getPart(n,t,"sidebar").each((function(t){return function(t,n){Ql.getCurrent(t).each((function(t){return Sg.set(t,[LT(n)])}))}(t,e)}))},toggleSidebar:function(n,e){k_.getPart(n,t,"sidebar").each((function(t){return function(t,n){Ql.getCurrent(t).each((function(t){Ql.getCurrent(t).each((function(e){AT.hasGrown(t)?PT.isShowing(e,n)?AT.shrink(t):(PT.hideAllSlots(e),PT.showSlot(e,n)):(PT.hideAllSlots(e),PT.showSlot(e,n),AT.grow(t))}))}))}(t,e)}))},whichSidebar:function(n){return k_.getPart(n,t,"sidebar").bind(WT).getOrNull()},getHeader:function(n){return k_.getPart(n,t,"header")},getToolbar:function(n){return k_.getPart(n,t,"toolbar")},setToolbar:function(n,e){k_.getPart(n,t,"toolbar").each((function(t){t.getApis().setGroups(t,e)}))},setToolbars:function(n,e){k_.getPart(n,t,"multiple-toolbar").each((function(t){E_.setItems(t,e)}))},refreshToolbar:function(n){k_.getPart(n,t,"toolbar").each((function(t){return t.getApis().refresh(t)}))},toggleToolbarDrawer:function(n){k_.getPart(n,t,"toolbar").each((function(t){var n,e;e=function(n){return n(t)},null!=(n=t.getApis().toggle)?I.some(e(n)):I.none()}))},isToolbarDrawerToggled:function(n){return k_.getPart(n,t,"toolbar").bind((function(t){return I.from(t.getApis().isOpen).map((function(n){return n(t)}))})).getOr(!1)},getThrobber:function(n){return k_.getPart(n,t,"throbber")},focusToolbar:function(n){k_.getPart(n,t,"toolbar").orThunk((function(){return k_.getPart(n,t,"multiple-toolbar")})).each((function(t){hg.focusIn(t)}))},setMenubar:function(n,e){k_.getPart(n,t,"menubar").each((function(t){pT.setMenus(t,e)}))},focusMenubar:function(n){k_.getPart(n,t,"menubar").each((function(t){pT.focus(t)}))}};return{uid:t.uid,dom:t.dom,components:n,apis:o,behaviours:t.behaviours}},configFields:[Lo("dom"),Lo("behaviours")],partFields:[FE,ME,DE,AE,IE,RE,VE],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=U(e,(function(t){return CE(t)}));t.setToolbar(n,o)},setToolbars:function(t,n,e){var o=U(e,(function(t){return U(t,CE)}));t.setToolbars(n,o)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),HE={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},zE=function(t){return"string"==typeof t?t.split(" "):t},NE=function(t,n){var e=O(O({},HE),n.menus),o=ft(n.menus).length>0,r=void 0===n.menubar||!0===n.menubar?zE("file edit view insert format tools table help"):zE(!1===n.menubar?"":n.menubar),i=X(r,(function(t){var e=yt(HE,t);return o?e||bt(n.menus,t).exists((function(t){return yt(t,"items")})):e})),u=U(i,(function(o){var r=e[o];return function(t,n,e){var o=function(t){return t.getParam("removed_menuitems","")}(e).split(/[ ,]/);return{text:t.title,getItems:function(){return Q(t.items,(function(t){var e=t.toLowerCase();return 0===e.trim().length||N(o,(function(t){return t===e}))?[]:"separator"===e||"|"===e?[{type:"separator"}]:n.menuItems[e]?[n.menuItems[e]]:[]}))}}}({title:r.title,items:zE(r.items)},n,t)}));return X(u,(function(t){return t.getItems().length>0&&N(t.getItems(),(function(t){return"separator"!==t.type}))}))},LE=function(t){var n=function(){t._skinLoaded=!0,function(t){t.fire("SkinLoaded")}(t)};return function(){t.initialized?n():t.on("init",n)}},WE=function(t,n,e){return new eh((function(o,r){e.load(n,o,r),t.on("remove",(function(){return e.unload(n)}))}))},UE=function(t,n){return WE(t,n+"/skin.min.css",t.ui.styleSheetLoader)},jE=function(t,n){var e;return e=Rt(t.getElement()),zn(e).isSome()?WE(t,n+"/skin.shadowdom.min.css",Sv.DOM.styleSheetLoader):eh.resolve()},GE=function(t,n){var e=function(t){var n=t.getParam("skin"),e=t.getParam("skin_url");if(!1!==n){var o=n||"oxide";e=e?t.documentBaseURI.toAbsolute(e):kv.baseURL+"/skins/ui/"+o}return e}(n);e&&n.contentCSS.push(e+(t?"/content.inline":"/content")+".min.css"),!1===function(t){return!1===t.getParam("skin")}(n)&&o(e)?eh.all([UE(n,e),jE(n,e)]).then(LE(n),function(t,n){return function(){return function(t,n){return t.fire("SkinLoadError",n)}(t,{message:"Skin could not be loaded"})}}(n)):LE(n)()},XE=y(GE,!1),qE=y(GE,!0),YE=function(t,n){return function(e){var o=Tc(),r=function(){e.setActive(t.formatter.match(n));var r=t.formatter.formatChanged(n,e.setActive);o.set(r)};return t.initialized?r():t.once("init",r),function(){t.off("init",r),o.clear()}}},KE=function(t,n,e){return function(o){var r=function(){return e(o)},i=function(){e(o),t.on(n,r)};return t.initialized?i():t.once("init",i),function(){t.off("init",i),t.off(n,r)}}},JE=function(t){return function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)}))}}},$E=function(t,n){return function(){return t.execCommand(n)}},QE=function(t,n,e){var o=function(t,o,i,u){var a=n.shared.providers.translate(t.title);if("separator"===t.type)return I.some({type:"separator",text:a});if("submenu"===t.type){var c=Q(t.getStyleItems(),(function(t){return r(t,o,u)}));return 0===o&&c.length<=0?I.none():I.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return Q(t.getStyleItems(),(function(t){return r(t,o,u)}))}})}return I.some(O({type:"togglemenuitem",text:a,icon:t.icon,active:t.isSelected(u),disabled:i,onAction:e.onAction(t)},t.getStylePreview().fold((function(){return{}}),(function(t){return{meta:{style:t}}}))))},r=function(t,n,r){var i="formatter"===t.type&&e.isInvalid(t);return 0===n?i?[]:o(t,n,!1,r).toArray():o(t,n,i,r).toArray()},i=function(t){var n=e.getCurrentValue(),o=e.shouldHide?0:1;return Q(t,(function(t){return r(t,o,n)}))};return{validateItems:i,getFetch:function(t,n){return function(e,o){var r=n(),u=i(r);o(hC(u,Oh.CLOSE_ON_EXECUTE,t,!1))}}}},ZE=function(t,n,e){var o=e.dataset,r="basic"===o.type?function(){return U(o.data,(function(t){return KO(t,e.isSelectedFor,e.getPreviewFor)}))}:o.getData;return{items:QE(0,n,e),getStyleItems:r}},tB=function(t,n,e){var o=ZE(0,n,e),r=o.items,i=o.getStyleItems,u=KE(t,"NodeChange",(function(t){var n=t.getComponent();e.updateText(n)}));return dC({text:e.icon.isSome()?I.none():e.text,icon:e.icon,tooltip:I.from(e.tooltip),role:I.none(),fetch:r.getFetch(n,i),onSetup:u,getApi:function(t){return{getComponent:h(t)}},columns:1,presets:"normal",classes:e.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",n.shared)};!function(t){t[t.SemiColon=0]="SemiColon",t[t.Space=1]="Space"}(GC||(GC={}));var nB,eB,oB,rB,iB=function(t,n,e,o){var r,i=(r=function(t,n){return n===GC.SemiColon?t.replace(/;$/,"").split(";"):t.split(" ")}(t.getParam(n,e,"string"),o),U(r,(function(t){var n=t,e=t,o=t.split("=");return o.length>1&&(n=o[0],e=o[1]),{title:n,format:e}})));return{type:"basic",data:i}},uB=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],aB=function(t){var n={type:"basic",data:uB};return{tooltip:"Align",text:I.none(),icon:I.some("align-left"),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:I.none,getPreviewFor:function(t){return I.none},onAction:function(n){return function(){return K(uB,(function(t){return t.format===n.format})).each((function(n){return t.execCommand(n.command)}))}},updateText:function(n){var e=K(uB,(function(n){return t.formatter.match(n.format)})).fold(h("left"),(function(t){return t.title.toLowerCase()}));yi(n,lC,{icon:"align-"+e})},dataset:n,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},cB=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],sB=function(t){var n=t.split(/\s*,\s*/);return U(n,(function(t){return t.replace(/^['"]+|['"]+$/g,"")}))},fB=function(t){var n="System Font",e=function(){var e=function(t){return t?sB(t)[0]:""},r=t.queryCommandValue("FontName"),i=o.data,u=r?r.toLowerCase():"",a=K(i,(function(t){var n=t.format;return n.toLowerCase()===u||e(n).toLowerCase()===e(u).toLowerCase()})).orThunk((function(){return Ct(function(t){var n;return 0===t.indexOf("-apple-system")&&(n=sB(t.toLowerCase()),Z(cB,(function(t){return n.indexOf(t.toLowerCase())>-1})))}(u),{title:n,format:u})}));return{matchOpt:a,font:r}},o=iB(t,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",GC.SemiColon);return{tooltip:"Fonts",text:I.some(n),icon:I.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getCurrentValue:function(){return e().matchOpt},getPreviewFor:function(t){return function(){return I.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontName",!1,n.format)}))}},updateText:function(t){var n=e(),o=n.matchOpt,r=n.font,i=o.fold(h(r),(function(t){return t.title}));yi(t,fC,{text:i})},dataset:o,shouldHide:!1,isInvalid:S}},lB={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},dB={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},mB=function(t){var n=function(){var n=I.none(),e=o.data,r=t.queryCommandValue("FontSize");if(r)for(var i=function(t){var o=function(t,n){return/[0-9.]+px$/.test(t)?function(t,n){var e=Math.pow(10,n);return Math.round(t*e)/e}(72*parseInt(t,10)/96,n||0)+"pt":bt(dB,t).getOr(t)}(r,t),i=function(t){return bt(lB,t).getOr("")}(o);n=K(e,(function(t){return t.format===r||t.format===o||t.format===i}))},u=3;n.isNone()&&u>=0;u--)i(u);return{matchOpt:n,size:r}},e=h(I.none),o=iB(t,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",GC.Space);return{tooltip:"Font sizes",text:I.some("12pt"),icon:I.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getPreviewFor:e,getCurrentValue:function(){return n().matchOpt},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontSize",!1,n.format)}))}},updateText:function(t){var e=n(),o=e.matchOpt,r=e.size,i=o.fold(h(r),(function(t){return t.title}));yi(t,fC,{text:i})},dataset:o,shouldHide:!1,isInvalid:S}},gB=function(t,n){var e=n(),o=U(e,(function(t){return t.format}));return I.from(t.formatter.closest(o)).bind((function(t){return K(e,(function(n){return n.format===t}))})).orThunk((function(){return Ct(t.formatter.match("p"),{title:"Paragraph",format:"p"})}))},pB=function(t){var n="Paragraph",e=iB(t,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",GC.SemiColon);return{tooltip:"Blocks",text:I.some(n),icon:I.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:I.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return I.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))})}},onAction:JE(t),updateText:function(o){var r=gB(t,(function(){return e.data})).fold(h(n),(function(t){return t.title}));yi(o,fC,{text:r})},dataset:e,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},hB=function(t,n){var e="Paragraph";return{tooltip:"Formats",text:I.some(e),icon:I.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:I.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return void 0!==e?I.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):I.none()}},onAction:JE(t),updateText:function(n){var o=function(t){var n=t.items;return void 0!==n&&n.length>0?Q(n,o):[{title:t.title,format:t.format}]},r=Q(YO(t),o),i=gB(t,h(r)).fold(h(e),(function(t){return t.title}));yi(n,fC,{text:i})},shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)},dataset:n}},vB=Object.freeze({__proto__:null,events:function(t,n){var e=function(e,o){t.updateState.each((function(t){var r=t(e,o);n.set(r)})),t.renderComponents.each((function(t){var r=t(o,n.get()),i=U(r,e.getSystem().build);uf(e,i)}))};return Ci([Ti(Jr(),(function(n,o){var r=o;if(!r.universal){var i=t.channel;z(r.channels,i)&&e(n,r.data)}})),Ri((function(n,o){t.initialData.each((function(t){e(n,t)}))}))])}}),bB=Object.freeze({__proto__:null,getState:function(t,n,e){return e}}),yB=[Lo("channel"),Jo("renderComponents"),Jo("updateState"),Jo("initialData")],xB=Qa({fields:yB,name:"reflecting",active:vB,apis:bB,state:Object.freeze({__proto__:null,init:function(){var t=dr(I.none());return{readState:function(){return t.get().getOr("none")},get:t.get,set:t.set,clear:function(){return t.set(I.none())}}}})}),wB=h([Lo("toggleClass"),Lo("fetch"),ua("onExecute"),or("getHotspot",I.some),or("getAnchorOverrides",h({})),Kc(),ua("onItemExecute"),Jo("lazySink"),Lo("dom"),ra("onOpen"),Xf("splitDropdownBehaviours",[Vx,hg,Eg]),or("matchWidth",!1),or("useMinWidth",!1),or("eventOrder",{}),Jo("role")].concat(Jx())),SB=yl({factory:Dp,schema:[Lo("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:Ja([Eg.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(xi)},buttonBehaviours:Ja([Ng.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),kB=yl({factory:Dp,schema:[Lo("dom")],name:"button",defaults:function(){return{buttonBehaviours:Ja([Eg.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each((function(e){t.onExecute(e,n)}))}}}}),CB=h([SB,kB,wl({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Lo("text")],name:"aria-descriptor"}),xl({schema:[na()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each((function(o){t.onItemExecute(o,n,e)}))}}}}),Hx()]),OB=Yl({name:"SplitDropdown",configFields:wB(),partFields:CB(),factory:function(t,n,e,o){var r,i=function(t){Ql.getCurrent(t).each((function(t){Sd.highlightFirst(t),hg.focusIn(t)}))},u=function(n){Gx(t,v,n,o,i,px.HighlightFirst).get(g)},a=function(n){var e=Il(n,t,"button");return xi(e),I.some(!0)},c=O(O({},Ci([Ri((function(n,e){Fl(n,t,"aria-descriptor").each((function(t){var e=Xi("aria");Gn(t.element,"id",e),Gn(n.element,"aria-describedby",e)}))}))])),Wg(I.some(u))),s={repositionMenus:function(t){Ng.isOn(t)&&Kx(t)}};return{uid:t.uid,dom:t.dom,components:n,apis:s,eventOrder:O(O({},t.eventOrder),(r={},r[$r()]=["disabling","toggling","alloy.base.behaviour"],r)),events:c,behaviours:Yf(t.splitDropdownBehaviours,[Vx.config({others:{sandbox:function(n){var e=Il(n,t,"arrow");return Yx(t,n,{onOpen:function(){Ng.on(e),Ng.on(n)},onClose:function(){Ng.off(e),Ng.off(n)}})}}}),hg.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t){return u(t),I.some(!0)}}),Eg.config({}),Ng.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),_B=function(t){return{isDisabled:function(){return dd.isDisabled(t)},setDisabled:function(n){return dd.set(t,n)}}},TB=function(t){return{setActive:function(n){Ng.set(t,n)},isActive:function(){return Ng.isOn(t)},isDisabled:function(){return dd.isDisabled(t)},setDisabled:function(n){return dd.set(t,n)}}},EB=function(t,n){return t.map((function(t){return{"aria-label":n.translate(t),title:n.translate(t)}})).getOr({})},BB=Xi("focus-button"),MB=function(t,n,e,o,r,i){var u;return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]),attributes:EB(e,i)},components:cb([t.map((function(t){return iC(t,i.icons)})),n.map((function(t){return aC(t,"tox-tbtn",i)}))]),eventOrder:(u={},u[Br()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:Ja([eb(i.isDisabled),Zv(),kg("common-button-display-events",[Ti(Br(),(function(t,n){n.event.prevent(),bi(t,BB)}))])].concat(o.map((function(e){return xB.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t,n){return cb([t.icon.map((function(t){return iC(t,i.icons)})),t.text.map((function(t){return aC(t,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}},AB=function(t,n,e){var o,r=dr(g),i=MB(t.icon,t.text,t.tooltip,I.none(),I.none(),e);return Dp.sketch({dom:i.dom,components:i.components,eventOrder:sC,buttonBehaviours:Ja([kg("toolbar-button-events",[(o={onAction:t.onAction,getApi:n.getApi},Hi((function(t,n){ob(o,t)((function(n){yi(t,cC,{buttonApi:n}),o.onAction(n)}))}))),rb(n,r),ib(n,r)]),eb((function(){return t.disabled||e.isDisabled()})),Zv()].concat(n.toolbarButtonBehaviours))})},DB=function(t,n,e){return AB(t,{toolbarButtonBehaviours:[].concat(e.length>0?[kg("toolbarButtonWith",e)]:[]),getApi:_B,onSetup:t.onSetup},n)},FB=function(t,n,e){return no(AB(t,{toolbarButtonBehaviours:[Sg.config({}),Ng.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[kg("toolbarToggleButtonWith",e)]:[]),getApi:TB,onSetup:t.onSetup},n))},IB=function(t,n,e){return function(o){return wx((function(t){return n.fetch(t)})).map((function(r){return I.from(Ty(no(gy(Xi("menu-value"),r,(function(e){n.onItemAction(t(o),e)}),n.columns,n.presets,Oh.CLOSE_ON_EXECUTE,n.select.getOr(S),e),{movement:hy(n.columns,n.presets),menuBehaviours:mv("auto"!==n.columns?[]:[Ri((function(t,e){dv(t,4,Vh(n.presets)).each((function(n){var e=n.numRows,o=n.numColumns;hg.setGridSize(t,e,o)}))}))])})))}))}},RB=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],VB=function(t,n){return function(e,o,r){var i=t(e).mapError((function(t){return Vo(t)})).getOrDie();return n(i,o,r)}},PB={button:VB(dh,(function(t,n){return e=t,o=n.backstage.shared.providers,DB(e,o,[]);var e,o})),togglebutton:VB(ph,(function(t,n){return e=t,o=n.backstage.shared.providers,FB(e,o,[]);var e,o})),menubutton:VB(mT,(function(t,n){return bC(t,"tox-tbtn",n.backstage,I.none())})),splitbutton:VB((function(t){return Fo("SplitButton",gT,t)}),(function(t,n){return function(t,n){var e,o=Xi("channel-update-split-dropdown-display"),r=function(t){return{isDisabled:function(){return dd.isDisabled(t)},setDisabled:function(n){return dd.set(t,n)},setIconFill:function(n,e){Uu(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Gn(t,"fill",e)}))},setIconStroke:function(n,e){Uu(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Gn(t,"stroke",e)}))},setActive:function(n){Gn(t.element,"aria-pressed",n),Uu(t.element,"span").each((function(e){t.getSystem().getByDom(e).each((function(t){return Ng.set(t,n)}))}))},isActive:function(){return Uu(t.element,"span").exists((function(n){return t.getSystem().getByDom(n).exists(Ng.isOn)}))}}},i=dr(g),u={getApi:r,onSetup:t.onSetup};return OB.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:O({"aria-pressed":!1},EB(t.tooltip,n.providers))},onExecute:function(n){t.onAction(r(n))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:Ja([nb(n.providers.isDisabled),Zv(),kg("split-dropdown-events",[Ti(BB,Eg.focus),rb(u,i),ib(u,i)]),nw.config({})]),eventOrder:(e={},e[ci()]=["alloy.base.behaviour","split-dropdown-events"],e),toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:IB(r,t,n.providers),parts:{menu:Wh(0,t.columns,t.presets)},components:[OB.parts.button(MB(t.icon,t.text,I.none(),I.some(o),I.some([Ng.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),n.providers)),OB.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Np("chevron-down",n.providers.icons)},buttonBehaviours:Ja([nb(n.providers.isDisabled),Zv(),Lp()])}),OB.parts["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})}(t,n.backstage.shared)})),grouptoolbarbutton:VB((function(t){return Fo("GroupToolbarButton",fT,t)}),(function(t,n,e){var o,r=e.ui.registry.getAll().buttons,i=((o={})[qc]=n.backstage.shared.header.isPositionedAtTop()?bc.TopToBottom:bc.BottomToTop,o);if(Rv(e)===Ch.floating)return function(t,n,e,o){var r=n.shared;return lE.sketch({lazySink:r.getSink,fetch:function(){return wx((function(n){n(U(e(t.items),CE))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:MB(t.icon,t.text,t.tooltip,I.none(),I.none(),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})}(t,n.backstage,(function(t){return zB(e,{buttons:r,toolbar:t,allowToolbarGroups:!1},n,I.none())}),i);throw new Error("Toolbar groups are only supported when using floating toolbar mode")})),styleSelectButton:function(t,n){return function(t,n){var e=O({type:"advanced"},n.styleselect);return tB(t,n,hB(t,e))}(t,n.backstage)},fontsizeSelectButton:function(t,n){return function(t,n){return tB(t,n,mB(t))}(t,n.backstage)},fontSelectButton:function(t,n){return function(t,n){return tB(t,n,fB(t))}(t,n.backstage)},formatButton:function(t,n){return function(t,n){return tB(t,n,pB(t))}(t,n.backstage)},alignMenuButton:function(t,n){return function(t,n){return tB(t,n,aB(t))}(t,n.backstage)}},HB={styleselect:PB.styleSelectButton,fontsizeselect:PB.fontsizeSelectButton,fontselect:PB.fontSelectButton,formatselect:PB.formatButton,align:PB.alignMenuButton},zB=function(t,n,e,r){var i=function(t){var n,e=t.toolbar,r=t.buttons;return!1===e?[]:void 0===e||!0===e?function(t){var n=U(RB,(function(n){var e=X(n.items,(function(n){return yt(t,n)||yt(HB,n)}));return{name:n.name,items:e}}));return X(n,(function(t){return t.items.length>0}))}(r):o(e)?(n=e.split("|"),U(n,(function(t){return{items:t.trim().split(" ")}}))):function(t){return m(t,(function(t){return yt(t,"name")&&yt(t,"items")}))}(e)?e:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])}(n),u=U(i,(function(o){var i=Q(o.items,(function(o){return 0===o.trim().length?[]:function(t,n,e,o,r,i){return bt(n,e.toLowerCase()).orThunk((function(){return i.bind((function(t){return st(t,(function(t){return bt(n,t+e.toLowerCase())}))}))})).fold((function(){return bt(HB,e.toLowerCase()).map((function(n){return n(t,r)})).orThunk((function(){return I.none()}))}),(function(n){return"grouptoolbarbutton"!==n.type||o?function(t,n,e){return bt(PB,t.type).fold((function(){return console.error("skipping button defined by",t),I.none()}),(function(o){return I.some(o(t,n,e))}))}(n,r,t):(console.warn("Ignoring the '"+e+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),I.none())}))}(t,n.buttons,o,n.allowToolbarGroups,e,r).toArray()}));return{title:I.from(t.translate(o.name)),items:i}}));return X(u,(function(t){return t.items.length>0}))},NB=function(t,n,e,r){var i=n.outerContainer,u=e.toolbar,a=e.buttons;if(m(u,o)){var c=u.map((function(n){var o={toolbar:n,buttons:a,allowToolbarGroups:e.allowToolbarGroups};return zB(t,o,{backstage:r},I.none())}));PE.setToolbars(i,c)}else PE.setToolbar(i,zB(t,e,{backstage:r},I.none()))},LB=yn(),WB=LB.os.isiOS()&&LB.os.version.major<=12,UB=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=dr(0),a=n.outerContainer;XE(t);var c=Rt(r.targetNode),s=Hn(Pn(c));!function(t,n){mf(t,n,Oe)}(c,n.mothership),df(s,n.uiMothership),t.on("PostRender",(function(){NB(t,n,e,o),i.set(t.getWin().innerWidth),PE.setMenubar(a,NE(t,e)),PE.setSidebar(a,e.sidebar),function(t,n){var e=t.dom,o=t.getWin(),r=t.getDoc().documentElement,i=dr(ge(o.innerWidth,o.innerHeight)),u=dr(ge(r.offsetWidth,r.offsetHeight)),a=function(){var n=i.get();n.left===o.innerWidth&&n.top===o.innerHeight||(i.set(ge(o.innerWidth,o.innerHeight)),Gb(t))},c=function(){var n=t.getDoc().documentElement,e=u.get();e.left===n.offsetWidth&&e.top===n.offsetHeight||(u.set(ge(n.offsetWidth,n.offsetHeight)),Gb(t))},s=function(n){return function(t,n){return t.fire("ScrollContent",n)}(t,n)};e.bind(o,"resize",a),e.bind(o,"scroll",s);var f=Ac(Rt(t.getBody()),"load",c),l=n.uiMothership.element;t.on("hide",(function(){Zn(l,"display","none")})),t.on("show",(function(){ae(l,"display")})),t.on("NodeChange",c),t.on("remove",(function(){f.unbind(),e.unbind(o,"resize",a),e.unbind(o,"scroll",s),o=null}))}(t,n)}));var f,l,d=PE.getSocket(a).getOrDie("Could not find expected socket element");if(WB){te(d.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var m=(f=function(){t.fire("ScrollContent")},20,l=null,{cancel:function(){u(l)||(clearTimeout(l),l=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u(l)&&(l=setTimeout((function(){l=null,f.apply(null,t)}),20))}}),g=Mc(d.element,"scroll",m.throttle);t.on("remove",g.unbind)}Qv(t,n),t.addCommand("ToggleSidebar",(function(n,e){PE.toggleSidebar(a,e),t.fire("ToggleSidebar")})),t.addQueryValueHandler("ToggleSidebar",(function(){return PE.whichSidebar(a)}));var p=Rv(t);p!==Ch.sliding&&p!==Ch.floating||t.on("ResizeWindow ResizeEditor ResizeContent",(function(){var e=t.getWin().innerWidth;e!==i.get()&&(PE.refreshToolbar(n.outerContainer),i.set(e))}));var h={enable:function(){$v(n,!1)},disable:function(){$v(n,!0)},isDisabled:function(){return dd.isDisabled(a)}};return{iframeContainer:d.element.dom,editorContainer:a.element.dom,api:h}}}),jB=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?I.some(parseInt(""+t,10)):I.none()},GB=function(t){return d(t)?t+"px":t},XB=function(t,n,e){var o=n.filter((function(n){return t<n})),r=e.filter((function(n){return t>n}));return o.or(r).getOr(t)},qB=function(t){var n=Ov(t),e=_v(t),o=Ev(t);return jB(n).map((function(t){return XB(t,e,o)}))},YB=function(t,n){var e=Ne(t);return{pos:n?e.y:e.bottom,bounds:e}},KB=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=n.mothership,u=n.uiMothership,a=n.outerContainer,c=dr(null),s=Rt(r.targetNode),f=function(t,n,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=Sv.DOM,c=Lv(t),s=jv(t),f=Ev(t).or(qB(t)),l=o.shared.header,d=l.isPositionedAtTop,m=Rv(t),g=m===Ch.sliding||m===Ch.floating,p=dr(!1),v=function(){return p.get()&&!t.removed},b=function(t){return g?t.fold(h(0),(function(t){return t.components().length>1?le(t.components()[1].element):0})):0},y=function(){i.broadcastOn([Tf()],{})},x=function(t){if(void 0===t&&(t=!1),v()){var e;if(c||(e=f.getOrThunk((function(){var t=jB(ee(Wn(),"margin-left")).getOr(0);return ye(Wn())-he(n).left+t})),Zn(r.get().element,"max-width",e+"px")),g&&PE.refreshToolbar(u),c||function(){var t=PE.getToolbar(u),e=b(t),o=Ne(n),i=d()?Math.max(o.y-le(r.get().element)+e,0):o.bottom;te(u.element,{position:"absolute",top:Math.round(i)+"px",left:Math.round(o.x)+"px"})}(),s){var o=r.get();t?Z_.reset(o):Z_.refresh(o)}y()}},w=function(e){if(void 0===e&&(e=!0),!c&&s&&v()){var o=l.getDockingMode(),i=function(e){switch(Hv(t)){case Iv.auto:var o=PE.getToolbar(u),r=b(o),i=le(e.element)-r,a=Ne(n);if(a.y>i)return"top";var c=_n(n),s=Math.max(c.dom.scrollHeight,le(c));return a.bottom<s-i||We().bottom<a.bottom-i?"bottom":"top";case Iv.bottom:return"bottom";case Iv.top:default:return"top"}}(r.get());i!==o&&(function(t){var n=r.get();Z_.setModes(n,[t]),l.setDockingMode(t);var e=d()?bc.TopToBottom:bc.BottomToTop;Gn(n.element,qc,e)}(i),e&&x(!0))}};return{isVisible:v,isPositionedAtTop:d,show:function(){p.set(!0),Zn(u.element,"display","flex"),a.addClass(t.getBody(),"mce-edit-focus"),ae(i.element,"display"),w(!1),x()},hide:function(){p.set(!1),e.outerContainer&&(Zn(u.element,"display","none"),a.removeClass(t.getBody(),"mce-edit-focus")),Zn(i.element,"display","none")},update:x,updateMode:w,repositionPopups:y}}(t,s,n,o,c),l=function(t){return t.getParam("toolbar_persist",!1,"boolean")}(t);qE(t);var d=function(){if(c.get())f.show();else{c.set(PE.getHeader(a).getOrDie());var r=Wv(t);df(r,i),df(r,u),NB(t,n,e,o),PE.setMenubar(a,NE(t,e)),f.show(),function(t,n,e,o){var r=dr(YB(n,e.isPositionedAtTop())),i=function(o){var i=YB(n,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=r.get(),s=c.pos,f=c.bounds,l=a.height!==f.height||a.width!==f.width;r.set({pos:u,bounds:a}),l&&Gb(t,o),e.isVisible()&&(s!==u?e.update(!0):l&&(e.updateMode(),e.repositionPopups()))};o||(t.on("activate",e.show),t.on("deactivate",e.hide)),t.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),t.on("NodeChange keydown",(function(t){Ap.requestAnimationFrame((function(){return i(t)}))})),t.on("ScrollWindow",(function(){return e.updateMode()}));var u=Tc();u.set(Ac(Rt(t.getBody()),"load",i)),t.on("remove",(function(){u.clear()}))}(t,s,f,l),t.nodeChanged()}},m=function(){return Ap.setEditorTimeout(t,d,0)};t.on("show",d),t.on("hide",f.hide),l||(t.on("focus",m),t.on("blur",f.hide)),t.on("init",(function(){(t.hasFocus()||l)&&m()})),Qv(t,n);var g={show:function(){f.show()},hide:function(){f.hide()},enable:function(){$v(n,!1)},disable:function(){$v(n,!0)},isDisabled:function(){return dd.isDisabled(a)}};return{editorContainer:a.element.dom,api:g}}}),JB="contexttoolbar-hide",$B=function(t,n){return Ti(cC,(function(e,o){var r=function(t){return{hide:function(){return bi(t,ni())},getValue:function(){return Gf.getValue(t)}}}(t.get(e));n.onAction(r,o.event.buttonApi)}))},QB=function(t,n){var e=t.label.fold((function(){return{}}),(function(t){return{"aria-label":t}})),o=Fp(dx.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:e,selectOnFocus:!0,inputBehaviours:Ja([hg.config({mode:"special",onEnter:function(t){return r.findPrimary(t).map((function(t){return xi(t),!0}))},onLeft:function(t,n){return n.cut(),I.none()},onRight:function(t,n){return n.cut(),I.none()}})])})),r=function(t,n,e){var o=U(n,(function(n){return Fp(function(t,n,e){var o={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===n.type?function(t,n,e){var o=n.original;o.primary;var r=_(o,["primary"]),i=Io(ph(O(O({},r),{type:"togglebutton",onAction:g})));return FB(i,e.backstage.shared.providers,[$B(t,n)])}(t,n,o):function(t,n,e){var o=n.original;o.primary;var r=_(o,["primary"]),i=Io(dh(O(O({},r),{type:"button",onAction:g})));return DB(i,e.backstage.shared.providers,[$B(t,n)])}(t,n,o)}(t,n,e))}));return{asSpecs:function(){return U(o,(function(t){return t.asSpec()}))},findPrimary:function(t){return st(n,(function(n,e){return n.primary?I.from(o[e]).bind((function(n){return n.getOpt(t)})).filter(x(dd.isDisabled)):I.none()}))}}}(o,t.commands,n);return[{title:I.none(),items:[o.asSpec()]},{title:I.none(),items:r.asSpecs()}]},ZB=function(t,n,e){return void 0===e&&(e=.01),n.bottom-t.y>=e&&t.bottom-n.y>=e},tM=function(t){var n=function(t){var n=t.getBoundingClientRect();if(n.height<=0&&n.width<=0){var e=Fn(Rt(t.startContainer),t.startOffset).element;return(Nt(e)?En(e):I.some(e)).filter(zt).map((function(t){return t.dom.getBoundingClientRect()})).getOr(n)}return n}(t.selection.getRng());if(t.inline){var e=De();return ze(e.left+n.left,e.top+n.top,n.width,n.height)}var o=Le(Rt(t.getBody()));return ze(o.x+n.left,o.y+n.top,n.width,n.height)},nM=function(t,n,e,o){void 0===o&&(o=0);var r=Re(window),i=Ne(Rt(t.getContentAreaContainer())),u=Mv(t)||Av(t)||Fv(t),a=function(t,n,e){var o=Math.max(t.x+e,n.x);return{x:o,width:Math.min(t.right-e,n.right)-o}}(i,r,o),c=a.x,s=a.width;if(t.inline&&!u)return ze(c,r.y,s,r.height);var f=function(t,n,e,o,r,i){var u=Rt(t.getContainer()),a=Uu(u,".tox-editor-header").getOr(u),c=Ne(a),s=c.y>=n.bottom,f=o&&!s;if(t.inline&&f)return{y:Math.max(c.bottom+i,e.y),bottom:e.bottom};if(t.inline&&!f)return{y:e.y,bottom:Math.min(c.y-i,e.bottom)};var l="line"===r?Ne(u):n;return f?{y:Math.max(c.bottom+i,e.y),bottom:Math.min(l.bottom-i,e.bottom)}:{y:Math.max(l.y+i,e.y),bottom:Math.min(c.y-i,e.bottom)}}(t,i,r,n.header.isPositionedAtTop(),e,o),l=f.y,d=f.bottom;return ze(c,l,s,d-l)},eM={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},oM={maxHeightFunction:Hc(),maxWidthFunction:iE()},rM=function(t){return"node"===t},iM=function(t,n,e,o,r){var i=tM(t),u=o.lastElement().exists((function(t){return Sn(e,t)}));return function(t,n){var e=t.selection.getRng(),o=Fn(Rt(e.startContainer),e.startOffset);return e.startContainer===e.endContainer&&e.startOffset===e.endOffset-1&&Sn(o.element,n)}(t,e)?u?Ep:kp:u?function(t,e,r){var u=re(t,"position");Zn(t,"position",e);var a=ZB(i,Ne(n))&&!o.isReposition()?Mp:Ep;return u.each((function(n){return Zn(t,"position",n)})),a}(n,o.getMode()):("fixed"===o.getMode()?r.y+De().top:r.y)+(le(n)+12)<=i.y?kp:Cp},uM=function(t,n,e,o){var r=function(n){return function(o,r,i,u,a){var c=iM(t,u,n,e,a),s=O(O({},o),{y:a.y,height:a.height});return O(O({},c(s,r,i,u,a)),{alwaysFit:!0})}},i=function(t){return rM(o)?[r(t)]:[]};return n?{onLtr:function(t){return[Va,Aa,Da,Fa,Ia,Ra].concat(i(t))},onRtl:function(t){return[Va,Da,Aa,Ia,Fa,Ra].concat(i(t))}}:{onLtr:function(t){return[Ra,Va,Fa,Aa,Ia,Da].concat(i(t))},onRtl:function(t){return[Ra,Va,Ia,Da,Fa,Aa].concat(i(t))}}},aM=function(t,n){var e=X(n,(function(n){return n.predicate(t.dom)})),o=G(e,(function(t){return"contexttoolbar"===t.type}));return{contextToolbars:o.pass,contextForms:o.fail}},cM=function(t,n){var e={},o=[],r=[],i={},u={},a=ft(t);return j(a,(function(a){var c=t[a];"contextform"===c.type?function(t,a){var c=Io(Fo("ContextForm",Sh,a));e[t]=c,c.launch.map((function(e){i["form:"+t]=O(O({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){n(c)}})})),"editor"===c.scope?r.push(c):o.push(c),u[t]=c}(a,c):"contexttoolbar"===c.type&&function(t,n){var e;(e=n,Fo("ContextToolbar",kh,e)).each((function(e){"editor"===n.scope?r.push(e):o.push(e),u[t]=e}))}(a,c)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},sM=Xi("forward-slide"),fM=Xi("backward-slide"),lM=Xi("change-slide-event"),dM="tox-pop--resizing",mM="tox-pop--transition",gM=function(t,n,e,o){var r,i,u=o.backstage,a=u.shared,c=yn().deviceType.isTouch,s=Ec(),f=Ec(),l=Ec(),d=Iu((r={sink:e,onEscape:function(){return t.focus(),I.some(!0)}},i=dr([]),lp.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){i.set([]),lp.getContent(t).each((function(t){ae(t.element,"visibility")})),Su(t.element,dM),ae(t.element,"width")},inlineBehaviours:Ja([kg("context-toolbar-events",[Ii(Wr(),(function(t,n){"width"===n.event.raw.propertyName&&(Su(t.element,dM),ae(t.element,"width"))})),Ti(lM,(function(t,n){var e=t.element;ae(e,"width");var o=ye(e);lp.setContent(t,n.event.contents),wu(e,dM);var r=ye(e);Zn(e,"width",o+"px"),lp.getContent(t).each((function(t){n.event.focus.bind((function(t){return ic(t),cc(e)})).orThunk((function(){return hg.focusIn(t),ac(Pn(e))}))})),Ap.setTimeout((function(){Zn(t.element,"width",r+"px")}),0)})),Ti(sM,(function(t,n){lp.getContent(t).each((function(n){i.set(i.get().concat([{bar:n,focus:ac(Pn(t.element))}]))})),yi(t,lM,{contents:n.event.forwardContents,focus:I.none()})})),Ti(fM,(function(t,n){at(i.get()).each((function(n){i.set(i.get().slice(0,i.get().length-1)),yi(t,lM,{contents:Ru(n.bar),focus:n.focus})}))}))]),hg.config({mode:"special",onEscape:function(t){return at(i.get()).fold((function(){return r.onEscape()}),(function(n){return bi(t,fM),I.some(!0)}))}})]),lazySink:function(){return Ge.value(r.sink)}}))),m=function(){var n=l.get().getOr("node"),e=rM(n)?1:0;return nM(t,a,n,e)},p=function(){return!(t.removed||c()&&u.isContextMenuOpen())},h=function(){if(p()){var n=m(),e=wt(l.get(),"node")?function(t,n){return n.filter(Ln).map(Le).getOrThunk((function(){return tM(t)}))}(t,s.get()):tM(t);return n.height<=0||!ZB(e,n)}return!0},v=function(){s.clear(),f.clear(),l.clear(),lp.hide(d)},b=function(){if(lp.isOpen(d)){var t=d.element;ae(t,"display"),h()?Zn(t,"display","none"):(f.set(0),lp.reposition(d))}},y=function(n){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[n],behaviours:Ja([hg.config({mode:"acyclic"}),kg("pop-dialog-wrap-events",[Ri((function(n){t.shortcuts.add("ctrl+F9","focus statusbar",(function(){return hg.focusIn(n)}))})),Vi((function(n){t.shortcuts.remove("ctrl+F9")}))])])}},x=Ut((function(){return cM(n,(function(t){var n=w([t]);yi(d,sM,{forwardContents:y(n)})}))})),w=function(n){var e=t.ui.registry.getAll().buttons,r=x(),i=O(O({},e),r.formNavigators),u=Rv(t)===Ch.scrolling?Ch.scrolling:Ch.default,c=$(U(n,(function(n){return"contexttoolbar"===n.type?function(n,e){return zB(t,{buttons:n,toolbar:e.items,allowToolbarGroups:!1},o,I.some(["form:"]))}(i,n):function(t,n){return QB(t,n)}(n,a.providers)})));return BE({type:u,uid:Xi("context-toolbar"),initGroups:c,onEscape:I.none,cyclicKeying:!0,providers:a.providers})},S=function(n,o){if(k.cancel(),p()){var r=w(n),i=n[0].position,u=function(n,o){var r="node"===n?a.anchors.node(o):a.anchors.cursor(),i=function(t,n,e,o){return"line"===n?{bubble:Wc(12,0,eM),layouts:{onLtr:function(){return[Pa]},onRtl:function(){return[Ha]}},overrides:oM}:{bubble:Wc(0,12,eM,1/12),layouts:uM(t,e,o,n),overrides:oM}}(t,n,c(),{lastElement:s.get,isReposition:function(){return wt(f.get(),0)},getMode:function(){return nf.getMode(e)}});return no(r,i)}(i,o);l.set(i),f.set(1);var g=d.element;ae(g,"display"),function(t){return wt(kt(t,s.get(),Sn),!0)}(o)||(Su(g,mM),nf.reset(e,d)),lp.showWithinBounds(d,y(r),{anchor:u,transition:{classes:[mM],mode:"placement"}},(function(){return I.some(m())})),o.fold(s.clear,s.set),h()&&Zn(g,"display","none")}},k=qp((function(){t.hasFocus()&&!t.removed&&(ku(d.element,mM)?k.throttle():function(t,n){var e=Rt(n.getBody()),o=function(t){return Sn(t,e)},r=Rt(n.selection.getNode());return function(t){return!o(t)&&!kn(e,t)}(r)?I.none():function(t,n,e){var o=aM(t,n);if(o.contextForms.length>0)return I.some({elem:t,toolbars:[o.contextForms[0]]});var r=aM(t,e);if(r.contextForms.length>0)return I.some({elem:t,toolbars:[r.contextForms[0]]});if(o.contextToolbars.length>0||r.contextToolbars.length>0){var i=function(t){if(t.length<=1)return t;var n=function(n){return N(t,(function(t){return t.position===n}))},e=function(n){return X(t,(function(t){return t.position===n}))},o=n("selection"),r=n("node");if(o||r){if(r&&o){var i=e("node"),u=U(e("selection"),(function(t){return O(O({},t),{position:"node"})}));return i.concat(u)}return e(o?"selection":"node")}return e("line")}(o.contextToolbars.concat(r.contextToolbars));return I.some({elem:t,toolbars:i})}return I.none()}(r,t.inNodeScope,t.inEditorScope).orThunk((function(){return function(t,n,e){return t(n)?I.none():yr(n,(function(t){if(zt(t)){var n=aM(t,e.inNodeScope),o=n.contextToolbars,r=n.contextForms,i=r.length>0?r:function(t){if(t.length<=1)return t;var n=function(n){return K(t,(function(t){return t.position===n}))};return n("selection").orThunk((function(){return n("node")})).orThunk((function(){return n("line")})).map((function(t){return t.position})).fold((function(){return[]}),(function(n){return X(t,(function(t){return t.position===n}))}))}(o);return i.length>0?I.some({elem:t,toolbars:i}):I.none()}return I.none()}),t)}(o,r,t)}))}(x(),t).fold(v,(function(t){S(t.toolbars,I.some(t.elem))})))}),17);t.on("init",(function(){t.on("remove",v),t.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",b),t.on("click keyup focus SetContent",k.throttle),t.on(JB,v),t.on("contexttoolbar-show",(function(n){var e=x();bt(e.lookupTable,n.toolbarKey).each((function(e){S([e],Ct(n.target!==t,n.target)),lp.getContent(d).each(hg.focusIn)}))})),t.on("focusout",(function(n){Ap.setEditorTimeout(t,(function(){cc(e.element).isNone()&&cc(d.element).isNone()&&v()}),0)})),t.on("SwitchMode",(function(){t.mode.isReadOnly()&&v()})),t.on("AfterProgressState",(function(n){n.state?v():t.hasFocus()&&k.throttle()})),t.on("NodeChange",(function(t){cc(d.element).fold(k.throttle,g)}))}))},pM={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},hM=(nB="[eE][+-]?[0-9]+",eB=function(t){return"(?:"+t+")?"},oB=["Infinity","[0-9]+\\."+eB("[0-9]+")+eB(nB),"\\.[0-9]+"+eB(nB),"[0-9]+"+eB(nB)].join("|"),new RegExp("^([+-]?(?:"+oB+"))(.*)$")),vM=function(t,n){var e=function(){var e=n.getOptions(t),o=n.getCurrent(t).map(n.hash),r=Ec();return U(e,(function(e){return{type:"togglemenuitem",text:n.display(e),onSetup:function(i){var u=function(t){t&&(r.on((function(t){return t.setActive(!1)})),r.set(i)),i.setActive(t)};u(wt(o,n.hash(e)));var a=n.watcher(t,e,u);return function(){r.clear(),a()}},onAction:function(){return n.setCurrent(t,e)}}}))};t.ui.registry.addMenuButton(n.name,{tooltip:n.text,icon:n.icon,fetch:function(t){return t(e())},onSetup:n.onToolbarSetup}),t.ui.registry.addNestedMenuItem(n.name,{type:"nestedmenuitem",text:n.text,getSubmenuItems:e,onSetup:n.onMenuSetup})},bM={name:"lineheight",text:"Line height",icon:"line-height",getOptions:function(t){return t.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" ")},hash:function(t){return function(t,n){return function(t,n){return I.from(hM.exec(t)).bind((function(t){var e=Number(t[1]),o=t[2];return function(t,n){return N(n,(function(n){return N(pM[n],(function(n){return t===n}))}))}(o,n)?I.some({value:e,unit:o}):I.none()}))}(t,["fixed","relative","empty"]).map((function(t){return t.value+t.unit}))}(t).getOr(t)},display:v,watcher:function(t,n,e){return t.formatter.formatChanged("lineheight",e,!1,{value:n}).unbind},getCurrent:function(t){return I.from(t.queryCommandValue("LineHeight"))},setCurrent:function(t,n){return t.execCommand("LineHeight",!1,n)}},yM=function(t){return KE(t,"NodeChange",(function(n){n.setDisabled(!t.queryCommandState("outdent"))}))},xM=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},wM=function(t){(function(t){!function(t){fk.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(n,e){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:YE(t,n.name),onAction:xM(t,n.name)})}));for(var n=1;n<=6;n++){var e="h"+n;t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:YE(t,e),onAction:xM(t,e)})}}(t),function(t){fk.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(n){t.ui.registry.addButton(n.name,{tooltip:n.text,icon:n.icon,onAction:$E(t,n.action)})}))}(t),function(t){fk.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:$E(t,n.action),onSetup:YE(t,n.name)})}))}(t)})(t),function(t){fk.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(n){t.ui.registry.addMenuItem(n.name,{text:n.text,icon:n.icon,shortcut:n.shortcut,onAction:$E(t,n.action)})})),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:xM(t,"code")})}(t)},SM=function(t,n){return KE(t,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",(function(e){e.setDisabled(t.mode.isReadOnly()||!t.undoManager[n]())}))},kM=function(t){return KE(t,"VisualAid",(function(n){n.setActive(t.hasVisual)}))},CM=function(t,n){!function(t){j([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:$E(t,n.cmd),onSetup:YE(t,n.name)})})),t.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:$E(t,"JustifyNone")})}(t),wM(t),function(t,n){!function(t,n){var e=ZE(0,n,aB(t));t.ui.registry.addNestedMenuItem("align",{text:n.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n),function(t,n){var e=ZE(0,n,fB(t));t.ui.registry.addNestedMenuItem("fontformats",{text:n.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n),function(t,n){var e=O({type:"advanced"},n.styleselect),o=ZE(0,n,hB(t,e));t.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}})}(t,n),function(t,n){var e=ZE(0,n,pB(t));t.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n),function(t,n){var e=ZE(0,n,mB(t));t.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n)}(t,n),function(t){!function(t){t.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:SM(t,"hasUndo"),onAction:$E(t,"undo")}),t.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:SM(t,"hasRedo"),onAction:$E(t,"redo")})}(t),function(t){t.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",disabled:!0,onSetup:SM(t,"hasUndo"),onAction:$E(t,"undo")}),t.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",disabled:!0,onSetup:SM(t,"hasRedo"),onAction:$E(t,"redo")})}(t)}(t),function(t){!function(t){t.addCommand("mceApplyTextcolor",(function(n,e){!function(t,n,e){t.undoManager.transact((function(){t.focus(),t.formatter.apply(n,{value:e}),t.nodeChanged()}))}(t,n,e)})),t.addCommand("mceRemoveTextcolor",(function(n){!function(t,n){t.undoManager.transact((function(){t.focus(),t.formatter.remove(n,{value:null},null,!0),t.nodeChanged()}))}(t,n)}))}(t);var n=dr(ry),e=dr(ry);ly(t,"forecolor","forecolor","Text color",n),ly(t,"backcolor","hilitecolor","Background color",e),dy(t,"forecolor","forecolor","Text color"),dy(t,"backcolor","hilitecolor","Background color")}(t),function(t){!function(t){t.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:$E(t,"mceToggleVisualAid")})}(t),function(t){t.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:kM(t),onAction:$E(t,"mceToggleVisualAid")})}(t)}(t),function(t){!function(t){t.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:yM(t),onAction:$E(t,"outdent")}),t.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:$E(t,"indent")})}(t)}(t),function(t){vM(t,bM),function(t){var n=I.from(function(t){return t.getParam("content_langs",void 0,"array")}(t));return n.map((function(n){return{name:"language",text:"Language",icon:"language",getOptions:h(n),hash:function(t){return c(t.customCode)?t.code:t.code+"/"+t.customCode},display:function(t){return t.title},watcher:function(t,n,e){return t.formatter.formatChanged("lang",e,!1,{value:n.code,customValue:n.customCode}).unbind},getCurrent:function(t){var n=Rt(t.selection.getNode());return xr(n,(function(t){return I.some(t).filter(zt).bind((function(t){return Yn(t,"lang").map((function(n){return{code:n,customCode:Yn(t,"data-mce-lang").getOrUndefined(),title:""}}))}))}))},setCurrent:function(t,n){return t.execCommand("Lang",!1,n)},onToolbarSetup:function(n){var e=Tc();return n.setActive(t.formatter.match("lang",{},void 0,!0)),e.set(t.formatter.formatChanged("lang",n.setActive,!0)),e.clear}}}))}(t).each((function(n){return vM(t,n)}))}(t)},OM=function(t,n){return{type:"makeshift",x:t,y:n}},_M=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},TM=function(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?function(t){if(_M(t)){var n=t.touches[0];return OM(n.pageX,n.pageY)}return OM(t.pageX,t.pageY)}(n):function(t,n){var e=Sv.DOM.getPos(t);return function(t,n,e){return OM(t.x+n,t.y+e)}(n,e.x,e.y)}(t.getContentAreaContainer(),function(t){if(_M(t)){var n=t.touches[0];return OM(n.clientX,n.clientY)}return OM(t.clientX,t.clientY)}(n)):EM(t)},EM=function(t){return{type:"selection",root:Rt(t.selection.getNode())}},BM=function(t,n,e){switch(e){case"node":return function(t){return{type:"node",node:I.some(Rt(t.selection.getNode())),root:Rt(t.getBody())}}(t);case"point":return TM(t,n);case"selection":return EM(t)}},MM=function(t,n,e,o,r,i){var u=e(),a=BM(t,n,i);hC(u,Oh.CLOSE_ON_EXECUTE,o,!1).map((function(t){n.preventDefault(),lp.showMenuAt(r,{anchor:a},{menu:{markers:zh("normal")},data:t})}))},AM={onLtr:function(){return[Va,Aa,Da,Fa,Ia,Ra,kp,Cp,Sp,xp,wp,yp]},onRtl:function(){return[Va,Da,Aa,Ia,Fa,Ra,kp,Cp,wp,yp,Sp,xp]}},DM={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},FM=function(t,n,e,o,r,i){var u=yn(),a=u.os.isiOS(),c=u.os.isOSX(),s=u.os.isAndroid(),f=u.deviceType.isTouch(),l=function(){var u=e();!function(t,n,e,o,r,i,u){var a=function(t,n,e){var o=BM(t,n,e);return O({bubble:Wc(0,"point"===e?12:0,DM),layouts:AM,overrides:{maxWidthFunction:iE(),maxHeightFunction:Hc()}},o)}(t,n,i);hC(e,Oh.CLOSE_ON_EXECUTE,o,!0).map((function(e){n.preventDefault(),lp.showMenuWithinBounds(r,{anchor:a},{menu:{markers:zh("normal"),highlightImmediately:u},data:e,type:"horizontal"},(function(){return I.some(nM(t,o.shared,"node"===i?"node":"selection"))})),t.fire(JB)}))}(t,n,u,o,r,i,!(s||a||c&&f))};if((c||a)&&"node"!==i){var d=function(){!function(t){var n=t.selection.getRng(),e=function(){Ap.setEditorTimeout(t,(function(){t.selection.setRng(n)}),10),i()};t.once("touchend",e);var o=function(t){t.preventDefault(),t.stopImmediatePropagation()};t.on("mousedown",o,!0);var r=function(){return i()};t.once("longpresscancel",r);var i=function(){t.off("touchend",e),t.off("longpresscancel",r),t.off("mousedown",o)}}(t),l()};!function(t,n){var e=t.selection;if(e.isCollapsed()||n.touches.length<1)return!1;var o=n.touches[0],r=e.getRng();return Bs(t.getWin(),gs.domRange(r)).exists((function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY}))}(t,n)?(t.once("selectionchange",d),t.once("touchend",(function(){return t.off("selectionchange",d)}))):d()}else l()},IM=function(t){return"string"==typeof t?t.split(/[ ,]/):t},RM=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},VM=function(t){return o(t)?"|"===t:"separator"===t.type},PM={type:"separator"},HM=function(t){var n,e=function(t){return{text:t.text,icon:t.icon,disabled:t.disabled,shortcut:t.shortcut}};if(o(t))return t;switch(t.type){case"separator":return PM;case"submenu":return O(O({type:"nestedmenuitem"},e(t)),{getSubmenuItems:function(){var n=t.getSubmenuItems();return o(n)?n:U(n,HM)}});default:return O(O({type:"menuitem"},e(t)),{onAction:(n=t.onAction,function(){return n()})})}},zM=function(t,n){if(0===n.length)return t;var e=at(t).filter((function(t){return!VM(t)})).fold((function(){return[]}),(function(t){return[PM]}));return t.concat(e).concat(n).concat([PM])},NM=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},LM=function(t,n){return NM(t,n)?t.selection.getStart(!0):n.target},WM=function(t,n,e){var r=yn().deviceType.isTouch,i=Iu(lp.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:Ja([kg("dismissContextMenu",[Ti(fi(),(function(n,e){Of.close(n),t.focus()}))])])})),u=function(t){return lp.hide(i)},a=function(n){if(RM(t)&&n.preventDefault(),!function(t,n){return n.ctrlKey&&!RM(t)}(t,n)&&!function(t){return!1===t.getParam("contextmenu")}(t)){var u=function(t,n){var e=function(t){return t.getParam("contextmenu_avoid_overlap","","string")}(t),o=NM(t,n)?"selection":"point";if(Bt(e)){var r=LM(t,n);return By(Rt(r),e)?"node":o}return o}(t,n);(r()?FM:MM)(t,n,(function(){var e=LM(t,n),r=t.ui.registry.getAll(),i=function(t){return function(t,n,e){var o=t.ui.registry.getAll().contextMenus;return I.from(t.getParam("contextmenu")).map(IM).getOrThunk((function(){return X(IM("link linkchecker image imagetools table spellchecker configurepermanentpen"),(function(t){return yt(o,t)}))}))}(t)}(t);return function(t,n,e){var r=Y(n,(function(n,r){return bt(t,r.toLowerCase()).map((function(t){var r=t.update(e);if(o(r))return zM(n,r.split(" "));if(r.length>0){var i=U(r,HM);return zM(n,i)}return n})).getOrThunk((function(){return n.concat([r])}))}),[]);return r.length>0&&VM(r[r.length-1])&&r.pop(),r}(r.contextMenus,i,e)}),e,i,u)}};t.on("init",(function(){var n="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(r()?"":" ResizeWindow");t.on(n,u),t.on("longpress contextmenu",a)}))},UM=mr([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),jM=function(t){return function(n){return n.translate(-t.left,-t.top)}},GM=function(t){return function(n){return n.translate(t.left,t.top)}},XM=function(t){return function(n,e){return Y(t,(function(t,n){return n(t)}),ge(n,e))}},qM=function(t,n,e){return t.fold(XM([GM(e),jM(n)]),XM([jM(n)]),XM([]))},YM=function(t,n,e){return t.fold(XM([GM(e)]),XM([]),XM([GM(n)]))},KM=function(t,n,e){return t.fold(XM([]),XM([jM(e)]),XM([GM(n),jM(e)]))},JM=function(t,n,e){var o=t.fold((function(t,n){return{position:I.some("absolute"),left:I.some(t+"px"),top:I.some(n+"px")}}),(function(t,n){return{position:I.some("absolute"),left:I.some(t-e.left+"px"),top:I.some(n-e.top+"px")}}),(function(t,n){return{position:I.some("fixed"),left:I.some(t+"px"),top:I.some(n+"px")}}));return O({right:I.none(),bottom:I.none()},o)},$M=function(t,n,e,o){var r=function(t,r){return function(i,u){var a=t(n,e,o);return r(i.getOr(a.left),u.getOr(a.top))}};return t.fold(r(KM,QM),r(YM,ZM),r(qM,tA))},QM=UM.offset,ZM=UM.absolute,tA=UM.fixed,nA=function(t,n){var e=qn(t,n);return c(e)?NaN:parseInt(e,10)},eA=function(t,n,e,o,r,i){var u=function(t,n,e,o){return function(t,n){var e=t.element,o=nA(e,n.leftAttr),r=nA(e,n.topAttr);return isNaN(o)||isNaN(r)?I.none():I.some(ge(o,r))}(t,n).fold((function(){return e}),(function(t){return tA(t.left+o.left,t.top+o.top)}))}(t,n,e,o),a=n.mustSnap?rA(t,n,u,r,i):iA(t,n,u,r,i),c=qM(u,r,i);return function(t,n,e){var o=t.element;Gn(o,n.leftAttr,e.left+"px"),Gn(o,n.topAttr,e.top+"px")}(t,n,c),a.fold((function(){return{coord:tA(c.left,c.top),extra:I.none()}}),(function(t){return{coord:t.output,extra:t.extra}}))},oA=function(t,n,e,o){return st(t,(function(t){var r=t.sensor,i=function(t,n,e,o,r,i){var u=YM(t,r,i),a=YM(n,r,i);return Math.abs(u.left-a.left)<=e&&Math.abs(u.top-a.top)<=o}(n,r,t.range.left,t.range.top,e,o);return i?I.some({output:$M(t.output,n,e,o),extra:t.extra}):I.none()}))},rA=function(t,n,e,o,r){var i=n.getSnapPoints(t);return oA(i,e,o,r).orThunk((function(){var t=Y(i,(function(t,n){var i=n.sensor,u=function(t,n,e,o,r,i){var u=YM(t,r,i),a=YM(n,r,i),c=Math.abs(u.left-a.left),s=Math.abs(u.top-a.top);return ge(c,s)}(e,i,n.range.left,n.range.top,o,r);return t.deltas.fold((function(){return{deltas:I.some(u),snap:I.some(n)}}),(function(e){return(u.left+u.top)/2<=(e.left+e.top)/2?{deltas:I.some(u),snap:I.some(n)}:t}))}),{deltas:I.none(),snap:I.none()});return t.snap.map((function(t){return{output:$M(t.output,e,o,r),extra:t.extra}}))}))},iA=function(t,n,e,o,r){var i=n.getSnapPoints(t);return oA(i,e,o,r)},uA=Object.freeze({__proto__:null,snapTo:function(t,n,e,o){var r=n.getTarget(t.element);if(n.repositionTarget){var i=Cn(t.element),u=De(i),a=P_(r),c=function(t,n,e){return{coord:$M(t.output,t.output,n,e),extra:t.extra}}(o,u,a),s=JM(c.coord,0,a);ne(r,s)}}}),aA="data-initial-z-index",cA=function(t,n){t.getSystem().addToGui(n),function(t){En(t.element).filter(zt).each((function(n){re(n,"z-index").each((function(t){Gn(n,aA,t)})),Zn(n,"z-index",ee(t.element,"z-index"))}))}(n)},sA=function(t){!function(t){En(t.element).filter(zt).each((function(t){Yn(t,aA).fold((function(){return ae(t,"z-index")}),(function(n){return Zn(t,"z-index",n)})),Jn(t,aA)}))}(t),t.getSystem().removeFromGui(t)},fA=function(t,n,e){return t.getSystem().build(Ny.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},lA=er("snaps",[Lo("getSnapPoints"),ra("onSensor"),Lo("leftAttr"),Lo("topAttr"),or("lazyViewport",We),or("mustSnap",!1)]),dA=[or("useFixed",S),Lo("blockerClass"),or("getTarget",v),or("onDrag",g),or("repositionTarget",!0),or("onDrop",g),sr("getBounds",We),lA],mA=function(t,n){return{bounds:t.getBounds(),height:de(n.element),width:xe(n.element)}},gA=function(t,n,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk((function(){return mA(n,t)}));i.each((function(e){!function(t,n,e,o){var r=n.getTarget(t.element);if(n.repositionTarget){var i=Cn(t.element),u=De(i),a=P_(r),c=function(t){return(n=re(t,"left"),e=re(t,"top"),o=re(t,"position"),r=function(t,n,e){return("fixed"===e?tA:QM)(parseInt(t,10),parseInt(n,10))},n.isSome()&&e.isSome()&&o.isSome()?I.some(r(n.getOrDie(),e.getOrDie(),o.getOrDie())):I.none()).getOrThunk((function(){var n=he(t);return ZM(n.left,n.top)}));var n,e,o,r}(r),s=function(t,n,e,o,r,i,u){return function(t,n,e,o,r){var i=r.bounds,u=YM(n,e,o),a=Sa(u.left,i.x,i.x+i.width-r.width),c=Sa(u.top,i.y,i.y+i.height-r.height),s=ZM(a,c);return n.fold((function(){var t=KM(s,e,o);return QM(t.left,t.top)}),h(s),(function(){var t=qM(s,e,o);return tA(t.left,t.top)}))}(0,n.fold((function(){var t,n,u,a=(t=e,n=i.left,u=i.top,t.fold((function(t,e){return QM(t+n,e+u)}),(function(t,e){return ZM(t+n,e+u)}),(function(t,e){return tA(t+n,e+u)}))),c=qM(a,o,r);return tA(c.left,c.top)}),(function(n){var u=eA(t,n,e,i,o,r);return u.extra.each((function(e){n.onSensor(t,e)})),u.coord})),o,r,u)}(t,n.snaps,c,u,a,o,e),f=JM(s,0,a);ne(r,f)}n.onDrag(t,r,o)}(t,n,u,e)}))},pA=function(t,n,e,o){n.each(sA),e.snaps.each((function(n){!function(t,n){!function(t,n){var e=t.element;Jn(e,n.leftAttr),Jn(e,n.topAttr)}(t,n)}(t,n)}));var r=e.getTarget(t.element);o.reset(),e.onDrop(t,r)},hA=function(t){return function(n,e){var o=function(t){e.setStartData(mA(n,t))};return Ci(T([Ti(ui(),(function(t){e.getStartData().each((function(){return o(t)}))}))],t(n,e,o),!0))}},vA=Object.freeze({__proto__:null,getData:function(t){return I.from(ge(t.x,t.y))},getDelta:function(t,n){return ge(n.left-t.left,n.top-t.top)}}),bA=function(t,n,e){return[Ti(Br(),(function(o,r){if(0===r.event.raw.button){r.stop();var i=function(){return pA(o,I.some(c),t,n)},u=My(i,200),a={drop:i,delayDrop:u.schedule,forceDrop:i,move:function(e){u.cancel(),gA(o,t,n,vA,e)}},c=fA(o,t.blockerClass,function(t){return Ci([Ti(Br(),t.forceDrop),Ti(Dr(),t.drop),Ti(Mr(),(function(n,e){t.move(e.event)})),Ti(Ar(),t.delayDrop)])}(a));e(o),cA(o,c)}}))]},yA=T(T([],dA,!0),[ca("dragger",{handlers:hA(bA)})],!1),xA=Object.freeze({__proto__:null,getData:function(t){var n=t.raw.touches;return 1===n.length?function(t){var n=t[0];return I.some(ge(n.clientX,n.clientY))}(n):I.none()},getDelta:function(t,n){return ge(n.left-t.left,n.top-t.top)}}),wA=function(t,n,e){var o=Ec(),r=function(e){pA(e,o.get(),t,n),o.clear()};return[Ti(Or(),(function(i,u){u.stop();var a=function(){return r(i)},c={drop:a,delayDrop:g,forceDrop:a,move:function(e){gA(i,t,n,xA,e)}},s=fA(i,t.blockerClass,function(t){return Ci([Ti(Or(),t.forceDrop),Ti(Tr(),t.drop),Ti(Er(),t.drop),Ti(_r(),(function(n,e){t.move(e.event)}))])}(c));o.set(s),e(i),cA(i,s)})),Ti(_r(),(function(e,o){o.stop(),gA(e,t,n,xA,o.event)})),Ti(Tr(),(function(t,n){n.stop(),r(t)})),Ti(Er(),r)]},SA=yA,kA=T(T([],dA,!0),[ca("dragger",{handlers:hA(wA)})],!1),CA=T(T([],dA,!0),[ca("dragger",{handlers:hA((function(t,n,e){return T(T([],bA(t,n,e),!0),wA(t,n,e),!0)}))})],!1),OA=Object.freeze({__proto__:null,mouse:SA,touch:kA,mouseOrTouch:CA}),_A=Object.freeze({__proto__:null,init:function(){var t=I.none(),n=I.none(),e=h({});return su({readState:e,reset:function(){t=I.none(),n=I.none()},update:function(n,e){return n.getData(e).bind((function(e){return function(n,e){var o=t.map((function(t){return n.getDelta(t,e)}));return t=I.some(e),o}(n,e)}))},getStartData:function(){return n},setStartData:function(t){n=I.some(t)}})}}),TA=tc({branchKey:"mode",branches:OA,name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:I.from(t.extra)}}},state:_A,apis:uA}),EA=function(t,n,e,o,r,i){return t.fold((function(){return TA.snap({sensor:ZM(e-20,o-20),range:ge(r,i),output:ZM(I.some(e),I.some(o)),extra:{td:n}})}),(function(t){var r=e-20,i=o-20,u=t.element.dom.getBoundingClientRect();return TA.snap({sensor:ZM(r,i),range:ge(40,40),output:ZM(I.some(e-u.width/2),I.some(o-u.height/2)),extra:{td:n}})}))},BA=function(t,n,e){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,o){var r=o.td;(function(t,n){return t.exists((function(t){return Sn(t,n)}))})(n.get(),r)||(n.set(r),e(r))},mustSnap:!0}},MA=function(t){return Fp(Dp.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:Ja([TA.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),nw.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},AA=function(t,n){var e=dr([]),o=dr([]),r=dr(!1),i=Ec(),u=Ec(),a=function(t){var e=Le(t);return EA(l.getOpt(n),t,e.x,e.y,e.width,e.height)},c=function(t){var e=Le(t);return EA(d.getOpt(n),t,e.right,e.bottom,e.width,e.height)},s=BA((function(){return U(e.get(),(function(t){return a(t)}))}),i,(function(n){u.get().each((function(e){t.fire("TableSelectorChange",{start:n,finish:e})}))})),f=BA((function(){return U(o.get(),(function(t){return c(t)}))}),u,(function(n){i.get().each((function(e){t.fire("TableSelectorChange",{start:e,finish:n})}))})),l=MA(s),d=MA(f),m=Iu(l.asSpec()),g=Iu(d.asSpec()),p=function(n,e,o,r){var i=o(e);TA.snapTo(n,i),function(n,e,o,i){var u=e.dom.getBoundingClientRect();ae(n.element,"display");var a=Tn(Rt(t.getBody())).dom.innerHeight,c=u[r]<0,s=function(t,n){return t[r]>n}(u,a);(c||s)&&Zn(n.element,"display","none")}(n,e)},h=function(t){return p(m,t,a,"top")},v=function(t){return p(g,t,c,"bottom")};yn().deviceType.isTouch()&&(t.on("TableSelectionChange",(function(t){r.get()||(af(n,m),af(n,g),r.set(!0)),i.set(t.start),u.set(t.finish),t.otherCells.each((function(n){e.set(n.upOrLeftCells),o.set(n.downOrRightCells),h(t.start),v(t.finish)}))})),t.on("ResizeEditor ResizeWindow ScrollContent",(function(){i.get().each(h),u.get().each(v)})),t.on("TableSelectionClear",(function(){r.get()&&(ff(m),ff(g),r.set(!1)),i.clear(),u.clear()})))},DA=function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1};!function(t){t[t.None=0]="None",t[t.Both=1]="Both",t[t.Vertical=2]="Vertical"}(rB||(rB={}));var FA,IA=function(t,n,e){var o=Rt(t.getContainer()),r=function(t,n,e,o,r){var i={};return i.height=XB(o+n.top,Tv(t),Bv(t)),e===rB.Both&&(i.width=XB(r+n.left,_v(t),Ev(t))),i}(t,n,e,le(o),ye(o));dt(r,(function(t,n){return Zn(o,n,GB(t))})),function(t){t.fire("ResizeEditor")}(t)},RA=function(t,n,e,o){var r=ge(20*e,20*o);return IA(t,r,n),I.some(!0)},VA=function(t,n){var e=function(){var e,o=[];return t.getParam("elementpath",!0,"boolean")&&o.push(function(t,n,e){return n.delimiter||(n.delimiter=""),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:Ja([hg.config({mode:"flow",selector:"div[role=button]"}),dd.config({disabled:e.isDisabled}),Zv(),qy.config({}),Sg.config({}),kg("elementPathEvents",[Ri((function(o,r){t.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return hg.focusIn(o)})),t.on("NodeChange",(function(r){var i,u,a=function(n){for(var e=[],o=n.length;o-- >0;){var r=n[o];if(1===r.nodeType&&!DA(r)){var i=t.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r});if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e}(r.parents);a.length>0?Sg.set(o,(i=U(a||[],(function(n,o){return Dp.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:n.name},action:function(e){t.focus(),t.selection.select(n.element),t.nodeChanged()},buttonBehaviours:Ja([tb(e.isDisabled),Zv()])})})),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+n.delimiter+" "}},Y(i.slice(1),(function(t,n){var e=t;return e.push(u),e.push(n),e}),[i[0]]))):Sg.set(o,[])}))}))])]),components:[]}}(t,{},n)),t.hasPlugin("wordcount")&&o.push(function(t,n){var e,o=function(t,e,o){return Sg.set(t,[Au(n.translate(["{0} "+o,e[o]]))])};return Dp.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:Ja([tb(n.isDisabled),Zv(),qy.config({}),Sg.config({}),Gf.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),kg("wordcount-events",[Hi((function(t){var n=Gf.getValue(t),e="words"===n.mode?"characters":"words";Gf.setValue(t,{mode:e,count:n.count}),o(t,n.count,e)})),Ri((function(n){t.on("wordCountUpdate",(function(t){var e=Gf.getValue(n).mode;Gf.setValue(n,{mode:e,count:t.wordCount}),o(n,t.wordCount,e)}))}))])]),eventOrder:(e={},e[$r()]=["disabling","alloy.base.behaviour","wordcount-events"],e)})}(t,n)),t.getParam("branding",!0,"boolean")&&o.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(e=Ip.translate(["Powered by {0}","Tiny"]))+'">'+e+"</a>"}}),o.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:o}]:[]};return{dom:{tag:"div",classes:["tox-statusbar"]},components:function(){var o=e(),r=function(t,n){var e=function(t){var n=!t.hasPlugin("autoresize"),e=t.getParam("resize",n);return!1===e?rB.None:"both"===e?rB.Both:rB.Vertical}(t);return e===rB.None?I.none():I.some(Up("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize")},behaviours:[TA.config({mode:"mouse",repositionTarget:!1,onDrag:function(n,o,r){return IA(t,r,e)},blockerClass:"tox-blocker"}),hg.config({mode:"special",onLeft:function(){return RA(t,e,-1,0)},onRight:function(){return RA(t,e,1,0)},onUp:function(){return RA(t,e,0,-1)},onDown:function(){return RA(t,e,0,1)}}),qy.config({}),Eg.config({})]},n.icons))}(t,n);return o.concat(r.toArray())}()}},PA=function(t){var n,e,o,r,i=t.inline,u=i?KB:UB,a=jv(t)?sT:R_,c=I.none(),s=yn(),f=s.browser.isIE()?["tox-platform-ie"]:[],l=s.deviceType.isTouch()?["tox-platform-touch"]:[],d=zv(t),m=Wv(t),p=Ip.isRtl()?{attributes:{dir:"rtl"}}:{},h={attributes:(n={},n[qc]=d?bc.BottomToTop:bc.TopToBottom,n)},v=function(){return c.bind(PE.getHeader)},b=Iu((e=Sn(Wn(),m)&&"grid"===ee(m,"display"),o={dom:O({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(f).concat(l)},p),behaviours:Ja([nf.config({useFixed:function(){return a.isDocked(v)}})])},r={dom:{styles:{width:document.body.clientWidth+"px"}},events:Ci([Ti(ai(),(function(){Zn(G.element,"width",document.body.clientWidth+"px")}))])},no(o,e?r:{}))),y=function(){return Ge.value(b)},x=Fp({dom:{tag:"div",classes:["tox-anchorbar"]}}),w=function(){return c.bind((function(t){return PE.getThrobber(t)})).getOrDie("Could not find throbber element")},S=function(t,n,e){var o=dr(!1),r=function(t){var n=dr(zv(t)?"bottom":"top");return{isPositionedAtTop:function(){return"top"===n.get()},getDockingMode:n.get,setDockingMode:n.set}}(n),i={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:Ip.translate,isDisabled:function(){return n.mode.isReadOnly()||n.ui.isDisabled()},getSetting:n.getParam.bind(n)},interpreter:function(t){return function(t,n){return DO(MO,t,n)}(t,i)},anchors:HO(n,e,r.isPositionedAtTop),header:r,getSink:function(){return Ge.value(t)}},urlinput:S_(n),styleselect:$O(n),colorinput:UO(n),dialog:GO(n),isContextMenuOpen:function(){return o.get()},setContextMenuState:function(t){return o.set(t)}};return i}(b,t,(function(){return c.bind((function(t){return x.getOpt(t)})).getOrDie("Could not find a anchor bar element")})),k=PE.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:S,onEscape:function(){t.focus()}}),C=Rv(t),_=PE.parts.toolbar(O({dom:{tag:"div",classes:["tox-toolbar"]},getSink:y,providers:S.shared.providers,onEscape:function(){t.focus()},type:C,lazyToolbar:function(){return c.bind((function(t){return PE.getToolbar(t)})).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return v().getOrDie("Could not find header element")}},h)),T=PE.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:S.shared.providers,onEscape:function(){t.focus()},type:C}),E=PE.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),B=PE.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),M=PE.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:S}),A=t.getParam("statusbar",!0,"boolean")&&!i?I.some(VA(t,S.shared.providers)):I.none(),D={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[E,B]},F=Fv(t),R=Av(t),V=Mv(t),P=PE.parts.header({dom:O({tag:"div",classes:["tox-editor-header"]},h),components:$([V?[k]:[],F?[T]:R?[_]:[],Lv(t)?[]:[x.asSpec()]]),sticky:jv(t),editor:t,sharedBackstage:S.shared}),H=$([d?[]:[P],i?[]:[D],d?[P]:[]]),z=$([[{dom:{tag:"div",classes:["tox-editor-container"]},components:H}],i?[]:A.toArray(),[M]]),N=Uv(t),L=O(O({role:"application"},Ip.isRtl()?{dir:"rtl"}:{}),N?{"aria-hidden":"true"}:{}),W=Iu(PE.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(i?["tox-tinymce-inline"]:[]).concat(d?["tox-tinymce--toolbar-bottom"]:[]).concat(l).concat(f),styles:O({visibility:"hidden"},N?{opacity:"0",border:"0"}:{}),attributes:L},components:z,behaviours:Ja([Zv(),dd.config({disableClass:"tox-tinymce--disabled"}),hg.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])}));c=I.some(W),t.shortcuts.add("alt+F9","focus menubar",(function(){PE.focusMenubar(W)})),t.shortcuts.add("alt+F10","focus toolbar",(function(){PE.focusToolbar(W)})),t.addCommand("ToggleToolbarDrawer",(function(){PE.toggleToolbarDrawer(W)})),t.addQueryStateHandler("ToggleToolbarDrawer",(function(){return PE.isToolbarDrawerToggled(W)}));var U=Ly(W),G=Ly(b);!function(t,n,e){var o=function(t,o){j([n,e],(function(n){n.broadcastEvent(t,o)}))},r=function(t,o){j([n,e],(function(n){n.broadcastOn([t],o)}))},i=function(t){return r(_f(),{target:t.target})},u=rc(),a=Mc(u,"touchstart",i),c=Mc(u,"touchmove",(function(t){return o(ri(),t)})),s=Mc(u,"touchend",(function(t){return o(ii(),t)})),f=Mc(u,"mousedown",i),l=Mc(u,"mouseup",(function(t){0===t.raw.button&&r(Ef(),{target:t.target})})),d=function(t){return r(_f(),{target:Rt(t.target)})},m=function(t){0===t.button&&r(Ef(),{target:Rt(t.target)})},g=function(){j(t.editorManager.get(),(function(n){t!==n&&n.fire("DismissPopups",{relatedTarget:t})}))},p=function(t){return o(ui(),Dc(t))},h=function(t){r(Tf(),{}),o(ai(),Dc(t))},v=function(){return r(Tf(),{})},b=function(n){n.state&&r(_f(),{target:Rt(t.getContainer())})},y=function(t){r(_f(),{target:Rt(t.relatedTarget.getContainer())})};t.on("PostRender",(function(){t.on("click",d),t.on("tap",d),t.on("mouseup",m),t.on("mousedown",g),t.on("ScrollWindow",p),t.on("ResizeWindow",h),t.on("ResizeEditor",v),t.on("AfterProgressState",b),t.on("DismissPopups",y)})),t.on("remove",(function(){t.off("click",d),t.off("tap",d),t.off("mouseup",m),t.off("mousedown",g),t.off("ScrollWindow",p),t.off("ResizeWindow",h),t.off("ResizeEditor",v),t.off("AfterProgressState",b),t.off("DismissPopups",y),f.unbind(),a.unbind(),c.unbind(),s.unbind(),l.unbind()})),t.on("detach",(function(){gf(n),gf(e),n.destroy(),e.destroy()}))}(t,U,G);var X=function(){var n=GB(function(t){var n=function(t){var n=Cv(t),e=Tv(t),o=Bv(t);return jB(n).map((function(t){return XB(t,e,o)}))}(t);return n.getOr(Cv(t))}(t)),e=GB(function(t){return qB(t).getOr(Ov(t))}(t));return t.inline||(ue("div","width",e)&&Zn(W.element,"width",e),ue("div","height",n)?Zn(W.element,"height",n):Zn(W.element,"height","200px")),n};return{mothership:U,uiMothership:G,backstage:S,renderUI:function(){a.setup(t,S.shared,v),CM(t,S),WM(t,y,S),function(t){var n=t.ui.registry.getAll().sidebars;j(ft(n),(function(e){var o=n[e],r=function(){return wt(I.from(t.queryCommandValue("ToggleSidebar")),e)};t.ui.registry.addToggleButton(e,{icon:o.icon,tooltip:o.tooltip,onAction:function(n){t.execCommand("ToggleSidebar",!1,e),n.setActive(r())},onSetup:function(n){var e=function(){return n.setActive(r())};return t.on("ToggleSidebar",e),function(){t.off("ToggleSidebar",e)}}})}))}(t),JT(t,w,S.shared),mt(function(t){return t.getParam("toolbar_groups",{},"object")}(t),(function(n,e){t.ui.registry.addGroupToolbarButton(e,n)}));var n=t.ui.registry.getAll(),e=n.buttons,o=n.menuItems,r=n.contextToolbars,i=n.sidebars,c=Dv(t),s={menuItems:o,menus:Gv(t),menubar:Xv(t),toolbar:c.getOrThunk((function(){return function(t){return t.getParam("toolbar",!0)}(t)})),allowToolbarGroups:C===Ch.floating,buttons:e,sidebar:i};gM(t,r,b,{backstage:S}),AA(t,b);var f=t.getElement(),l=X(),d={mothership:U,uiMothership:G,outerContainer:W},m={targetNode:f,height:l};return u.render(t,d,s,S,m)},getUi:function(){return{channels:{broadcastAll:G.broadcast,broadcastOn:G.broadcastOn,register:g}}}}},HA=h([Lo("lazySink"),Jo("dragBlockClass"),sr("getBounds",We),or("useTabstopAt",k),or("eventOrder",{}),Xf("modalBehaviours",[hg]),ia("onExecute"),aa("onEscape")]),zA={sketch:v},NA=h([wl({name:"draghandle",overrides:function(t,n){return{behaviours:Ja([TA.config({mode:"mouse",getTarget:function(t){return Lu(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),yl({schema:[Lo("dom")],name:"title"}),yl({factory:zA,schema:[Lo("dom")],name:"close"}),yl({factory:zA,schema:[Lo("dom")],name:"body"}),wl({factory:zA,schema:[Lo("dom")],name:"footer"}),xl({factory:{sketch:function(t,n){return O(O({},t),{dom:n.dom,components:n.components})}},schema:[or("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),or("components",[])],name:"blocker"})]),LA=Yl({name:"ModalDialog",configFields:HA(),partFields:NA(),factory:function(t,n,e,o){var r,i=Ec(),u=Xi("modal-events"),a=O(O({},t.eventOrder),((r={})[ci()]=[u].concat(t.eventOrder["alloy.system.attached"]||[]),r));return{uid:t.uid,dom:t.dom,components:n,apis:{show:function(n){i.set(n);var e=t.lazySink(n).getOrDie(),r=o.blocker(),u=e.getSystem().build(O(O({},r),{components:r.components.concat([Ru(n)]),behaviours:Ja([Eg.config({}),kg("dialog-blocker-events",[Ii(Ir(),(function(){hg.focusIn(n)}))])])}));af(e,u),hg.focusIn(n)},hide:function(t){i.clear(),En(t.element).each((function(n){t.getSystem().getByDom(n).each((function(t){ff(t)}))}))},getBody:function(n){return Il(n,t,"body")},getFooter:function(n){return Il(n,t,"footer")},setIdle:function(t){qT.unblock(t)},setBusy:function(t,n){qT.block(t,n)}},eventOrder:a,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Yf(t.modalBehaviours,[Sg.config({}),hg.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),qT.config({getRoot:i.get}),kg(u,[Ri((function(n){var e,o,r,i,u,a;e=n.element,o=Il(n,t,"title").element,r=Yn(e,"id").fold((function(){var t=Xi("dialog-label");return Gn(o,"id",t),t}),v),Gn(e,"aria-labelledby",r),i=n.element,u=Il(n,t,"body").element,a=I.from(qn(i,"id")).fold((function(){var t=Xi("dialog-describe");return Gn(u,"id",t),t}),v),Gn(i,"aria-describedby",a)}))])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),WA=vo([jo("type"),jo("name")].concat(ev)),UA=_o,jA=[Ho("name","name",oo((function(){return Xi("button-name")})),Oo),Zo("icon"),ar("align","end",["start","end"]),cr("primary",!1),cr("disabled",!1)],GA=T(T([],jA,!0),[jo("text")],!1),XA=T([Go("type",["submit","cancel","custom"])],GA,!0),qA=T([Go("type",["menu"]),Zo("text"),Zo("tooltip"),Zo("icon"),Ko("items",WA)],jA,!0),YA=Po("type",{submit:XA,cancel:XA,custom:XA,menu:qA}),KA=[jo("type"),jo("text"),Go("level",["info","warn","error","success"]),jo("icon"),or("url","")],JA=vo(KA),$A=[jo("type"),jo("text"),cr("disabled",!1),cr("primary",!1),Ho("name","name",oo((function(){return Xi("button-name")})),Oo),Zo("icon"),cr("borderless",!1)],QA=vo($A),ZA=[jo("type"),jo("name"),jo("label"),cr("disabled",!1)],tD=vo(ZA),nD=_o,eD=[jo("type"),jo("name")],oD=eD.concat([Zo("label")]),rD=oD.concat([or("columns","auto")]),iD=vo(rD),uD=wo([jo("value"),jo("text"),jo("icon")]),aD=vo(oD),cD=Oo,sD=vo(oD),fD=Oo,lD=eD.concat([ur("tag","textarea"),jo("scriptId"),jo("scriptUrl"),rr("settings",void 0,Bo)]),dD=eD.concat([ur("tag","textarea"),Xo("init")]),mD=Ao((function(t){return Fo("customeditor.old",ho(dD),t).orThunk((function(){return Fo("customeditor.new",ho(lD),t)}))})),gD=Oo,pD=vo(oD),hD=bo(fo),vD=function(t){return[jo("type"),Uo("columns"),t]},bD=[jo("type"),jo("html"),ar("presets","presentation",["presentation","document"])],yD=vo(bD),xD=oD.concat([cr("sandboxed",!0)]),wD=vo(xD),SD=Oo,kD=oD.concat([Wo("currentState",vo([Lo("blob"),jo("url")]))]),CD=vo(kD),OD=oD.concat([Zo("inputMode"),Zo("placeholder"),cr("maximized",!1),cr("disabled",!1)]),_D=vo(OD),TD=Oo,ED=function(t){return[jo("type"),jo("label"),t]},BD=[jo("text"),jo("value")],MD=[jo("text"),Ko("items",(FA=Ut((function(){return AD})),{extract:function(t,n){return FA().extract(t,n)},toString:function(){return FA().toString()}}))],AD=yo([vo(BD),vo(MD)]),DD=oD.concat([Ko("items",AD),cr("disabled",!1)]),FD=vo(DD),ID=Oo,RD=oD.concat([Yo("items",[jo("text"),jo("value")]),ir("size",1),cr("disabled",!1)]),VD=vo(RD),PD=Oo,HD=oD.concat([cr("constrain",!0),cr("disabled",!1)]),zD=vo(HD),ND=vo([jo("width"),jo("height")]),LD=[jo("type"),Ko("header",Oo),Ko("cells",bo(Oo))],WD=vo(LD),UD=oD.concat([Zo("placeholder"),cr("maximized",!1),cr("disabled",!1)]),jD=vo(UD),GD=Oo,XD=oD.concat([ar("filetype","file",["image","media","file"]),or("disabled",!1)]),qD=vo(XD),YD=vo([jo("value"),or("meta",{})]),KD=function(t){return Ho("items","items",{tag:"required",process:{}},bo(Ao((function(n){return Fo("Checking item of "+t,JD,n).fold((function(t){return Ge.error(Vo(t))}),(function(t){return Ge.value(t)}))}))))},JD=go((function(){return Mo("type",{alertbanner:JA,bar:vo((t=KD("bar"),[jo("type"),t])),button:QA,checkbox:tD,colorinput:aD,colorpicker:sD,dropzone:pD,grid:vo(vD(KD("grid"))),iframe:wD,input:_D,listbox:FD,selectbox:VD,sizeinput:zD,textarea:jD,urlinput:qD,customeditor:mD,htmlpanel:yD,imagetools:CD,collection:iD,label:vo(ED(KD("label"))),table:WD,panel:QD});var t})),$D=[jo("type"),or("classes",[]),Ko("items",JD)],QD=vo($D),ZD=[Ho("name","name",oo((function(){return Xi("tab-name")})),Oo),jo("title"),Ko("items",JD)],tF=[jo("type"),Yo("tabs",ZD)],nF=vo(tF),eF=GA,oF=YA,rF=vo([jo("title"),Wo("body",Mo("type",{panel:QD,tabpanel:nF})),ur("size","normal"),Ko("buttons",oF),or("initialData",{}),sr("onAction",g),sr("onChange",g),sr("onSubmit",g),sr("onClose",g),sr("onCancel",g),or("onTabChange",g)]),iF=vo(T([Go("type",["cancel","custom"])],eF,!0)),uF=vo([jo("title"),jo("url"),Qo("height"),Qo("width"),nr("buttons",iF),sr("onAction",g),sr("onCancel",g),sr("onClose",g),sr("onMessage",g)]),aF=function(t){return r(t)?[t].concat(Q(vt(t),aF)):i(t)?Q(t,aF):[]},cF=function(t){return o(t.type)&&o(t.name)},sF={checkbox:nD,colorinput:cD,colorpicker:fD,dropzone:hD,input:TD,iframe:SD,sizeinput:ND,selectbox:PD,listbox:ID,size:ND,textarea:GD,urlinput:YD,customeditor:gD,collection:uD,togglemenuitem:UA},fF=function(t){var n=function(t){return X(aF(t),cF)}(t),e=Q(n,(function(t){return function(t){return I.from(sF[t.type])}(t).fold((function(){return[]}),(function(n){return[Wo(t.name,n)]}))}));return vo(e)},lF=function(t){return{internalDialog:Io(Fo("dialog",rF,t)),dataValidator:fF(t),initialData:t.initialData}},dF={open:function(t,n){var e=lF(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){return t(Io(Fo("dialog",uF,n)))},redial:function(t){return lF(t)}},mF=function(t){var n=[],e={};return dt(t,(function(t,o){t.fold((function(){n.push(o)}),(function(t){e[o]=t}))})),n.length>0?Ge.error(n):Ge.value(e)},gF=function(t,n){var e,o=Fp(QS.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"].concat(t.classes)},components:U(t.items,(function(t){return AO(e,t,n)}))}})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[o.asSpec()]}],behaviours:Ja([hg.config({mode:"acyclic",useTabstopAt:x(kk)}),(e=o,Ql.config({find:e.getOpt})),mk(o,{postprocess:function(t){return mF(t).fold((function(t){return console.error(t),{}}),v)}})])}},pF=ql({name:"TabButton",configFields:[or("uid",void 0),Lo("value"),Ho("dom","dom",io((function(){return{attributes:{role:"tab",id:Xi("aria"),"aria-selected":"false"}}})),So()),Jo("action"),or("domModification",{}),Xf("tabButtonBehaviours",[Eg,hg,Gf]),Lo("view")],factory:function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:Wg(t.action),behaviours:Yf(t.tabButtonBehaviours,[Eg.config({}),hg.config({mode:"execution",useSpace:!0,useEnter:!0}),Gf.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),hF=h([Lo("tabs"),Lo("dom"),or("clickToDismiss",!1),Xf("tabbarBehaviours",[Sd,hg]),ea(["tabClass","selectedClass"])]),vF=Sl({factory:pF,name:"tabs",unit:"tab",overrides:function(t){var n=function(t,n){Sd.dehighlight(t,n),yi(t,pi(),{tabbar:t,button:n})},e=function(t,n){Sd.highlight(t,n),yi(t,gi(),{tabbar:t,button:n})};return{action:function(o){var r=o.getSystem().getByUid(t.uid).getOrDie(),i=Sd.isHighlighted(r,o);(i&&t.clickToDismiss?n:i?g:e)(r,o)},domModification:{classes:[t.markers.tabClass]}}}}),bF=h([vF]),yF=Yl({name:"Tabbar",configFields:hF(),partFields:bF(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Yf(t.tabbarBehaviours,[Sd.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){Gn(n.element,"aria-selected","true")},onDehighlight:function(t,n){Gn(n.element,"aria-selected","false")}}),hg.config({mode:"flow",getInitial:function(t){return Sd.getHighlighted(t).map((function(t){return t.element}))},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),xF=ql({name:"Tabview",configFields:[Xf("tabviewBehaviours",[Sg])],factory:function(t,n){return{uid:t.uid,dom:t.dom,behaviours:Yf(t.tabviewBehaviours,[Sg.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),wF=h([or("selectFirst",!0),ra("onChangeTab"),ra("onDismissTab"),or("tabs",[]),Xf("tabSectionBehaviours",[])]),SF=yl({factory:yF,schema:[Lo("dom"),qo("markers",[Lo("tabClass"),Lo("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),kF=yl({factory:xF,name:"tabview"}),CF=h([SF,kF]),OF=Yl({name:"TabSection",configFields:wF(),partFields:CF(),factory:function(t,n,e,o){var r=function(n,e){Fl(n,t,"tabbar").each((function(t){e(t).each(xi)}))};return{uid:t.uid,dom:t.dom,components:n,behaviours:qf(t.tabSectionBehaviours),events:Ci($([t.selectFirst?[Ri((function(t,n){r(t,Sd.getFirst)}))]:[],[Ti(gi(),(function(n,e){var o,r;o=e.event.button,r=Gf.getValue(o),Fl(o,t,"tabview").each((function(n){K(t.tabs,(function(t){return t.value===r})).each((function(e){var r=e.view();Yn(o.element,"id").each((function(t){Gn(n.element,"aria-labelledby",t)})),Sg.set(n,r),t.onChangeTab(n,o,r)}))}))})),Ti(pi(),(function(n,e){var o=e.event.button;t.onDismissTab(n,o)}))]])),apis:{getViewItems:function(n){return Fl(n,t,"tabview").map((function(t){return Sg.contents(t)})).getOr([])},showTab:function(t,n){r(t,(function(t){var e=Sd.getCandidates(t);return K(e,(function(t){return Gf.getValue(t)===n})).filter((function(n){return!Sd.isHighlighted(t,n)}))}))}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),_F=function(t,n){Zn(t,"height",n+"px"),yn().browser.isIE()?ae(t,"flex-basis"):Zn(t,"flex-basis",n+"px")},TF=function(t,n,e){Lu(t,'[role="dialog"]').each((function(t){Uu(t,'[role="tablist"]').each((function(o){e.get().map((function(e){return Zn(n,"height","0"),Zn(n,"flex-basis","0"),Math.min(e,function(t,n,e){var o,r=_n(t).dom,i=Lu(t,".tox-dialog-wrap").getOr(t);o="fixed"===ee(i,"position")?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight);var u=le(n),a=n.dom.offsetLeft>=e.dom.offsetLeft+ye(e)?Math.max(le(e),u):u,c=parseInt(ee(t,"margin-top"),10)||0,s=parseInt(ee(t,"margin-bottom"),10)||0;return o-(le(t)+c+s-a)}(t,n,o))})).each((function(t){_F(n,t)}))}))}))},EF=function(t){return Uu(t,'[role="tabpanel"]')},BF="send-data-to-section",MF="send-data-to-view",AF=function(t,n){var e=dr({}),o=function(t){var n=Gf.getValue(t),o=mF(n).getOr({}),r=e.get(),i=no(r,o);e.set(i)},r=function(t){var n=e.get();Gf.setValue(t,n)},i=dr(null),u=U(t.tabs,(function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:n.shared.providers.translate(t.title)},view:function(){return[QS.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"]},components:U(t.items,(function(t){return AO(e,t,n)})),formBehaviours:Ja([hg.config({mode:"acyclic",useTabstopAt:x(kk)}),kg("TabView.form.events",[Ri(r),Vi(o)]),ec.config({channels:vr([{key:BF,value:{onReceive:o}},{key:MF,value:{onReceive:r}}])})])}}))]}}})),a=function(t){var n,e,o=(n=Ec(),e=[Ri((function(e){var o=e.element;EF(o).each((function(r){Zn(r,"visibility","hidden"),e.getSystem().getByDom(r).toOptional().each((function(e){var o=function(t,n,e){return U(t,(function(o,r){Sg.set(e,t[r].view());var i=n.dom.getBoundingClientRect();return Sg.set(e,[]),i.height}))}(t,r,e),i=function(t){return ut(rt(t,(function(t,n){return t>n?-1:t<n?1:0})))}(o);i.fold(n.clear,n.set)})),TF(o,r,n),ae(r,"visibility"),function(t,n){ut(t).each((function(t){return OF.showTab(n,t.value)}))}(t,e),Ap.requestAnimationFrame((function(){TF(o,r,n)}))}))})),Ti(ai(),(function(t){var e=t.element;EF(e).each((function(t){TF(e,t,n)}))})),Ti(ax,(function(t,e){var o=t.element;EF(o).each((function(t){var e=ac(Pn(t));Zn(t,"visibility","hidden");var r=re(t,"height").map((function(t){return parseInt(t,10)}));ae(t,"height"),ae(t,"flex-basis");var i=t.dom.getBoundingClientRect().height;r.forall((function(t){return i>t}))?(n.set(i),TF(o,t,n)):r.each((function(n){_F(t,n)})),ae(t,"visibility"),e.each(ic)}))}))],{extraEvents:e,selectFirst:!1});return{smartTabHeight:o,naiveTabHeight:{extraEvents:[],selectFirst:!0}}}(u).smartTabHeight;return OF.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){var o=Gf.getValue(n);yi(t,ux,{name:o,oldName:i.get()}),i.set(o)},tabs:u,components:[OF.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[yF.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:Ja([qy.config({})])}),OF.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:a.selectFirst,tabSectionBehaviours:Ja([kg("tabpanel",a.extraEvents),hg.config({mode:"acyclic"}),Ql.config({find:function(t){return ut(OF.getViewItems(t))}}),Gf.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([BF],{}),e.get()},setValue:function(t,n){e.set(n),t.getSystem().broadcastOn([MF],{})}}})])})},DF=Xi("update-dialog"),FF=Xi("update-title"),IF=Xi("update-body"),RF=Xi("update-footer"),VF=Xi("body-send-message"),PF=function(t,n,e,o){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:O(O({},n.map((function(t){return{id:t}})).getOr({})),o?{"aria-live":"polite"}:{})},components:[],behaviours:Ja([uk(0),xB.config({channel:IF,updateState:function(t,n){return I.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){return"tabpanel"===t.body.type?[AF(t.body,e)]:[gF(t.body,e)]},initialData:t})])}},HF=lb.deviceType.isTouch(),zF=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},NF=function(t,n){return LA.parts.close(Dp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:Ja([qy.config({})])}))},LF=function(){return LA.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},WF=function(t,n){return LA.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:YT("<p>"+n.translate(t)+"</p>")}]}]})},UF=function(t){return LA.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},jF=function(t,n){return[Ny.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),Ny.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},GF=function(t){var n,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll";return LA.sketch({lazySink:t.lazySink,onEscape:function(n){return t.onEscape(n),I.some(!0)},useTabstopAt:function(t){return!kk(t)},dom:{tag:"div",classes:[e].concat(t.extraClasses),styles:O({position:"relative"},t.extraStyles)},components:T([t.header,t.body],t.footer.toArray(),!0),parts:{blocker:{dom:YT('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:HF?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:Ja(T([Eg.config({}),kg("dialog-events",t.dialogEvents.concat([Ii(Ir(),(function(t,n){hg.focusIn(t)}))])),kg("scroll-lock",[Ri((function(){wu(Wn(),i)})),Vi((function(){Su(Wn(),i)}))])],t.extraBehaviours,!0)),eventOrder:O((n={},n[$r()]=["dialog-events"],n[ci()]=["scroll-lock","dialog-events","alloy.base.behaviour"],n[si()]=["alloy.base.behaviour","dialog-events","scroll-lock"],n),t.eventOrder)})},XF=function(t){return Dp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[Up("close",{tag:"div",classes:["tox-icon"]},t.icons)],action:function(t){bi(t,nx)}})},qF=function(t,n,e){var o=function(t){return[Au(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:O({},n.map((function(t){return{id:t}})).getOr({}))},components:o(t),behaviours:Ja([xB.config({channel:FF,renderComponents:o})])}},YF=function(){return{dom:YT('<div class="tox-dialog__draghandle"></div>')}},KF=function(t,n){return function(t,n){var e=LA.parts.title(qF(t,I.none(),n)),o=LA.parts.draghandle(YF()),r=LA.parts.close(XF(n)),i=[e].concat(t.draggable?[o]:[]).concat([r]);return Ny.sketch({dom:YT('<div class="tox-dialog__header"></div>'),components:i})}({title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},n.shared.providers)},JF=function(t,n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(t)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:YT('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},$F=function(t,n,e){return{onClose:function(){return e.closeWindow()},onBlock:function(e){LA.setBusy(t(),(function(t,o){return JF(e.message,o,n)}))},onUnblock:function(){LA.setIdle(t())}}},QF=function(t,n,e,o){var r;return Iu(GF(O(O({},t),{lazySink:o.shared.getSink,extraBehaviours:T([xB.config({channel:DF,updateState:function(t,n){return I.some(n)},initialData:n}),hk({})],t.extraBehaviours,!0),onEscape:function(t){bi(t,nx)},dialogEvents:e,eventOrder:(r={},r[Jr()]=[xB.name(),ec.name()],r[ci()]=["scroll-lock",xB.name(),"messages","dialog-events","alloy.base.behaviour"],r[si()]=["alloy.base.behaviour","dialog-events","messages",xB.name(),"scroll-lock"],r)})))},ZF=function(t){return U(t,(function(t){return"menu"===t.type?function(t){var n=U(t.items,(function(t){var n=dr(!1);return O(O({},t),{storage:n})}));return O(O({},t),{items:n})}(t):t}))},tI=function(t){return Y(t,(function(t,n){return"menu"===n.type?Y(n.items,(function(t,n){return t[n.name]=n.storage,t}),t):t}),{})},nI=function(t,n){return[Ai(Ir(),Sk),t(tx,(function(t,e){n.onClose(),e.onClose()})),t(nx,(function(t,n,e,o){n.onCancel(t),bi(o,tx)})),Ti(ix,(function(t,e){return n.onUnblock()})),Ti(rx,(function(t,e){return n.onBlock(e.event)}))]},eI=function(t,n,e){var o=function(n,e){return Ti(n,(function(n,o){r(n,(function(r,i){e(t(),r,o.event,n)}))}))},r=function(t,n){xB.getState(t).get().each((function(e){n(e.internalDialog,t)}))};return T(T([],nI(o,n),!0),[o(ox,(function(t,n){return n.onSubmit(t)})),o(Zy,(function(t,n,e){n.onChange(t,{name:e.name})})),o(ex,(function(t,n,o,r){var i=function(){return hg.focusIn(r)},u=function(t){return Kn(t,"disabled")||Yn(t,"aria-disabled").exists((function(t){return"true"===t}))},a=Pn(r.element),c=ac(a);n.onAction(t,{name:o.name,value:o.value}),ac(a).fold(i,(function(t){u(t)||c.exists((function(n){return kn(t,n)&&u(n)}))?i():e().toOptional().filter((function(n){return!kn(n.element,t)})).each(i)}))})),o(ux,(function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})})),Vi((function(n){var e=t();Gf.setValue(n,e.getData())}))],!1)},oI=function(t,n){var e=n.map((function(t){return t.footerButtons})).getOr([]),o=G(e,(function(t){return"start"===t.align})),r=function(t,n){return Ny.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:U(n,(function(t){return t.memento.asSpec()}))})};return[r("start",o.pass),r("end",o.fail)]},rI=function(t,n){return{dom:YT('<div class="tox-dialog__footer"></div>'),components:[],behaviours:Ja([xB.config({channel:RF,initialData:t,updateState:function(t,e){var o=U(e.buttons,(function(t){var e=Fp(function(t,n){return _C(t,t.type,n)}(t,n));return{name:t.name,align:t.align,memento:e}}));return I.some({lookupByName:function(t,n){return function(t,n,e){return K(n,(function(t){return t.name===e})).bind((function(n){return n.memento.getOpt(t)}))}(t,o,n)},footerButtons:o})},renderComponents:oI})])}},iI=function(t,n){return LA.parts.footer(rI(t,n))},uI=function(t,n){if(t.getRoot().getSystem().isConnected()){var e=Ql.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return QS.getField(e,n).fold((function(){var o=t.getFooter();return xB.getState(o).get().bind((function(t){return t.lookupByName(e,n)}))}),(function(t){return I.some(t)}))}return I.none()},aI=function(t,n,e){var r=function(n){var e=t.getRoot();e.getSystem().isConnected()&&n(e)},i={getData:function(){var n=t.getRoot(),o=n.getSystem().isConnected()?t.getFormWrapper():n,r=Gf.getValue(o),i=mt(e,(function(t){return t.get()}));return O(O({},r),i)},setData:function(n){r((function(o){var r=i.getData(),u=O(O({},r),n),a=function(t,n){var e=t.getRoot();return xB.getState(e).get().map((function(t){return Io(Fo("data",t.dataValidator,n))})).getOr(n)}(t,u),c=t.getFormWrapper();Gf.setValue(c,a),dt(e,(function(t,n){yt(u,n)&&t.set(u[n])}))}))},disable:function(n){uI(t,n).each(dd.disable)},enable:function(n){uI(t,n).each(dd.enable)},focus:function(n){uI(t,n).each(Eg.focus)},block:function(t){if(!o(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");r((function(n){yi(n,rx,{message:t})}))},unblock:function(){r((function(t){bi(t,ix)}))},showTab:function(n){r((function(e){var o=t.getBody();xB.getState(o).get().exists((function(t){return t.isTabPanel()}))&&Ql.getCurrent(o).each((function(t){OF.showTab(t,n)}))}))},redial:function(t){r((function(e){var o=n(t);e.getSystem().broadcastOn([DF],o),e.getSystem().broadcastOn([FF],o.internalDialog),e.getSystem().broadcastOn([IF],o.internalDialog),e.getSystem().broadcastOn([RF],o.internalDialog),i.setData(o.initialData)}))},close:function(){r((function(t){bi(t,tx)}))}};return i},cI=tinymce.util.Tools.resolve("tinymce.util.URI"),sI=["insertContent","setContent","execCommand","close","block","unblock"],fI=function(t){return r(t)&&-1!==sI.indexOf(t.mceAction)},lI=function(t,n,e,i){var u,c,s,f,l,d,m,g,p=KF(t.title,i),h=(g={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[xk({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:Ja([qy.config({}),Eg.config({})])})]}],behaviours:Ja([hg.config({mode:"acyclic",useTabstopAt:x(kk)})])},LA.parts.body(g)),v=t.buttons.bind((function(t){return 0===t.length?I.none():I.some(iI({buttons:t},i))})),b=(f=function(){return B},l=$F((function(){return E}),i.shared.providers,n),d=function(t,n){return Ti(t,(function(t,e){m(t,(function(o,r){n(f(),o,e.event,t)}))}))},m=function(t,n){xB.getState(t).get().each((function(e){n(e,t)}))},T(T([],nI(d,l),!0),[d(ex,(function(t,n,e){n.onAction(t,{name:e.name})}))],!1)),y=O(O({},t.height.fold((function(){return{}}),(function(t){return{height:t+"px","max-height":t+"px"}}))),t.width.fold((function(){return{}}),(function(t){return{width:t+"px","max-width":t+"px"}}))),w=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],S=new cI(t.url,{base_uri:new cI(window.location.href)}),k=S.protocol+"://"+S.host+(S.port?":"+S.port:""),C=Tc(),_=[kg("messages",[Ri((function(){var n=Mc(Rt(window),"message",(function(n){if(S.isSameOrigin(new cI(n.raw.origin))){var o=n.raw.data;fI(o)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!a(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}}(e,B,o):function(t){return!fI(t)&&r(t)&&yt(t,"mceAction")}(o)&&t.onMessage(B,o)}}));C.set(n)})),Vi(C.clear)]),ec.config({channels:(u={},u[VF]={onReceive:function(t,n){Uu(t.element,"iframe").each((function(t){t.dom.contentWindow.postMessage(n,k)}))}},u)})],E=QF({header:p,body:h,footer:v,extraClasses:w,extraBehaviours:_,extraStyles:y},t,b,i),B=(c=E,s=function(t){c.getSystem().isConnected()&&t(c)},{block:function(t){if(!o(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");s((function(n){yi(n,rx,{message:t})}))},unblock:function(){s((function(t){bi(t,ix)}))},close:function(){s((function(t){bi(t,tx)}))},sendMessage:function(t){s((function(n){n.getSystem().broadcastOn([VF],t)}))}});return{dialog:E,instanceApi:B}},dI=function(t,n,e){return n&&e?[]:[Z_.config({contextual:{lazyContext:function(){return I.some(Ne(Rt(t.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]},mI=function(t){var n=t.backstage,e=t.editor,o=jv(e),r=function(t){var n=t.backstage.shared;return{open:function(e,o){var r=function(){LA.hide(c),o()},i=Fp(_C({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:I.none()},"cancel",t.backstage)),u=LF(),a=NF(r,n.providers),c=Iu(GF({lazySink:function(){return n.getSink()},header:zF(u,a),body:WF(e,n.providers),footer:I.some(UF(jF([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Ti(nx,r)],eventOrder:{}}));LA.show(c);var s=i.get(c);Eg.focus(s)}}}(t),i=function(t){var n=t.backstage.shared;return{open:function(e,o){var r=function(t){LA.hide(s),o(t)},i=Fp(_C({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:I.none()},"submit",t.backstage)),u=_C({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:I.none()},"cancel",t.backstage),a=LF(),c=NF((function(){return r(!1)}),n.providers),s=Iu(GF({lazySink:function(){return n.getSink()},header:zF(a,c),body:WF(e,n.providers),footer:I.some(UF(jF([],[u,i.asSpec()]))),onEscape:function(){return r(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Ti(nx,(function(){return r(!1)})),Ti(ox,(function(){return r(!0)}))],eventOrder:{}}));LA.show(s);var f=i.get(s);Eg.focus(f)}}}(t),u=function(t,e){return dF.open((function(t,o,r){var i=o,u=function(t,n,e){var o=KF(t.internalDialog.title,e),r=function(t,n){var e=PF(t,I.none(),n,!1);return LA.parts.body(e)}({body:t.internalDialog.body},e),i=ZF(t.internalDialog.buttons),u=tI(i),a=iI({buttons:i},e),c=eI((function(){return m}),$F((function(){return l}),e.shared.providers,n),e.shared.getSink),s=function(t){switch(t){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(t.internalDialog.size),f={header:o,body:r,footer:I.some(a),extraClasses:s,extraBehaviours:[],extraStyles:{}},l=QF(f,t,c,e),d={getRoot:h(l),getBody:function(){return LA.getBody(l)},getFooter:function(){return LA.getFooter(l)},getFormWrapper:function(){var t=LA.getBody(l);return Ql.getCurrent(t).getOr(t)}},m=aI(d,n.redial,u);return{dialog:l,instanceApi:m}}({dataValidator:r,initialData:i,internalDialog:t},{redial:dF.redial,closeWindow:function(){LA.hide(u.dialog),e(u.instanceApi)}},n);return LA.show(u.dialog),u.instanceApi.setData(i),u.instanceApi}),t)},a=function(t,r,i,u){return dF.open((function(t,a,c){var s=Io(Fo("data",c,a)),f=Ec(),l=n.shared.header.isPositionedAtTop(),d=function(){return f.on((function(t){lp.reposition(t),Z_.refresh(t)}))},m=function(t,n,e,o){var r,i,u,a,c,s=Xi("dialog-label"),f=Xi("dialog-content"),l=Fp((u={title:t.internalDialog.title,draggable:!0},a=s,c=e.shared.providers,Ny.sketch({dom:YT('<div class="tox-dialog__header"></div>'),components:[qF(u,I.some(a),c),YF(),XF(c)],containerBehaviours:Ja([TA.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return ju(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),d=Fp(function(t,n,e,o){return PF(t,I.some(n),e,o)}({body:t.internalDialog.body},f,e,o)),m=ZF(t.internalDialog.buttons),g=tI(m),p=Fp(function(t,n){return rI(t,n)}({buttons:m},e)),v=eI((function(){return y}),{onBlock:function(t){qT.block(b,(function(n,o){return JF(t.message,o,e.shared.providers)}))},onUnblock:function(){qT.unblock(b)},onClose:function(){return n.closeWindow()}},e.shared.getSink),b=Iu({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(r={role:"dialog"},r["aria-labelledby"]=s,r["aria-describedby"]=f,r)},eventOrder:(i={},i[Jr()]=[xB.name(),ec.name()],i[$r()]=["execute-on-form"],i[ci()]=["reflecting","execute-on-form"],i),behaviours:Ja([hg.config({mode:"cyclic",onEscape:function(t){return bi(t,tx),I.some(!0)},useTabstopAt:function(t){return!kk(t)&&("button"!==Pt(t)||"disabled"!==qn(t,"disabled"))}}),xB.config({channel:DF,updateState:function(t,n){return I.some(n)},initialData:t}),Eg.config({}),kg("execute-on-form",v.concat([Ii(Ir(),(function(t,n){hg.focusIn(t)}))])),qT.config({getRoot:function(){return I.some(b)}}),Sg.config({}),hk({})]),components:[l.asSpec(),d.asSpec(),p.asSpec()]}),y=aI({getRoot:h(b),getFooter:function(){return p.get(b)},getBody:function(){return d.get(b)},getFormWrapper:function(){var t=d.get(b);return Ql.getCurrent(t).getOr(t)}},n.redial,g);return{dialog:b,instanceApi:y}}({dataValidator:c,initialData:s,internalDialog:t},{redial:dF.redial,closeWindow:function(){f.on(lp.hide),e.off("ResizeEditor",d),f.clear(),i(m.instanceApi)}},n,u),g=Iu(lp.sketch(O(O({lazySink:n.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},l?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:Ja(T([kg("window-manager-inline-events",[Ti(fi(),(function(t,n){bi(m.dialog,nx)}))])],dI(e,o,l),!0)),isExtraPart:function(t,n){return function(t){return By(t,".tox-alert-dialog")||By(t,".tox-confirm-dialog")}(n)}})));return f.set(g),lp.showWithin(g,Ru(m.dialog),{anchor:r},I.some(Wn())),o&&l||(Z_.refresh(g),e.on("ResizeEditor",d)),m.instanceApi.setData(s),hg.focusIn(m.dialog),m.instanceApi}),t)};return{open:function(t,e,o){return void 0!==e&&"toolbar"===e.inline?a(t,n.shared.anchors.inlineDialog(),o,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?a(t,n.shared.anchors.cursor(),o,e.ariaAttrs):u(t,o)},openUrl:function(t,o){return function(t,o){return dF.openUrl((function(t){var r=lI(t,{closeWindow:function(){LA.hide(r.dialog),o(r.instanceApi)}},e,n);return LA.show(r.dialog),r.instanceApi}),t)}(t,o)},alert:function(t,n){r.open(t,(function(){n()}))},close:function(t){t.close()},confirm:function(t,n){i.open(t,(function(t){n(t)}))}}};C.add("silver",(function(t){var n=PA(t),e=n.uiMothership,o=n.backstage,r=n.renderUI,i=n.getUi;Ey(t,o.shared);var u=mI({editor:t,backstage:o});return{renderUI:r,getWindowManagerImpl:h(u),getNotificationManagerImpl:function(){return function(t,n,e){var o=n.backstage.shared;return{open:function(n,r){var i=!n.closeButton&&n.timeout&&(n.timeout>0||n.timeout<0),u=function(){r(),lp.hide(c)},a=Iu(Gp.sketch({text:n.text,level:z(["success","error","warning","warn","info"],n.type)?n.type:void 0,progress:!0===n.progressBar,icon:I.from(n.icon),closeButton:!i,onAction:u,iconProvider:o.providers.icons,translationProvider:o.providers.translate})),c=Iu(lp.sketch(O({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:o.getSink,fireDismissalEventInstead:{}},o.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));e.add(c),n.timeout>0&&Ap.setTimeout((function(){u()}),n.timeout);var s=function(){var n=Ne(Rt(t.getContentAreaContainer())),e=We(),o=Sa(e.x,n.x,n.right),r=Sa(e.y,n.y,n.bottom),i=Math.max(n.right,e.right),u=Math.max(n.bottom,e.bottom);return I.some(ze(o,r,i-o,u-r))};return{close:u,moveTo:function(t,n){lp.showAt(c,Ru(a),{anchor:{type:"makeshift",x:t,y:n}})},moveRel:function(t,n){var e=Ru(a),r={maxHeightFunction:Hc()};if("banner"!==n&&f(t)){var i=function(t){switch(t){case"bc-bc":return Cp;case"tc-tc":return kp;case"tc-bc":return Ra;default:return Va}}(n),u={type:"node",root:Wn(),node:I.some(Rt(t)),overrides:r,layouts:{onRtl:function(){return[i]},onLtr:function(){return[i]}}};lp.showWithinBounds(c,e,{anchor:u},s)}else{var l=O(O({},o.anchors.banner()),{overrides:r});lp.showWithinBounds(c,e,{anchor:l},s)}},text:function(t){Gp.updateText(a,t)},settings:n,getEl:function(){return a.element.dom},progressBar:{value:function(t){Gp.updateProgress(a,t)}}}},close:function(t){t.close()},reposition:function(t){t.length>0&&j(t,(function(n,e){0===e?n.moveRel(null,"banner"):n.moveRel(t[e-1].getEl(),"bc-tc")}))},getArgs:function(t){return t.settings}}}(t,{backstage:o},e)},ui:i()}}))}();