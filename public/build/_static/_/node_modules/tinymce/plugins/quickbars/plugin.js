!function(){"use strict";var t,n,e=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=0,o=tinymce.util.Tools.resolve("tinymce.util.Promise"),i=tinymce.util.Tools.resolve("tinymce.Env"),u=tinymce.util.Tools.resolve("tinymce.util.Delay"),c=function(t){t.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:function(){(function(t){return new o((function(n){var e=document.createElement("input");e.type="file",e.accept="image/*",e.style.position="fixed",e.style.left="0",e.style.top="0",e.style.opacity="0.001",document.body.appendChild(e),e.addEventListener("change",(function(t){n(Array.prototype.slice.call(t.target.files))}));var r=function(o){var c=function(){n([]),e.parentNode.removeChild(e)};i.os.isAndroid()&&"remove"!==o.type?u.setEditorTimeout(t,c,0):c(),t.off("focusin remove",r)};t.on("focusin remove",r),e.click()}))})(t).then((function(n){if(n.length>0){var e=n[0];(i=e,new o((function(t){var n=new FileReader;n.onloadend=function(){t(n.result.split(",")[1])},n.readAsDataURL(i)}))).then((function(n){!function(t,n,e){var o,i=t.editorUpload.blobCache,u=i.create((o=(new Date).getTime(),"mceu_"+Math.floor(1e9*Math.random())+ ++r+String(o)),e,n);i.add(u),t.insertContent(t.dom.createHTML("img",{src:u.blobUri()}))}(t,n,e)}))}var i}))}}),t.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:function(){!function(t,n,e){t.plugins.table?t.plugins.table.insertTable(2,2):function(t,n,e){t.undoManager.transact((function(){t.insertContent(function(t,n){var e='<table data-mce-id="mce" style="width: 100%">';e+="<tbody>";for(var r=0;r<2;r++){e+="<tr>";for(var o=0;o<2;o++)e+="<td><br></td>";e+="</tr>"}return(e+="</tbody>")+"</table>"}());var n=function(t){return t.dom.select("*[data-mce-id]")[0]}(t);n.removeAttribute("data-mce-id");var e=t.dom.select("td,th",n);t.selection.setCursorLocation(e[0],0)}))}(t)}(t)}})},a=function(t){return function(n){return r=typeof(e=n),(null===e?"null":"object"===r&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":r)===t;var e,r}},l=function(t){return function(n){return typeof n===t}},f=a("string"),s=a("object"),d=a("array"),m=l("boolean"),g=(void 0,function(t){return undefined===t}),b=l("function"),p=function(t){return function(){return t}},v=p(!1),y=p(!0),h=function(){return k},k={fold:function(t,n){return t()},isSome:v,isNone:y,getOr:n=function(t){return t},getOrThunk:t=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:p(null),getOrUndefined:p(void 0),or:n,orThunk:t,map:h,each:function(){},bind:h,exists:v,forall:y,filter:function(){return h()},toArray:function(){return[]},toString:p("none()")},w=function(t){var n=p(t),e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},isSome:y,isNone:v,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return w(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?o:k},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},T={some:w,none:h,from:function(t){return null==t?k:w(t)}};function S(t,n,e,r,o){return t(e,r)?T.some(e):b(o)&&o(e)?T.none():n(e,r,o)}var E=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}},O=E,q=function(t,n){var e=t.dom;if(1!==e.nodeType)return!1;var r=e;if(void 0!==r.matches)return r.matches(n);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(n);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(n);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")};"undefined"!=typeof window?window:Function("return this;")();var C,M=function(t,n,e){for(var r=t.dom,o=b(e)?e:v;r.parentNode;){r=r.parentNode;var i=O(r);if(n(i))return T.some(i);if(o(i))break}return T.none()},N=function(t,n,e){return M(t,(function(t){return q(t,n)}),e)},A=(C=f,function(t,n,e){return function(t,n){if(n(t))return!0;throw new Error("Default value doesn't match requested type.")}(e,C),function(t,n){if(d(t)||s(t))throw new Error("expected a string but found: "+t);return g(t)?n:m(t)?!1===t?"":n:t}(t.getParam(n,e),e)}),x=function(t){var n=function(t){return A(t,"quickbars_insert_toolbar","quickimage quicktable")}(t);n.trim().length>0&&t.ui.registry.addContextToolbar("quickblock",{predicate:function(n){var e=O(n),r=t.schema.getTextBlockElements(),o=function(n){return n.dom===t.getBody()};return function(t,n,e){return S((function(t,n){return q(t,n)}),N,t,"table",e)}(e,0,o).fold((function(){return function(n,e,o){return S((function(t,n){return n(t)}),M,n,(function(n){return n.dom.nodeName.toLowerCase()in r&&t.dom.isEmpty(n.dom)}),o)}(e,0,o).isSome()}),v)},items:n,position:"line",scope:"editor"})};e.add("quickbars",(function(t){c(t),x(t),function(t){var n=function(t){return"IMG"===t.nodeName||"FIGURE"===t.nodeName&&/image/i.test(t.className)},e=function(t){return A(t,"quickbars_image_toolbar","alignleft aligncenter alignright")}(t);e.trim().length>0&&t.ui.registry.addContextToolbar("imageselection",{predicate:n,items:e,position:"node"});var r=function(t){return A(t,"quickbars_selection_toolbar","bold italic | quicklink h2 h3 blockquote")}(t);r.trim().length>0&&t.ui.registry.addContextToolbar("textselection",{predicate:function(e){return!n(e)&&!t.selection.isCollapsed()&&function(n){return"false"!==t.dom.getContentEditableParent(n)}(e)},items:r,position:"selection",scope:"editor"})}(t)}))}();